2025-10-18 15:29:27.979 +00:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-18 15:29:28.589 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 15:29:28.599 +00:00 [DBG] Creating DbConnection.
2025-10-18 15:29:28.602 +00:00 [DBG] Created DbConnection. (2ms).
2025-10-18 15:29:28.612 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:28.646 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 15:29:28.648 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:28.651 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 15:29:28.722 +00:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-10-18 15:29:28.812 +00:00 [DBG] Hosting starting
2025-10-18 15:29:28.854 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-10-18 15:29:28.855 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-10-18 15:29:28.862 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:28.865 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:28.866 +00:00 [DBG] Repository contains no viable default key. Caller should generate a key with immediate activation.
2025-10-18 15:29:28.867 +00:00 [DBG] Policy resolution states that a new key should be added to the key ring.
2025-10-18 15:29:28.870 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (5ms).
2025-10-18 15:29:28.871 +00:00 [INF] Creating key {fb917628-0836-4736-ace4-bb96090c1f93} with creation date 2025-10-18 15:29:28Z, activation date 2025-10-18 15:29:28Z, and expiration date 2026-01-16 15:29:28Z.
2025-10-18 15:29:28.875 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 15:29:28.876 +00:00 [DBG] Creating DbConnection.
2025-10-18 15:29:28.876 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 15:29:28.879 +00:00 [DBG] Descriptor deserializer type for key {fb917628-0836-4736-ace4-bb96090c1f93} is 'Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'.
2025-10-18 15:29:28.880 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-18 15:29:28.881 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-10-18 15:29:28.881 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:28.905 +00:00 [DBG] No key escrow sink found. Not writing key {fb917628-0836-4736-ace4-bb96090c1f93} to escrow.
2025-10-18 15:29:28.906 +00:00 [WRN] No XML encryptor configured. Key {fb917628-0836-4736-ace4-bb96090c1f93} may be persisted to storage in unencrypted form.
2025-10-18 15:29:28.921 +00:00 [DBG] Key cache expiration token triggered by 'CreateNewKey' operation.
2025-10-18 15:29:28.943 +00:00 [DBG] Found key {fb917628-0836-4736-ace4-bb96090c1f93}.
2025-10-18 15:29:29.010 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.014 +00:00 [DBG] Considering key {fb917628-0836-4736-ace4-bb96090c1f93} with expiration date 2026-01-16 15:29:28Z as default key.
2025-10-18 15:29:29.015 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 15:29:29.018 +00:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-10-18 15:29:29.020 +00:00 [DBG] Using managed symmetric algorithm 'System.Security.Cryptography.Aes'.
2025-10-18 15:29:29.021 +00:00 [DBG] Using managed keyed hash algorithm 'System.Security.Cryptography.HMACSHA256'.
2025-10-18 15:29:29.023 +00:00 [DBG] Using key {fb917628-0836-4736-ace4-bb96090c1f93} as the default key.
2025-10-18 15:29:29.024 +00:00 [DBG] Key ring with default key {fb917628-0836-4736-ace4-bb96090c1f93} was loaded during application startup.
2025-10-18 15:29:29.121 +00:00 [INF] Executed DbCommand (104ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 15:29:29.122 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.124 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (1ms).
2025-10-18 15:29:29.144 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.144 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.144 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 15:29:29.145 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 15:29:29.145 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 15:29:29.146 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 15:29:29.172 +00:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 15:29:29.178 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.179 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 5ms reading results.
2025-10-18 15:29:29.179 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.179 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 15:29:29.182 +00:00 [DBG] Migrating using database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.182 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.211 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.211 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.212 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 15:29:29.212 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 15:29:29.212 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 15:29:29.213 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 15:29:29.213 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.213 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.214 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 15:29:29.216 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 15:29:29.217 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.217 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 15:29:29.218 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.225 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.225 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.225 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 15:29:29.225 +00:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 2AE5B9E8B7B0EDFD86FD709A56EA7C92E2569E52)
2025-10-18 15:29:29.226 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 15:29:29.226 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 15:29:29.226 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 15:29:29.227 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.227 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.227 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 15:29:29.229 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 15:29:29.230 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.230 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 15:29:29.230 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.230 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.231 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 15:29:29.231 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 15:29:29.231 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 15:29:29.231 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 15:29:29.233 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 15:29:29.234 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.234 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 15:29:29.234 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 15:29:29.234 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 15:29:29.243 +00:00 [INF] No migrations were applied. The database is already up to date.
2025-10-18 15:29:29.448 +00:00 [INF] Now listening on: http://[::]:8080
2025-10-18 15:29:29.448 +00:00 [INF] Now listening on: https://[::]:8081
2025-10-18 15:29:29.449 +00:00 [DBG] Loaded hosting startup assembly CarsTradeAPI
2025-10-18 15:29:29.449 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-18 15:29:29.449 +00:00 [INF] Hosting environment: Development
2025-10-18 15:29:29.449 +00:00 [INF] Content root path: /app
2025-10-18 15:29:29.450 +00:00 [DBG] Hosting started
2025-10-18 15:29:30.283 +00:00 [DBG] Connection id "0HNGEBCGQL98R" accepted.
2025-10-18 15:29:30.285 +00:00 [DBG] Connection id "0HNGEBCGQL98R" started.
2025-10-18 15:29:30.309 +00:00 [DBG] Connection 0HNGEBCGQL98R established using the following protocol: "Tls13"
2025-10-18 15:29:30.362 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/swagger/index.html - null null
2025-10-18 15:29:30.363 +00:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-10-18 15:29:30.377 +00:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-10-18 15:29:30.378 +00:00 [DBG] Request did not match any endpoints
2025-10-18 15:29:30.493 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 15:29:30.607 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/swagger/index.html - 200 null text/html;charset=utf-8 245.9343ms
2025-10-18 15:29:30.704 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/swagger/v1/swagger.json - null null
2025-10-18 15:29:30.705 +00:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-10-18 15:29:30.705 +00:00 [DBG] Request did not match any endpoints
2025-10-18 15:29:30.706 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 15:29:30.875 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 170.0415ms
2025-10-18 15:29:38.946 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - null null
2025-10-18 15:29:38.951 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 15:29:38.954 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)' with route pattern 'api/Employee/GetAllEmployee/All' is valid for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 15:29:38.956 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 15:29:38.958 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 15:29:38.959 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 15:29:38.962 +00:00 [DBG] Policy authentication schemes  did not succeed
2025-10-18 15:29:38.964 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 15:29:38.967 +00:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-10-18 15:29:38.967 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - 401 0 null 21.7112ms
2025-10-18 16:01:33.587 +00:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-18 16:01:34.174 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 16:01:34.183 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:01:34.186 +00:00 [DBG] Created DbConnection. (2ms).
2025-10-18 16:01:34.196 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.230 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 16:01:34.231 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.234 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:01:34.306 +00:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-10-18 16:01:34.364 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.366 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.372 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (5ms).
2025-10-18 16:01:34.373 +00:00 [DBG] Hosting starting
2025-10-18 16:01:34.377 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 16:01:34.378 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:01:34.378 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 16:01:34.392 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-18 16:01:34.403 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (17ms).
2025-10-18 16:01:34.404 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.457 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-10-18 16:01:34.458 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-10-18 16:01:34.485 +00:00 [DBG] Repository contains no viable default key. Caller should generate a key with immediate activation.
2025-10-18 16:01:34.485 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.485 +00:00 [DBG] Policy resolution states that a new key should be added to the key ring.
2025-10-18 16:01:34.488 +00:00 [INF] Creating key {03fb4e50-bd80-4ab7-b750-455dc6f6786a} with creation date 2025-10-18 16:01:34Z, activation date 2025-10-18 16:01:34Z, and expiration date 2026-01-16 16:01:34Z.
2025-10-18 16:01:34.490 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:01:34.495 +00:00 [DBG] Descriptor deserializer type for key {03fb4e50-bd80-4ab7-b750-455dc6f6786a} is 'Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'.
2025-10-18 16:01:34.500 +00:00 [DBG] No key escrow sink found. Not writing key {03fb4e50-bd80-4ab7-b750-455dc6f6786a} to escrow.
2025-10-18 16:01:34.500 +00:00 [WRN] No XML encryptor configured. Key {03fb4e50-bd80-4ab7-b750-455dc6f6786a} may be persisted to storage in unencrypted form.
2025-10-18 16:01:34.501 +00:00 [DBG] Key cache expiration token triggered by 'CreateNewKey' operation.
2025-10-18 16:01:34.502 +00:00 [DBG] Found key {03fb4e50-bd80-4ab7-b750-455dc6f6786a}.
2025-10-18 16:01:34.510 +00:00 [DBG] Considering key {03fb4e50-bd80-4ab7-b750-455dc6f6786a} with expiration date 2026-01-16 16:01:34Z as default key.
2025-10-18 16:01:34.515 +00:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-10-18 16:01:34.517 +00:00 [DBG] Using managed symmetric algorithm 'System.Security.Cryptography.Aes'.
2025-10-18 16:01:34.517 +00:00 [DBG] Using managed keyed hash algorithm 'System.Security.Cryptography.HMACSHA256'.
2025-10-18 16:01:34.530 +00:00 [DBG] Using key {03fb4e50-bd80-4ab7-b750-455dc6f6786a} as the default key.
2025-10-18 16:01:34.531 +00:00 [DBG] Key ring with default key {03fb4e50-bd80-4ab7-b750-455dc6f6786a} was loaded during application startup.
2025-10-18 16:01:34.581 +00:00 [INF] Executed DbCommand (79ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:01:34.582 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.584 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (1ms).
2025-10-18 16:01:34.610 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.610 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.611 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:01:34.611 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:01:34.611 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:01:34.612 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:01:34.617 +00:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:01:34.633 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.634 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 15ms reading results.
2025-10-18 16:01:34.634 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.635 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:01:34.637 +00:00 [DBG] Migrating using database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.637 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.645 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.646 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.646 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:01:34.648 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 16:01:34.648 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:01:34.648 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:01:34.649 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.649 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.649 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:01:34.653 +00:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:01:34.653 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.653 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:01:34.654 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.681 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.682 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.682 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:01:34.682 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 16:01:34.683 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:01:34.683 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:01:34.683 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.684 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.684 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:01:34.687 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:01:34.687 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.687 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:01:34.687 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.688 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.688 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:01:34.688 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:01:34.688 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:01:34.689 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:01:34.691 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:01:34.691 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.692 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 16:01:34.692 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:01:34.692 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:01:34.693 +00:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 2AE5B9E8B7B0EDFD86FD709A56EA7C92E2569E52)
2025-10-18 16:01:34.702 +00:00 [INF] No migrations were applied. The database is already up to date.
2025-10-18 16:01:34.884 +00:00 [INF] Now listening on: http://[::]:8080
2025-10-18 16:01:34.884 +00:00 [INF] Now listening on: https://[::]:8081
2025-10-18 16:01:34.884 +00:00 [DBG] Loaded hosting startup assembly CarsTradeAPI
2025-10-18 16:01:34.885 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-18 16:01:34.885 +00:00 [INF] Hosting environment: Development
2025-10-18 16:01:34.885 +00:00 [INF] Content root path: /app
2025-10-18 16:01:34.885 +00:00 [DBG] Hosting started
2025-10-18 16:01:35.043 +00:00 [DBG] Connection id "0HNGEBUEEJBF9" accepted.
2025-10-18 16:01:35.044 +00:00 [DBG] Connection id "0HNGEBUEEJBF9" started.
2025-10-18 16:01:35.066 +00:00 [DBG] Connection 0HNGEBUEEJBF9 established using the following protocol: "Tls13"
2025-10-18 16:01:35.112 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/swagger/index.html - null null
2025-10-18 16:01:35.114 +00:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-10-18 16:01:35.125 +00:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-10-18 16:01:35.126 +00:00 [DBG] Request did not match any endpoints
2025-10-18 16:01:35.233 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:01:35.346 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/swagger/index.html - 200 null text/html;charset=utf-8 234.1911ms
2025-10-18 16:01:35.424 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/swagger/v1/swagger.json - null null
2025-10-18 16:01:35.425 +00:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-10-18 16:01:35.425 +00:00 [DBG] Request did not match any endpoints
2025-10-18 16:01:35.426 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:01:35.578 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 153.4696ms
2025-10-18 16:03:14.600 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Employee/CreateAdminForTestCommand - application/json 272
2025-10-18 16:03:14.636 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/CreateAdminForTestCommand'
2025-10-18 16:03:14.639 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI)' with route pattern 'api/Employee/CreateAdminForTestCommand' is valid for the request path '/api/Employee/CreateAdminForTestCommand'
2025-10-18 16:03:14.640 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI)'
2025-10-18 16:03:14.642 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:03:14.644 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:03:14.645 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI)'
2025-10-18 16:03:14.665 +00:00 [INF] Route matched with {action = "CreateAdminForTest", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.ShowEmployeeDto]] CreateAdminForTest(CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand) on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI).
2025-10-18 16:03:14.666 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 16:03:14.667 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 16:03:14.668 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 16:03:14.668 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 16:03:14.668 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 16:03:14.670 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI)
2025-10-18 16:03:14.673 +00:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-18 16:03:14.674 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI)
2025-10-18 16:03:14.690 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand' ...
2025-10-18 16:03:14.694 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand' using the name '' in request data ...
2025-10-18 16:03:14.695 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 16:03:14.721 +00:00 [DBG] Connection id "0HNGEBUEEJBF9", Request id "0HNGEBUEEJBF9:00000005": started reading request body.
2025-10-18 16:03:14.721 +00:00 [DBG] Connection id "0HNGEBUEEJBF9", Request id "0HNGEBUEEJBF9:00000005": done reading request body.
2025-10-18 16:03:14.731 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand'
2025-10-18 16:03:14.732 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand'.
2025-10-18 16:03:14.732 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand'.
2025-10-18 16:03:14.733 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand' ...
2025-10-18 16:03:14.741 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand'.
2025-10-18 16:03:14.744 +00:00 [INF] Начало обработки запроса CreateAdminForTest
2025-10-18 16:03:14.857 +00:00 [INF] Начало обработки команды CreateAdminForTestCommand
2025-10-18 16:03:14.858 +00:00 [INF] Checking IdempotencyRequest for key: 123531432412
2025-10-18 16:03:14.869 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 16:03:14.917 +00:00 [DBG] Compiling query expression: 
'DbSet<IdempotencyRequest>()
    .AsNoTracking()
    .FirstOrDefault(r => r.Key == __key_0)'
2025-10-18 16:03:15.041 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<IdempotencyRequest>(
    asyncEnumerable: new SingleQueryingEnumerable<IdempotencyRequest>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: IdempotencyRequest.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: IdempotencyRequest.CreatedAt (DateTime) Required, 1], [Property: IdempotencyRequest.Key (string) Required MaxLength(100), 2], [Property: IdempotencyRequest.ResourceId (Guid?), 3], [Property: IdempotencyRequest.ResourceType (string) Required MaxLength(50), 4], [Property: IdempotencyRequest.Responsejson (string), 5], [Property: IdempotencyRequest.Status (string) Required MaxLength(50), 6] }
            SELECT TOP(1) i.Id, i.CreatedAt, i.Key, i.ResourceId, i.ResourceType, i.Responsejson, i.Status
            FROM IdempotencyRequests AS i
            WHERE i.Key == @__key_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, IdempotencyRequest>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 16:03:15.060 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:03:15.061 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 16:03:15.061 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:03:15.061 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:03:15.061 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:03:15.061 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:03:15.064 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-10-18 16:03:15.065 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 16:03:15.075 +00:00 [INF] Executed DbCommand (11ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 16:03:15.079 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:03:15.079 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 3ms reading results.
2025-10-18 16:03:15.079 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:03:15.080 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:03:15.101 +00:00 [INF] IdempotencyRequest found: false
2025-10-18 16:03:15.104 +00:00 [INF] Этап проверки уникальности логина TestLoginForTest@mail.ru в репозитории
2025-10-18 16:03:15.106 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()
    .Any(x => x.EmployeeLogin == __employeeLogin_0)'
2025-10-18 16:03:15.175 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Employees AS e
                WHERE e.employee_login == @__employeeLogin_0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 16:03:15.179 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:03:15.180 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:03:15.180 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:03:15.180 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:03:15.181 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:03:15.181 +00:00 [DBG] Executing DbCommand [Parameters=[@__employeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_login = @__employeeLogin_0)
2025-10-18 16:03:15.187 +00:00 [INF] Executed DbCommand (6ms) [Parameters=[@__employeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_login = @__employeeLogin_0)
2025-10-18 16:03:15.190 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:03:15.190 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 2ms reading results.
2025-10-18 16:03:15.191 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:03:15.191 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:03:15.191 +00:00 [INF] Проверка уникальности логина TestLoginForTest@mail.ru завершена. Результат: false
2025-10-18 16:03:15.269 +00:00 [ERR] Ошибка при попытке создать админа с логином: TestLoginForTest@mail.ru
AutoMapper.AutoMapperMappingException: Missing type map configuration or unsupported mapping.

Mapping types:
CreateAdminForTestCommand -> Employee
CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand -> CarsTradeAPI.Entities.Employee
   at lambda_method28(Closure, CreateAdminForTestCommand, Employee, ResolutionContext)
   at CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommandHandler.Handle(CreateAdminForTestCommand request, CancellationToken cancellationToken) in B:\MyDevelopment\MyRepos\CarsTradeAPI\CarsTradeAPI\Features\EmployeeOperation\CreateAdminForTest\CreateAdminForTestCommandHandler.cs:line 72
2025-10-18 16:03:15.324 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 16:03:15.326 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 16:03:15.326 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 16:03:15.327 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 16:03:15.327 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 16:03:15.328 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 16:03:15.328 +00:00 [INF] Executing BadRequestObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Infrastructure.ValidationBehavior.ErrorDetail, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 16:03:15.344 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI) in 673.9662ms
2025-10-18 16:03:15.345 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI)'
2025-10-18 16:03:15.346 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 16:03:15.368 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:03:15.369 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (1ms).
2025-10-18 16:03:15.370 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Employee/CreateAdminForTestCommand - 400 null application/json; charset=utf-8 770.0275ms
2025-10-18 16:04:59.986 +00:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-18 16:05:00.542 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 16:05:00.552 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:05:00.556 +00:00 [DBG] Created DbConnection. (2ms).
2025-10-18 16:05:00.565 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.599 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 16:05:00.601 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.604 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:05:00.669 +00:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-10-18 16:05:00.694 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.697 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.704 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (6ms).
2025-10-18 16:05:00.718 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 16:05:00.719 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:05:00.719 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 16:05:00.724 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-18 16:05:00.725 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (7ms).
2025-10-18 16:05:00.726 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.755 +00:00 [DBG] Hosting starting
2025-10-18 16:05:00.769 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.792 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-10-18 16:05:00.792 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-10-18 16:05:00.794 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:05:00.804 +00:00 [DBG] Repository contains no viable default key. Caller should generate a key with immediate activation.
2025-10-18 16:05:00.804 +00:00 [DBG] Policy resolution states that a new key should be added to the key ring.
2025-10-18 16:05:00.807 +00:00 [INF] Creating key {acc50236-3ec1-422e-811a-60cd548f3c5e} with creation date 2025-10-18 16:05:00Z, activation date 2025-10-18 16:05:00Z, and expiration date 2026-01-16 16:05:00Z.
2025-10-18 16:05:00.812 +00:00 [DBG] Descriptor deserializer type for key {acc50236-3ec1-422e-811a-60cd548f3c5e} is 'Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'.
2025-10-18 16:05:00.815 +00:00 [DBG] No key escrow sink found. Not writing key {acc50236-3ec1-422e-811a-60cd548f3c5e} to escrow.
2025-10-18 16:05:00.815 +00:00 [WRN] No XML encryptor configured. Key {acc50236-3ec1-422e-811a-60cd548f3c5e} may be persisted to storage in unencrypted form.
2025-10-18 16:05:00.816 +00:00 [DBG] Key cache expiration token triggered by 'CreateNewKey' operation.
2025-10-18 16:05:00.817 +00:00 [DBG] Found key {acc50236-3ec1-422e-811a-60cd548f3c5e}.
2025-10-18 16:05:00.833 +00:00 [DBG] Considering key {acc50236-3ec1-422e-811a-60cd548f3c5e} with expiration date 2026-01-16 16:05:00Z as default key.
2025-10-18 16:05:00.837 +00:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-10-18 16:05:00.839 +00:00 [DBG] Using managed symmetric algorithm 'System.Security.Cryptography.Aes'.
2025-10-18 16:05:00.840 +00:00 [DBG] Using managed keyed hash algorithm 'System.Security.Cryptography.HMACSHA256'.
2025-10-18 16:05:00.842 +00:00 [DBG] Using key {acc50236-3ec1-422e-811a-60cd548f3c5e} as the default key.
2025-10-18 16:05:00.843 +00:00 [DBG] Key ring with default key {acc50236-3ec1-422e-811a-60cd548f3c5e} was loaded during application startup.
2025-10-18 16:05:00.864 +00:00 [INF] Executed DbCommand (79ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:05:00.866 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.887 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (21ms).
2025-10-18 16:05:00.907 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.907 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.908 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:05:00.914 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (6ms).
2025-10-18 16:05:00.915 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2025-10-18 16:05:00.915 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:05:00.921 +00:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:05:00.936 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.937 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 15ms reading results.
2025-10-18 16:05:00.938 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.938 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:05:00.940 +00:00 [DBG] Migrating using database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.940 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.948 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.949 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.949 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:05:00.950 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 16:05:00.950 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:05:00.950 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:05:00.950 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.951 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.951 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:05:00.954 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:05:00.954 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.954 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:05:00.955 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.963 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.963 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.964 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:05:00.964 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 16:05:00.964 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:05:00.964 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:05:00.965 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.965 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.965 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:05:00.988 +00:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:05:00.988 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.989 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:05:00.989 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.989 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.990 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:05:00.990 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:05:00.990 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:05:00.991 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:05:00.993 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:05:00.994 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.994 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 16:05:00.994 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:05:00.994 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:05:00.999 +00:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 2AE5B9E8B7B0EDFD86FD709A56EA7C92E2569E52)
2025-10-18 16:05:01.003 +00:00 [INF] No migrations were applied. The database is already up to date.
2025-10-18 16:05:01.186 +00:00 [INF] Now listening on: http://[::]:8080
2025-10-18 16:05:01.186 +00:00 [INF] Now listening on: https://[::]:8081
2025-10-18 16:05:01.186 +00:00 [DBG] Loaded hosting startup assembly CarsTradeAPI
2025-10-18 16:05:01.187 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-18 16:05:01.187 +00:00 [INF] Hosting environment: Development
2025-10-18 16:05:01.187 +00:00 [INF] Content root path: /app
2025-10-18 16:05:01.187 +00:00 [DBG] Hosting started
2025-10-18 16:05:01.329 +00:00 [DBG] Connection id "0HNGEC0BTSNO0" accepted.
2025-10-18 16:05:01.330 +00:00 [DBG] Connection id "0HNGEC0BTSNO0" started.
2025-10-18 16:05:01.351 +00:00 [DBG] Connection 0HNGEC0BTSNO0 established using the following protocol: "Tls13"
2025-10-18 16:05:01.402 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/swagger/index.html - null null
2025-10-18 16:05:01.403 +00:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-10-18 16:05:01.416 +00:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-10-18 16:05:01.416 +00:00 [DBG] Request did not match any endpoints
2025-10-18 16:05:01.522 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:05:01.649 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/swagger/index.html - 200 null text/html;charset=utf-8 247.7286ms
2025-10-18 16:05:01.724 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/swagger/v1/swagger.json - null null
2025-10-18 16:05:01.725 +00:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-10-18 16:05:01.725 +00:00 [DBG] Request did not match any endpoints
2025-10-18 16:05:01.726 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:05:01.874 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 151.0703ms
2025-10-18 16:06:22.557 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Employee/CreateAdminForTestCommand - application/json 272
2025-10-18 16:06:22.587 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/CreateAdminForTestCommand'
2025-10-18 16:06:22.591 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI)' with route pattern 'api/Employee/CreateAdminForTestCommand' is valid for the request path '/api/Employee/CreateAdminForTestCommand'
2025-10-18 16:06:22.591 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI)'
2025-10-18 16:06:22.595 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:06:22.596 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:06:22.597 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI)'
2025-10-18 16:06:22.618 +00:00 [INF] Route matched with {action = "CreateAdminForTest", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.ShowEmployeeDto]] CreateAdminForTest(CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand) on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI).
2025-10-18 16:06:22.619 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 16:06:22.620 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 16:06:22.621 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 16:06:22.621 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 16:06:22.621 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 16:06:22.623 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI)
2025-10-18 16:06:22.625 +00:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-18 16:06:22.626 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI)
2025-10-18 16:06:22.642 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand' ...
2025-10-18 16:06:22.645 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand' using the name '' in request data ...
2025-10-18 16:06:22.647 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 16:06:22.679 +00:00 [DBG] Connection id "0HNGEC0BTSNO0", Request id "0HNGEC0BTSNO0:00000005": started reading request body.
2025-10-18 16:06:22.679 +00:00 [DBG] Connection id "0HNGEC0BTSNO0", Request id "0HNGEC0BTSNO0:00000005": done reading request body.
2025-10-18 16:06:22.695 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand'
2025-10-18 16:06:22.696 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand'.
2025-10-18 16:06:22.696 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand'.
2025-10-18 16:06:22.696 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand' ...
2025-10-18 16:06:22.706 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand'.
2025-10-18 16:06:22.709 +00:00 [INF] Начало обработки запроса CreateAdminForTest
2025-10-18 16:06:22.838 +00:00 [INF] Начало обработки команды CreateAdminForTestCommand
2025-10-18 16:06:22.840 +00:00 [INF] Checking IdempotencyRequest for key: 123531432412
2025-10-18 16:06:22.864 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 16:06:22.911 +00:00 [DBG] Compiling query expression: 
'DbSet<IdempotencyRequest>()
    .AsNoTracking()
    .FirstOrDefault(r => r.Key == __key_0)'
2025-10-18 16:06:23.051 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<IdempotencyRequest>(
    asyncEnumerable: new SingleQueryingEnumerable<IdempotencyRequest>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: IdempotencyRequest.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: IdempotencyRequest.CreatedAt (DateTime) Required, 1], [Property: IdempotencyRequest.Key (string) Required MaxLength(100), 2], [Property: IdempotencyRequest.ResourceId (Guid?), 3], [Property: IdempotencyRequest.ResourceType (string) Required MaxLength(50), 4], [Property: IdempotencyRequest.Responsejson (string), 5], [Property: IdempotencyRequest.Status (string) Required MaxLength(50), 6] }
            SELECT TOP(1) i.Id, i.CreatedAt, i.Key, i.ResourceId, i.ResourceType, i.Responsejson, i.Status
            FROM IdempotencyRequests AS i
            WHERE i.Key == @__key_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, IdempotencyRequest>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 16:06:23.070 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:06:23.070 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 16:06:23.071 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.071 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.071 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:06:23.072 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:06:23.074 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-10-18 16:06:23.076 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 16:06:23.084 +00:00 [INF] Executed DbCommand (10ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 16:06:23.089 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.089 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 4ms reading results.
2025-10-18 16:06:23.110 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.111 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:06:23.112 +00:00 [INF] IdempotencyRequest found: false
2025-10-18 16:06:23.113 +00:00 [INF] Этап проверки уникальности логина TestLoginForTest@mail.ru в репозитории
2025-10-18 16:06:23.115 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()
    .Any(x => x.EmployeeLogin == __employeeLogin_0)'
2025-10-18 16:06:23.144 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Employees AS e
                WHERE e.employee_login == @__employeeLogin_0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 16:06:23.148 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.149 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.149 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:06:23.149 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:06:23.150 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:06:23.150 +00:00 [DBG] Executing DbCommand [Parameters=[@__employeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_login = @__employeeLogin_0)
2025-10-18 16:06:23.173 +00:00 [INF] Executed DbCommand (23ms) [Parameters=[@__employeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_login = @__employeeLogin_0)
2025-10-18 16:06:23.178 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.178 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 4ms reading results.
2025-10-18 16:06:23.179 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.179 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:06:23.179 +00:00 [INF] Проверка уникальности логина TestLoginForTest@mail.ru завершена. Результат: false
2025-10-18 16:06:23.244 +00:00 [INF] Этап создания работника с ID "10087cae-0d9d-4478-9af7-51b1dcee70b2" в репозитории
2025-10-18 16:06:23.245 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()
    .FirstOrDefault(x => x.EmployeeLogin == __employee_EmployeeLogin_0)'
2025-10-18 16:06:23.250 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Employee>(
    asyncEnumerable: new SingleQueryingEnumerable<Employee>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Employee.EmployeeId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Employee.EmployeeAge (uint) Required, 1], [Property: Employee.EmployeeLogin (string) Required Index, 2], [Property: Employee.EmployeeMiddlename (string) Required, 3], [Property: Employee.EmployeeName (string) Required, 4], [Property: Employee.EmployeePassword (string) Required MaxLength(260), 5], [Property: Employee.EmployeeRole (string) Required, 6], [Property: Employee.EmployeeSellCounter (uint?), 7], [Property: Employee.EmployeeSurname (string) Required, 8] }
            SELECT TOP(1) e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
            FROM Employees AS e
            WHERE e.employee_login == @__employee_EmployeeLogin_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Employee>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 16:06:23.251 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.251 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.252 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:06:23.252 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:06:23.252 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:06:23.253 +00:00 [DBG] Executing DbCommand [Parameters=[@__employee_EmployeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__employee_EmployeeLogin_0
LIMIT 1
2025-10-18 16:06:23.255 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__employee_EmployeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__employee_EmployeeLogin_0
LIMIT 1
2025-10-18 16:06:23.256 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.257 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 1ms reading results.
2025-10-18 16:06:23.257 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.258 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:06:23.306 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 16:06:23.308 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 16:06:23.310 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 16:06:23.321 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 16:06:23.360 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.361 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.362 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:06:23.363 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:06:23.364 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-10-18 16:06:23.364 +00:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int64), @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?' (DbType = Int64), @p8='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Employees" (employee_id, employee_age, employee_login, employee_middlename, employee_name, employee_password, employee_role, employee_sellcounter, employee_surname)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-10-18 16:06:23.374 +00:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int64), @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?' (DbType = Int64), @p8='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Employees" (employee_id, employee_age, employee_login, employee_middlename, employee_name, employee_password, employee_role, employee_sellcounter, employee_surname)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-10-18 16:06:23.377 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.377 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 2ms reading results.
2025-10-18 16:06:23.378 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.378 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:06:23.383 +00:00 [DBG] An entity of type 'Employee' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 16:06:23.385 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 16:06:23.385 +00:00 [INF] Работник успешно создан с ID: "10087cae-0d9d-4478-9af7-51b1dcee70b2"
2025-10-18 16:06:23.397 +00:00 [DBG] Compiling query expression: 
'DbSet<IdempotencyRequest>()
    .Any(r => r.Key == __key_0)'
2025-10-18 16:06:23.399 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM IdempotencyRequests AS i
                WHERE i.Key == @__key_0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 16:06:23.400 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.400 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.401 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:06:23.401 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:06:23.401 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:06:23.401 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 16:06:23.404 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 16:06:23.405 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.405 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 16:06:23.406 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.406 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:06:23.419 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'IdempotencyRequest' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 16:06:23.420 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 16:06:23.420 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 16:06:23.427 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 16:06:23.428 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.429 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.429 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:06:23.429 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:06:23.430 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:06:23.430 +00:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 16:06:23.439 +00:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 16:06:23.439 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.440 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 16:06:23.440 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.440 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:06:23.442 +00:00 [DBG] An entity of type 'IdempotencyRequest' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 16:06:23.442 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 16:06:23.442 +00:00 [INF] IdempotencyRequest saved for key: 123531432412
2025-10-18 16:06:23.680 +00:00 [INF] Администратор успешно создан с ID: "10087cae-0d9d-4478-9af7-51b1dcee70b2"
2025-10-18 16:06:23.684 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 16:06:23.686 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 16:06:23.687 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 16:06:23.687 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 16:06:23.688 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 16:06:23.688 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 16:06:23.689 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.ShowEmployeeDto'.
2025-10-18 16:06:23.697 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI) in 1073.2768ms
2025-10-18 16:06:23.698 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI)'
2025-10-18 16:06:23.699 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 16:06:23.701 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:06:23.702 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (1ms).
2025-10-18 16:06:23.702 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Employee/CreateAdminForTestCommand - 200 null application/json; charset=utf-8 1172.1064ms
2025-10-18 16:07:04.350 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - application/json 68
2025-10-18 16:07:04.357 +00:00 [DBG] 1 candidate(s) found for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 16:07:04.358 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)' with route pattern 'api/EmployeeAuthentication/Authenticate' is valid for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 16:07:04.358 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 16:07:04.358 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:07:04.359 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:07:04.359 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 16:07:04.363 +00:00 [INF] Route matched with {action = "Authenticate", controller = "EmployeeAuthentication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto]] Authenticate(CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand) on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI).
2025-10-18 16:07:04.363 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 16:07:04.363 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 16:07:04.364 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 16:07:04.364 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 16:07:04.364 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 16:07:04.364 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 16:07:04.365 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 16:07:04.366 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 16:07:04.367 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' using the name '' in request data ...
2025-10-18 16:07:04.367 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 16:07:04.369 +00:00 [DBG] Connection id "0HNGEC0BTSNO0", Request id "0HNGEC0BTSNO0:00000007": started reading request body.
2025-10-18 16:07:04.369 +00:00 [DBG] Connection id "0HNGEC0BTSNO0", Request id "0HNGEC0BTSNO0:00000007": done reading request body.
2025-10-18 16:07:04.370 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'
2025-10-18 16:07:04.370 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 16:07:04.370 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 16:07:04.370 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 16:07:04.372 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 16:07:04.373 +00:00 [INF] Начало обработки запроса аутентификации сотрудника
2025-10-18 16:07:04.376 +00:00 [INF] Начало обработки команды EmployeeAuthenticationCommand
2025-10-18 16:07:04.377 +00:00 [INF] Этап получения сотрудника по логину TestLoginForTest@mail.ru в репозитории
2025-10-18 16:07:04.406 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 16:07:04.407 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()
    .FirstOrDefault(x => x.EmployeeLogin == __login_0)'
2025-10-18 16:07:04.411 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Employee>(
    asyncEnumerable: new SingleQueryingEnumerable<Employee>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Employee.EmployeeId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Employee.EmployeeAge (uint) Required, 1], [Property: Employee.EmployeeLogin (string) Required Index, 2], [Property: Employee.EmployeeMiddlename (string) Required, 3], [Property: Employee.EmployeeName (string) Required, 4], [Property: Employee.EmployeePassword (string) Required MaxLength(260), 5], [Property: Employee.EmployeeRole (string) Required, 6], [Property: Employee.EmployeeSellCounter (uint?), 7], [Property: Employee.EmployeeSurname (string) Required, 8] }
            SELECT TOP(1) e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
            FROM Employees AS e
            WHERE e.employee_login == @__login_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Employee>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 16:07:04.411 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:07:04.412 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 16:07:04.412 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:07:04.412 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:07:04.412 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:07:04.413 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:07:04.413 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:07:04.413 +00:00 [DBG] Executing DbCommand [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 16:07:04.436 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 16:07:04.443 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 16:07:04.444 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:07:04.444 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 7ms reading results.
2025-10-18 16:07:04.444 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:07:04.445 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:07:04.445 +00:00 [INF] Сотрудник успешно получен с логином: TestLoginForTest@mail.ru
2025-10-18 16:07:04.576 +00:00 [ERR] Ошибка при попытке аутентификации пользователя с логином: TestLoginForTest@mail.ru
System.ArgumentOutOfRangeException: IDX10720: Unable to create KeyedHashAlgorithm for algorithm 'HS256', the key size must be greater than: '256' bits, key has '208' bits. (Parameter 'keyBytes')
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.ValidateKeySize(Byte[] keyBytes, String algorithm, Int32 expectedNumberOfBytes)
   at Microsoft.IdentityModel.Tokens.CryptoProviderFactory.CreateKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.CreateKeyedHashAlgorithm()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.CreateInstance()
   at Microsoft.IdentityModel.Tokens.DisposableObjectPool`1.Allocate()
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.GetKeyedHashAlgorithm(Byte[] keyBytes, String algorithm)
   at Microsoft.IdentityModel.Tokens.SymmetricSignatureProvider.Sign(Byte[] input)
   at Microsoft.IdentityModel.JsonWebTokens.JwtTokenUtilities.CreateEncodedSignature(String input, SigningCredentials signingCredentials)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.WriteToken(SecurityToken token)
   at CarsTradeAPI.Infrastructure.Services.GenerateTokenService.GenerateTokenService.GenerateToken(Employee employee) in B:\MyDevelopment\MyRepos\CarsTradeAPI\CarsTradeAPI\Infrastructure\Services\GenerateTokenService\GenerateToken.cs:line 40
   at CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommandHandler.Handle(EmployeeAuthenticationCommand request, CancellationToken cancellationToken) in B:\MyDevelopment\MyRepos\CarsTradeAPI\CarsTradeAPI\Features\EmployeeOperation\EmployeeAuthentication\EmployeeAuthenticationCommandHandler.cs:line 67
2025-10-18 16:07:04.631 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 16:07:04.631 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 16:07:04.631 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 16:07:04.632 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 16:07:04.632 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 16:07:04.632 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 16:07:04.633 +00:00 [INF] Executing BadRequestObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Infrastructure.ValidationBehavior.ErrorDetail, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 16:07:04.641 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI) in 276.6363ms
2025-10-18 16:07:04.642 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 16:07:04.642 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 16:07:04.642 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:07:04.642 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:07:04.643 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - 400 null application/json; charset=utf-8 319.3907ms
2025-10-18 16:12:23.414 +00:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 2AE5B9E8B7B0EDFD86FD709A56EA7C92E2569E52)
2025-10-18 16:12:23.414 +00:00 [DBG] Config reload token fired. Checking for changes...
2025-10-18 16:12:31.412 +00:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 2AE5B9E8B7B0EDFD86FD709A56EA7C92E2569E52)
2025-10-18 16:12:31.412 +00:00 [DBG] Config reload token fired. Checking for changes...
2025-10-18 16:14:34.975 +00:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-18 16:14:35.519 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 16:14:35.528 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:14:35.531 +00:00 [DBG] Created DbConnection. (1ms).
2025-10-18 16:14:35.541 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.574 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 16:14:35.576 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.579 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:14:35.644 +00:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-10-18 16:14:35.670 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.672 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.678 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (6ms).
2025-10-18 16:14:35.692 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 16:14:35.693 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:14:35.693 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 16:14:35.697 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-18 16:14:35.698 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-10-18 16:14:35.699 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.744 +00:00 [DBG] Hosting starting
2025-10-18 16:14:35.778 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.780 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-10-18 16:14:35.780 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-10-18 16:14:35.783 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:14:35.792 +00:00 [DBG] Repository contains no viable default key. Caller should generate a key with immediate activation.
2025-10-18 16:14:35.792 +00:00 [DBG] Policy resolution states that a new key should be added to the key ring.
2025-10-18 16:14:35.795 +00:00 [INF] Creating key {0bedf78f-0db3-465a-8f4d-a58fbbb9902e} with creation date 2025-10-18 16:14:35Z, activation date 2025-10-18 16:14:35Z, and expiration date 2026-01-16 16:14:35Z.
2025-10-18 16:14:35.800 +00:00 [DBG] Descriptor deserializer type for key {0bedf78f-0db3-465a-8f4d-a58fbbb9902e} is 'Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'.
2025-10-18 16:14:35.802 +00:00 [DBG] No key escrow sink found. Not writing key {0bedf78f-0db3-465a-8f4d-a58fbbb9902e} to escrow.
2025-10-18 16:14:35.802 +00:00 [WRN] No XML encryptor configured. Key {0bedf78f-0db3-465a-8f4d-a58fbbb9902e} may be persisted to storage in unencrypted form.
2025-10-18 16:14:35.803 +00:00 [DBG] Key cache expiration token triggered by 'CreateNewKey' operation.
2025-10-18 16:14:35.804 +00:00 [DBG] Found key {0bedf78f-0db3-465a-8f4d-a58fbbb9902e}.
2025-10-18 16:14:35.820 +00:00 [DBG] Considering key {0bedf78f-0db3-465a-8f4d-a58fbbb9902e} with expiration date 2026-01-16 16:14:35Z as default key.
2025-10-18 16:14:35.824 +00:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-10-18 16:14:35.828 +00:00 [DBG] Using managed symmetric algorithm 'System.Security.Cryptography.Aes'.
2025-10-18 16:14:35.828 +00:00 [DBG] Using managed keyed hash algorithm 'System.Security.Cryptography.HMACSHA256'.
2025-10-18 16:14:35.831 +00:00 [DBG] Using key {0bedf78f-0db3-465a-8f4d-a58fbbb9902e} as the default key.
2025-10-18 16:14:35.832 +00:00 [DBG] Key ring with default key {0bedf78f-0db3-465a-8f4d-a58fbbb9902e} was loaded during application startup.
2025-10-18 16:14:35.852 +00:00 [INF] Executed DbCommand (67ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:14:35.853 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.855 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (1ms).
2025-10-18 16:14:35.896 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.897 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.897 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:14:35.897 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:14:35.898 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:14:35.898 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:14:35.910 +00:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:14:35.926 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.928 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 16ms reading results.
2025-10-18 16:14:35.928 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.929 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:14:35.931 +00:00 [DBG] Migrating using database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.931 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.938 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.939 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.939 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:14:35.939 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 16:14:35.940 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:14:35.940 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:14:35.940 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.940 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.941 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:14:35.965 +00:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:14:35.965 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.965 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:14:35.966 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.974 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.975 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.975 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:14:35.975 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 16:14:35.976 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:14:35.976 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:14:35.976 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.977 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.977 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:14:35.979 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:14:35.979 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.980 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:14:35.980 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.980 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.980 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:14:35.981 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:14:35.981 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:14:35.981 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:14:35.983 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:14:35.984 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.984 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 16:14:35.984 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:14:35.985 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:14:35.993 +00:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 2AE5B9E8B7B0EDFD86FD709A56EA7C92E2569E52)
2025-10-18 16:14:35.993 +00:00 [INF] No migrations were applied. The database is already up to date.
2025-10-18 16:14:40.171 +00:00 [INF] Now listening on: http://[::]:8080
2025-10-18 16:14:40.172 +00:00 [INF] Now listening on: https://[::]:8081
2025-10-18 16:14:40.172 +00:00 [DBG] Loaded hosting startup assembly CarsTradeAPI
2025-10-18 16:14:40.172 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-18 16:14:40.173 +00:00 [INF] Hosting environment: Development
2025-10-18 16:14:40.173 +00:00 [INF] Content root path: /app
2025-10-18 16:14:40.173 +00:00 [DBG] Hosting started
2025-10-18 16:14:40.305 +00:00 [DBG] Connection id "0HNGEC5OFEBEP" accepted.
2025-10-18 16:14:40.306 +00:00 [DBG] Connection id "0HNGEC5OFEBEP" started.
2025-10-18 16:14:40.326 +00:00 [DBG] Connection 0HNGEC5OFEBEP established using the following protocol: "Tls13"
2025-10-18 16:14:40.373 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/swagger/index.html - null null
2025-10-18 16:14:40.374 +00:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-10-18 16:14:40.386 +00:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-10-18 16:14:40.386 +00:00 [DBG] Request did not match any endpoints
2025-10-18 16:14:40.490 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:14:40.604 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/swagger/index.html - 200 null text/html;charset=utf-8 232.0691ms
2025-10-18 16:14:40.705 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/swagger/v1/swagger.json - null null
2025-10-18 16:14:40.705 +00:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-10-18 16:14:40.706 +00:00 [DBG] Request did not match any endpoints
2025-10-18 16:14:40.707 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:14:40.898 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 192.5833ms
2025-10-18 16:15:53.125 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Employee/CreateAdminForTestCommand - application/json 258
2025-10-18 16:15:53.222 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/CreateAdminForTestCommand'
2025-10-18 16:15:53.225 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI)' with route pattern 'api/Employee/CreateAdminForTestCommand' is valid for the request path '/api/Employee/CreateAdminForTestCommand'
2025-10-18 16:15:53.226 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI)'
2025-10-18 16:15:53.229 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:15:53.230 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:15:53.232 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI)'
2025-10-18 16:15:53.252 +00:00 [INF] Route matched with {action = "CreateAdminForTest", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.ShowEmployeeDto]] CreateAdminForTest(CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand) on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI).
2025-10-18 16:15:53.253 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 16:15:53.254 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 16:15:53.255 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 16:15:53.255 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 16:15:53.256 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 16:15:53.257 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI)
2025-10-18 16:15:53.260 +00:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-18 16:15:53.261 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI)
2025-10-18 16:15:53.278 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand' ...
2025-10-18 16:15:53.280 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand' using the name '' in request data ...
2025-10-18 16:15:53.281 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 16:15:53.305 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:00000005": started reading request body.
2025-10-18 16:15:53.306 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:00000005": done reading request body.
2025-10-18 16:15:53.316 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand'
2025-10-18 16:15:53.317 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand'.
2025-10-18 16:15:53.317 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand'.
2025-10-18 16:15:53.318 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand' ...
2025-10-18 16:15:53.325 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand'.
2025-10-18 16:15:53.328 +00:00 [INF] Начало обработки запроса CreateAdminForTest
2025-10-18 16:15:53.447 +00:00 [INF] Начало обработки команды CreateAdminForTestCommand
2025-10-18 16:15:53.449 +00:00 [INF] Checking IdempotencyRequest for key: 34563456
2025-10-18 16:15:53.461 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 16:15:53.508 +00:00 [DBG] Compiling query expression: 
'DbSet<IdempotencyRequest>()
    .AsNoTracking()
    .FirstOrDefault(r => r.Key == __key_0)'
2025-10-18 16:15:53.627 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<IdempotencyRequest>(
    asyncEnumerable: new SingleQueryingEnumerable<IdempotencyRequest>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: IdempotencyRequest.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: IdempotencyRequest.CreatedAt (DateTime) Required, 1], [Property: IdempotencyRequest.Key (string) Required MaxLength(100), 2], [Property: IdempotencyRequest.ResourceId (Guid?), 3], [Property: IdempotencyRequest.ResourceType (string) Required MaxLength(50), 4], [Property: IdempotencyRequest.Responsejson (string), 5], [Property: IdempotencyRequest.Status (string) Required MaxLength(50), 6] }
            SELECT TOP(1) i.Id, i.CreatedAt, i.Key, i.ResourceId, i.ResourceType, i.Responsejson, i.Status
            FROM IdempotencyRequests AS i
            WHERE i.Key == @__key_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, IdempotencyRequest>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 16:15:53.648 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:15:53.648 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 16:15:53.649 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.649 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.649 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:15:53.650 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:15:53.653 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-10-18 16:15:53.654 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 16:15:53.662 +00:00 [INF] Executed DbCommand (9ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 16:15:53.666 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.667 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 4ms reading results.
2025-10-18 16:15:53.667 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.668 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:15:53.669 +00:00 [INF] IdempotencyRequest found: false
2025-10-18 16:15:53.671 +00:00 [INF] Этап проверки уникальности логина TestLogin1 в репозитории
2025-10-18 16:15:53.693 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()
    .Any(x => x.EmployeeLogin == __employeeLogin_0)'
2025-10-18 16:15:53.702 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Employees AS e
                WHERE e.employee_login == @__employeeLogin_0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 16:15:53.705 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.706 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.706 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:15:53.706 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:15:53.706 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:15:53.707 +00:00 [DBG] Executing DbCommand [Parameters=[@__employeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_login = @__employeeLogin_0)
2025-10-18 16:15:53.709 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__employeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_login = @__employeeLogin_0)
2025-10-18 16:15:53.714 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.714 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 4ms reading results.
2025-10-18 16:15:53.714 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.715 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:15:53.715 +00:00 [INF] Проверка уникальности логина TestLogin1 завершена. Результат: false
2025-10-18 16:15:53.780 +00:00 [INF] Этап создания работника с ID "eb0f27ba-5722-4ef4-9d4f-3e6a378397d9" в репозитории
2025-10-18 16:15:53.781 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()
    .FirstOrDefault(x => x.EmployeeLogin == __employee_EmployeeLogin_0)'
2025-10-18 16:15:53.785 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Employee>(
    asyncEnumerable: new SingleQueryingEnumerable<Employee>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Employee.EmployeeId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Employee.EmployeeAge (uint) Required, 1], [Property: Employee.EmployeeLogin (string) Required Index, 2], [Property: Employee.EmployeeMiddlename (string) Required, 3], [Property: Employee.EmployeeName (string) Required, 4], [Property: Employee.EmployeePassword (string) Required MaxLength(260), 5], [Property: Employee.EmployeeRole (string) Required, 6], [Property: Employee.EmployeeSellCounter (uint?), 7], [Property: Employee.EmployeeSurname (string) Required, 8] }
            SELECT TOP(1) e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
            FROM Employees AS e
            WHERE e.employee_login == @__employee_EmployeeLogin_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Employee>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 16:15:53.785 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.786 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.786 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:15:53.786 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:15:53.787 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:15:53.787 +00:00 [DBG] Executing DbCommand [Parameters=[@__employee_EmployeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__employee_EmployeeLogin_0
LIMIT 1
2025-10-18 16:15:53.802 +00:00 [INF] Executed DbCommand (15ms) [Parameters=[@__employee_EmployeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__employee_EmployeeLogin_0
LIMIT 1
2025-10-18 16:15:53.824 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.824 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 1ms reading results.
2025-10-18 16:15:53.825 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.825 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:15:53.873 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 16:15:53.875 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 16:15:53.877 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 16:15:53.890 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 16:15:53.935 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.935 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.936 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:15:53.936 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:15:53.938 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-10-18 16:15:53.938 +00:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int64), @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?' (DbType = Int64), @p8='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Employees" (employee_id, employee_age, employee_login, employee_middlename, employee_name, employee_password, employee_role, employee_sellcounter, employee_surname)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-10-18 16:15:53.946 +00:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int64), @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?' (DbType = Int64), @p8='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Employees" (employee_id, employee_age, employee_login, employee_middlename, employee_name, employee_password, employee_role, employee_sellcounter, employee_surname)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-10-18 16:15:53.949 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.949 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 2ms reading results.
2025-10-18 16:15:53.950 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.950 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:15:53.956 +00:00 [DBG] An entity of type 'Employee' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 16:15:53.957 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 16:15:53.958 +00:00 [INF] Работник успешно создан с ID: "eb0f27ba-5722-4ef4-9d4f-3e6a378397d9"
2025-10-18 16:15:53.968 +00:00 [DBG] Compiling query expression: 
'DbSet<IdempotencyRequest>()
    .Any(r => r.Key == __key_0)'
2025-10-18 16:15:53.970 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM IdempotencyRequests AS i
                WHERE i.Key == @__key_0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 16:15:53.970 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.971 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:53.971 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:15:53.971 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:15:53.971 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:15:53.972 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 16:15:53.994 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 16:15:54.016 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:54.017 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 16:15:54.017 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:54.017 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:15:54.033 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'IdempotencyRequest' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 16:15:54.033 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 16:15:54.034 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 16:15:54.041 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 16:15:54.042 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:54.042 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:54.043 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:15:54.043 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:15:54.043 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:15:54.044 +00:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 16:15:54.054 +00:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 16:15:54.055 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:54.055 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 16:15:54.055 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:54.055 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:15:54.057 +00:00 [DBG] An entity of type 'IdempotencyRequest' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 16:15:54.057 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 16:15:54.058 +00:00 [INF] IdempotencyRequest saved for key: 34563456
2025-10-18 16:15:54.256 +00:00 [INF] Администратор успешно создан с ID: "eb0f27ba-5722-4ef4-9d4f-3e6a378397d9"
2025-10-18 16:15:54.260 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 16:15:54.262 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 16:15:54.263 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 16:15:54.264 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 16:15:54.264 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 16:15:54.265 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 16:15:54.265 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.ShowEmployeeDto'.
2025-10-18 16:15:54.273 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI) in 1015.1246ms
2025-10-18 16:15:54.274 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI)'
2025-10-18 16:15:54.275 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 16:15:54.277 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:15:54.278 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (1ms).
2025-10-18 16:15:54.278 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Employee/CreateAdminForTestCommand - 200 null application/json; charset=utf-8 1153.4559ms
2025-10-18 16:17:01.047 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - application/json 58
2025-10-18 16:17:01.098 +00:00 [DBG] 1 candidate(s) found for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 16:17:01.098 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)' with route pattern 'api/EmployeeAuthentication/Authenticate' is valid for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 16:17:01.098 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 16:17:01.099 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:17:01.099 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:17:01.099 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 16:17:01.104 +00:00 [INF] Route matched with {action = "Authenticate", controller = "EmployeeAuthentication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto]] Authenticate(CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand) on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI).
2025-10-18 16:17:01.104 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 16:17:01.104 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 16:17:01.104 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 16:17:01.105 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 16:17:01.105 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 16:17:01.105 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 16:17:01.106 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 16:17:01.107 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 16:17:01.107 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' using the name '' in request data ...
2025-10-18 16:17:01.107 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 16:17:01.109 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:00000007": started reading request body.
2025-10-18 16:17:01.109 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:00000007": done reading request body.
2025-10-18 16:17:01.110 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'
2025-10-18 16:17:01.110 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 16:17:01.110 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 16:17:01.111 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 16:17:01.113 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 16:17:01.114 +00:00 [INF] Начало обработки запроса аутентификации сотрудника
2025-10-18 16:17:01.119 +00:00 [INF] Начало обработки команды EmployeeAuthenticationCommand
2025-10-18 16:17:01.120 +00:00 [INF] Этап получения сотрудника по логину TestLogin1 в репозитории
2025-10-18 16:17:01.150 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 16:17:01.152 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()
    .FirstOrDefault(x => x.EmployeeLogin == __login_0)'
2025-10-18 16:17:01.156 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Employee>(
    asyncEnumerable: new SingleQueryingEnumerable<Employee>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Employee.EmployeeId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Employee.EmployeeAge (uint) Required, 1], [Property: Employee.EmployeeLogin (string) Required Index, 2], [Property: Employee.EmployeeMiddlename (string) Required, 3], [Property: Employee.EmployeeName (string) Required, 4], [Property: Employee.EmployeePassword (string) Required MaxLength(260), 5], [Property: Employee.EmployeeRole (string) Required, 6], [Property: Employee.EmployeeSellCounter (uint?), 7], [Property: Employee.EmployeeSurname (string) Required, 8] }
            SELECT TOP(1) e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
            FROM Employees AS e
            WHERE e.employee_login == @__login_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Employee>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 16:17:01.157 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:17:01.158 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 16:17:01.158 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:17:01.158 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:17:01.158 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:17:01.159 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:17:01.159 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:17:01.159 +00:00 [DBG] Executing DbCommand [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 16:17:01.202 +00:00 [INF] Executed DbCommand (22ms) [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 16:17:01.210 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 16:17:01.211 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:17:01.211 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 8ms reading results.
2025-10-18 16:17:01.211 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:17:01.212 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:17:01.212 +00:00 [INF] Сотрудник успешно получен с логином: TestLogin1
2025-10-18 16:17:01.286 +00:00 [INF] Пользователь с логином: TestLogin1 успешно аутентифицирован
2025-10-18 16:17:01.286 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 16:17:01.287 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 16:17:01.287 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 16:17:01.287 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 16:17:01.287 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 16:17:01.288 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 16:17:01.288 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto'.
2025-10-18 16:17:01.292 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI) in 186.9668ms
2025-10-18 16:17:01.292 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 16:17:01.293 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 16:17:01.293 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:17:01.293 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:17:01.294 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - 200 null application/json; charset=utf-8 246.9672ms
2025-10-18 16:17:15.456 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - null null
2025-10-18 16:17:15.458 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 16:17:15.458 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)' with route pattern 'api/Employee/GetAllEmployee/All' is valid for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 16:17:15.458 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 16:17:15.459 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:17:15.460 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:17:15.465 +00:00 [DBG] Policy authentication schemes  did not succeed
2025-10-18 16:17:15.469 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 16:17:15.472 +00:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-10-18 16:17:15.472 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - 401 0 null 16.1278ms
2025-10-18 16:18:06.567 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - null null
2025-10-18 16:18:06.568 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 16:18:06.576 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)' with route pattern 'api/Employee/GetAllEmployee/All' is valid for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 16:18:06.583 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 16:18:06.590 +00:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14121: JWT is not a well formed JWE, there must be four dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(ReadOnlyMemory`1 encodedTokenMemory)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
2025-10-18 16:18:06.623 +00:00 [INF] Bearer was not authenticated. Failure message: IDX14121: JWT is not a well formed JWE, there must be four dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-10-18 16:18:06.623 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:18:06.624 +00:00 [DBG] Policy authentication schemes  did not succeed
2025-10-18 16:18:06.625 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 16:18:06.626 +00:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-10-18 16:18:06.626 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - 401 0 null 58.7164ms
2025-10-18 16:18:47.873 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - null null
2025-10-18 16:18:47.924 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 16:18:47.924 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)' with route pattern 'api/Employee/GetAllEmployee/All' is valid for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 16:18:47.925 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 16:18:47.925 +00:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14121: JWT is not a well formed JWE, there must be four dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(ReadOnlyMemory`1 encodedTokenMemory)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
2025-10-18 16:18:47.926 +00:00 [INF] Bearer was not authenticated. Failure message: IDX14121: JWT is not a well formed JWE, there must be four dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-10-18 16:18:47.926 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:18:47.927 +00:00 [DBG] Policy authentication schemes  did not succeed
2025-10-18 16:18:47.927 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 16:18:47.928 +00:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-10-18 16:18:47.928 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - 401 0 null 54.8218ms
2025-10-18 16:19:23.999 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - null null
2025-10-18 16:19:24.019 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 16:19:24.032 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)' with route pattern 'api/Employee/GetAllEmployee/All' is valid for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 16:19:24.033 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 16:19:24.033 +00:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14121: JWT is not a well formed JWE, there must be four dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(ReadOnlyMemory`1 encodedTokenMemory)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
2025-10-18 16:19:24.033 +00:00 [INF] Bearer was not authenticated. Failure message: IDX14121: JWT is not a well formed JWE, there must be four dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-10-18 16:19:24.034 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:19:24.034 +00:00 [DBG] Policy authentication schemes  did not succeed
2025-10-18 16:19:24.035 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 16:19:24.035 +00:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-10-18 16:19:24.035 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - 401 0 null 36.905ms
2025-10-18 16:20:21.113 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - null null
2025-10-18 16:20:21.114 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 16:20:21.120 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)' with route pattern 'api/Employee/GetAllEmployee/All' is valid for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 16:20:21.127 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 16:20:21.146 +00:00 [DBG] Successfully validated the token.
2025-10-18 16:20:21.148 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 16:20:21.149 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:20:21.149 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 16:20:21.151 +00:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-10-18 16:20:21.151 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - 403 0 null 38.5564ms
2025-10-18 16:22:25.240 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - application/json 287
2025-10-18 16:22:25.293 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/CreateEmployee'
2025-10-18 16:22:25.293 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)' with route pattern 'api/Employee/CreateEmployee' is valid for the request path '/api/Employee/CreateEmployee'
2025-10-18 16:22:25.293 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)'
2025-10-18 16:22:25.295 +00:00 [DBG] Successfully validated the token.
2025-10-18 16:22:25.295 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 16:22:25.295 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:22:25.296 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 16:22:25.296 +00:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-10-18 16:22:25.296 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - 403 0 null 56.0791ms
2025-10-18 16:22:25.297 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:00000013": started reading request body.
2025-10-18 16:22:25.297 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:00000013": done reading request body.
2025-10-18 16:22:39.761 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - application/json 58
2025-10-18 16:22:39.762 +00:00 [DBG] 1 candidate(s) found for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 16:22:39.762 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)' with route pattern 'api/EmployeeAuthentication/Authenticate' is valid for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 16:22:39.762 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 16:22:39.763 +00:00 [DBG] Successfully validated the token.
2025-10-18 16:22:39.763 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 16:22:39.763 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:22:39.764 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 16:22:39.764 +00:00 [INF] Route matched with {action = "Authenticate", controller = "EmployeeAuthentication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto]] Authenticate(CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand) on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI).
2025-10-18 16:22:39.764 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 16:22:39.765 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 16:22:39.765 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 16:22:39.765 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 16:22:39.765 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 16:22:39.765 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 16:22:39.766 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 16:22:39.766 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 16:22:39.766 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' using the name '' in request data ...
2025-10-18 16:22:39.767 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 16:22:39.767 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:00000015": started reading request body.
2025-10-18 16:22:39.767 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:00000015": done reading request body.
2025-10-18 16:22:39.767 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'
2025-10-18 16:22:39.768 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 16:22:39.768 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 16:22:39.768 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 16:22:39.768 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 16:22:39.769 +00:00 [INF] Начало обработки запроса аутентификации сотрудника
2025-10-18 16:22:39.771 +00:00 [INF] Начало обработки команды EmployeeAuthenticationCommand
2025-10-18 16:22:39.771 +00:00 [INF] Этап получения сотрудника по логину TestLogin1 в репозитории
2025-10-18 16:22:39.772 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 16:22:39.775 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:22:39.776 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 16:22:39.776 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:22:39.878 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:22:39.878 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:22:39.878 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:22:39.878 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:22:39.879 +00:00 [DBG] Executing DbCommand [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 16:22:39.881 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 16:22:39.882 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 16:22:39.882 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:22:39.882 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 1ms reading results.
2025-10-18 16:22:39.882 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:22:39.883 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:22:39.883 +00:00 [INF] Сотрудник успешно получен с логином: TestLogin1
2025-10-18 16:22:39.937 +00:00 [INF] Пользователь с логином: TestLogin1 успешно аутентифицирован
2025-10-18 16:22:39.937 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 16:22:39.937 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 16:22:39.938 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 16:22:39.938 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 16:22:39.938 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 16:22:39.938 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 16:22:39.939 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto'.
2025-10-18 16:22:39.939 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI) in 173.6234ms
2025-10-18 16:22:39.939 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 16:22:39.939 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 16:22:39.940 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:22:39.940 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:22:39.940 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - 200 null application/json; charset=utf-8 179.187ms
2025-10-18 16:23:07.774 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - application/json 287
2025-10-18 16:23:07.775 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/CreateEmployee'
2025-10-18 16:23:07.775 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)' with route pattern 'api/Employee/CreateEmployee' is valid for the request path '/api/Employee/CreateEmployee'
2025-10-18 16:23:07.790 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)'
2025-10-18 16:23:07.790 +00:00 [DBG] Successfully validated the token.
2025-10-18 16:23:07.791 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 16:23:07.791 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:23:07.791 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 16:23:07.792 +00:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-10-18 16:23:07.792 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - 403 0 null 17.8496ms
2025-10-18 16:23:07.792 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:00000017": started reading request body.
2025-10-18 16:23:07.792 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:00000017": done reading request body.
2025-10-18 16:23:28.150 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - application/json 287
2025-10-18 16:23:28.198 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/CreateEmployee'
2025-10-18 16:23:28.198 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)' with route pattern 'api/Employee/CreateEmployee' is valid for the request path '/api/Employee/CreateEmployee'
2025-10-18 16:23:28.198 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)'
2025-10-18 16:23:28.199 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:23:28.199 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:23:28.199 +00:00 [DBG] Policy authentication schemes  did not succeed
2025-10-18 16:23:28.200 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 16:23:28.200 +00:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-10-18 16:23:28.200 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - 401 0 null 74.5579ms
2025-10-18 16:23:28.201 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:00000019": started reading request body.
2025-10-18 16:23:28.201 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:00000019": done reading request body.
2025-10-18 16:23:51.098 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - application/json 287
2025-10-18 16:23:51.099 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/CreateEmployee'
2025-10-18 16:23:51.112 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)' with route pattern 'api/Employee/CreateEmployee' is valid for the request path '/api/Employee/CreateEmployee'
2025-10-18 16:23:51.112 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)'
2025-10-18 16:23:51.114 +00:00 [INF] Failed to validate the token.
System.ArgumentException: IDX14102: Unable to decode the header '[PII of type 'Microsoft.IdentityModel.Logging.SecurityArtifact' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64Url encoded string.
 ---> System.FormatException: IDX10400: Unable to decode: '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64url encoded string.
   at Microsoft.IdentityModel.Tokens.Base64UrlEncoding.ValidateAndGetOutputSize(ReadOnlySpan`1 strSpan, Int32 offset, Int32 length)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.CreateClaimSet(ReadOnlySpan`1 strSpan, Int32 startIndex, Int32 length, Boolean createHeaderClaimSet)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(ReadOnlyMemory`1 encodedTokenMemory)
   --- End of inner exception stack trace ---
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(ReadOnlyMemory`1 encodedTokenMemory)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
2025-10-18 16:23:51.116 +00:00 [INF] Bearer was not authenticated. Failure message: IDX14102: Unable to decode the header '[PII of type 'Microsoft.IdentityModel.Logging.SecurityArtifact' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64Url encoded string.
2025-10-18 16:23:51.116 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:23:51.116 +00:00 [DBG] Policy authentication schemes  did not succeed
2025-10-18 16:23:51.116 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 16:23:51.117 +00:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-10-18 16:23:51.117 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - 401 0 null 19.0505ms
2025-10-18 16:23:51.117 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:0000001B": started reading request body.
2025-10-18 16:23:51.117 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:0000001B": done reading request body.
2025-10-18 16:24:10.264 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - application/json 287
2025-10-18 16:24:10.265 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/CreateEmployee'
2025-10-18 16:24:10.265 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)' with route pattern 'api/Employee/CreateEmployee' is valid for the request path '/api/Employee/CreateEmployee'
2025-10-18 16:24:10.265 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)'
2025-10-18 16:24:10.266 +00:00 [INF] Failed to validate the token.
System.ArgumentException: IDX14102: Unable to decode the header '[PII of type 'Microsoft.IdentityModel.Logging.SecurityArtifact' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64Url encoded string.
 ---> System.FormatException: IDX10400: Unable to decode: '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64url encoded string.
   at Microsoft.IdentityModel.Tokens.Base64UrlEncoding.ValidateAndGetOutputSize(ReadOnlySpan`1 strSpan, Int32 offset, Int32 length)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.CreateClaimSet(ReadOnlySpan`1 strSpan, Int32 startIndex, Int32 length, Boolean createHeaderClaimSet)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(ReadOnlyMemory`1 encodedTokenMemory)
   --- End of inner exception stack trace ---
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(ReadOnlyMemory`1 encodedTokenMemory)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
2025-10-18 16:24:10.266 +00:00 [INF] Bearer was not authenticated. Failure message: IDX14102: Unable to decode the header '[PII of type 'Microsoft.IdentityModel.Logging.SecurityArtifact' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64Url encoded string.
2025-10-18 16:24:10.267 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:24:10.267 +00:00 [DBG] Policy authentication schemes  did not succeed
2025-10-18 16:24:10.267 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 16:24:10.267 +00:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-10-18 16:24:10.268 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - 401 0 null 4.0436ms
2025-10-18 16:24:10.268 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:0000001D": started reading request body.
2025-10-18 16:24:10.268 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:0000001D": done reading request body.
2025-10-18 16:24:26.988 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - application/json 287
2025-10-18 16:24:27.009 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/CreateEmployee'
2025-10-18 16:24:27.009 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)' with route pattern 'api/Employee/CreateEmployee' is valid for the request path '/api/Employee/CreateEmployee'
2025-10-18 16:24:27.009 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)'
2025-10-18 16:24:27.010 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:24:27.010 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:24:27.010 +00:00 [DBG] Policy authentication schemes  did not succeed
2025-10-18 16:24:27.011 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 16:24:27.011 +00:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-10-18 16:24:27.011 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - 401 0 null 23.8264ms
2025-10-18 16:24:27.011 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:0000001F": started reading request body.
2025-10-18 16:24:27.012 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:0000001F": done reading request body.
2025-10-18 16:34:58.342 +00:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 2AE5B9E8B7B0EDFD86FD709A56EA7C92E2569E52)
2025-10-18 16:34:58.343 +00:00 [DBG] Config reload token fired. Checking for changes...
2025-10-18 16:36:15.445 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - null null
2025-10-18 16:36:15.474 +00:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-10-18 16:36:15.511 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 16:36:15.512 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)' with route pattern 'api/Employee/GetAllEmployee/All' is valid for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 16:36:15.512 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 16:36:15.512 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:36:15.513 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:36:15.513 +00:00 [DBG] Policy authentication schemes  did not succeed
2025-10-18 16:36:15.513 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 16:36:15.514 +00:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-10-18 16:36:15.514 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - 401 0 null 69.009ms
2025-10-18 16:36:30.276 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - application/json 58
2025-10-18 16:36:30.277 +00:00 [DBG] 1 candidate(s) found for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 16:36:30.278 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)' with route pattern 'api/EmployeeAuthentication/Authenticate' is valid for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 16:36:30.278 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 16:36:30.278 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:36:30.278 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:36:30.279 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 16:36:30.281 +00:00 [INF] Route matched with {action = "Authenticate", controller = "EmployeeAuthentication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto]] Authenticate(CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand) on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI).
2025-10-18 16:36:30.282 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 16:36:30.282 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 16:36:30.283 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 16:36:30.284 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 16:36:30.284 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 16:36:30.284 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 16:36:30.285 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 16:36:30.285 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 16:36:30.285 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' using the name '' in request data ...
2025-10-18 16:36:30.286 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 16:36:30.286 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:00000023": started reading request body.
2025-10-18 16:36:30.286 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:00000023": done reading request body.
2025-10-18 16:36:30.286 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'
2025-10-18 16:36:30.287 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 16:36:30.287 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 16:36:30.287 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 16:36:30.288 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 16:36:30.288 +00:00 [INF] Начало обработки запроса аутентификации сотрудника
2025-10-18 16:36:30.292 +00:00 [INF] Начало обработки команды EmployeeAuthenticationCommand
2025-10-18 16:36:30.293 +00:00 [INF] Этап получения сотрудника по логину TestLogin1 в репозитории
2025-10-18 16:36:30.294 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 16:36:30.294 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:36:30.294 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 16:36:30.295 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:36:30.327 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:36:30.327 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:36:30.327 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:36:30.328 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:36:30.328 +00:00 [DBG] Executing DbCommand [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 16:36:30.330 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 16:36:30.331 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 16:36:30.331 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:36:30.331 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 16:36:30.331 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:36:30.332 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:36:30.332 +00:00 [INF] Сотрудник успешно получен с логином: TestLogin1
2025-10-18 16:36:30.380 +00:00 [INF] Пользователь с логином: TestLogin1 успешно аутентифицирован
2025-10-18 16:36:30.380 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 16:36:30.381 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 16:36:30.381 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 16:36:30.381 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 16:36:30.381 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 16:36:30.382 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 16:36:30.382 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto'.
2025-10-18 16:36:30.382 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI) in 98.1693ms
2025-10-18 16:36:30.383 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 16:36:30.383 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 16:36:30.383 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:36:30.384 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:36:30.384 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - 200 null application/json; charset=utf-8 107.7137ms
2025-10-18 16:36:52.077 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - application/json 287
2025-10-18 16:36:52.099 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/CreateEmployee'
2025-10-18 16:36:52.105 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)' with route pattern 'api/Employee/CreateEmployee' is valid for the request path '/api/Employee/CreateEmployee'
2025-10-18 16:36:52.112 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)'
2025-10-18 16:36:52.113 +00:00 [DBG] Successfully validated the token.
2025-10-18 16:36:52.113 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 16:36:52.113 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:36:52.114 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 16:36:52.114 +00:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-10-18 16:36:52.114 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - 403 0 null 36.9236ms
2025-10-18 16:36:52.115 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:00000025": started reading request body.
2025-10-18 16:36:52.115 +00:00 [DBG] Connection id "0HNGEC5OFEBEP", Request id "0HNGEC5OFEBEP:00000025": done reading request body.
2025-10-18 16:49:43.663 +00:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-18 16:49:44.217 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 16:49:44.226 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:49:44.230 +00:00 [DBG] Created DbConnection. (2ms).
2025-10-18 16:49:44.239 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.273 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 16:49:44.275 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.278 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:49:44.346 +00:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-10-18 16:49:44.388 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.390 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.399 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (7ms).
2025-10-18 16:49:44.416 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 16:49:44.417 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:49:44.417 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 16:49:44.422 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-18 16:49:44.427 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (7ms).
2025-10-18 16:49:44.428 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.582 +00:00 [DBG] Hosting starting
2025-10-18 16:49:44.586 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.620 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-10-18 16:49:44.621 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-10-18 16:49:44.621 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:49:44.632 +00:00 [DBG] Repository contains no viable default key. Caller should generate a key with immediate activation.
2025-10-18 16:49:44.632 +00:00 [DBG] Policy resolution states that a new key should be added to the key ring.
2025-10-18 16:49:44.635 +00:00 [INF] Creating key {c0110e70-6499-4e45-bc47-8a0fe3eceb6d} with creation date 2025-10-18 16:49:44Z, activation date 2025-10-18 16:49:44Z, and expiration date 2026-01-16 16:49:44Z.
2025-10-18 16:49:44.641 +00:00 [DBG] Descriptor deserializer type for key {c0110e70-6499-4e45-bc47-8a0fe3eceb6d} is 'Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'.
2025-10-18 16:49:44.643 +00:00 [DBG] No key escrow sink found. Not writing key {c0110e70-6499-4e45-bc47-8a0fe3eceb6d} to escrow.
2025-10-18 16:49:44.644 +00:00 [WRN] No XML encryptor configured. Key {c0110e70-6499-4e45-bc47-8a0fe3eceb6d} may be persisted to storage in unencrypted form.
2025-10-18 16:49:44.644 +00:00 [DBG] Key cache expiration token triggered by 'CreateNewKey' operation.
2025-10-18 16:49:44.645 +00:00 [DBG] Found key {c0110e70-6499-4e45-bc47-8a0fe3eceb6d}.
2025-10-18 16:49:44.662 +00:00 [DBG] Considering key {c0110e70-6499-4e45-bc47-8a0fe3eceb6d} with expiration date 2026-01-16 16:49:44Z as default key.
2025-10-18 16:49:44.666 +00:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-10-18 16:49:44.669 +00:00 [DBG] Using managed symmetric algorithm 'System.Security.Cryptography.Aes'.
2025-10-18 16:49:44.669 +00:00 [DBG] Using managed keyed hash algorithm 'System.Security.Cryptography.HMACSHA256'.
2025-10-18 16:49:44.672 +00:00 [DBG] Using key {c0110e70-6499-4e45-bc47-8a0fe3eceb6d} as the default key.
2025-10-18 16:49:44.672 +00:00 [DBG] Key ring with default key {c0110e70-6499-4e45-bc47-8a0fe3eceb6d} was loaded during application startup.
2025-10-18 16:49:44.690 +00:00 [INF] Executed DbCommand (87ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:49:44.691 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.692 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (1ms).
2025-10-18 16:49:44.733 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.733 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.733 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:49:44.734 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:49:44.734 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:49:44.735 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:49:44.747 +00:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:49:44.754 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.765 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 6ms reading results.
2025-10-18 16:49:44.766 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.766 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:49:44.768 +00:00 [DBG] Migrating using database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.768 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.777 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.783 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.783 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:49:44.784 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 16:49:44.784 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:49:44.784 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:49:44.784 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.785 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.785 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:49:44.788 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:49:44.788 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.789 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:49:44.789 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.818 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.819 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.819 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:49:44.819 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 16:49:44.820 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:49:44.820 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:49:44.820 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.820 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.821 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:49:44.823 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:49:44.823 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.823 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:49:44.824 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.824 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.824 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:49:44.825 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:49:44.825 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:49:44.825 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:49:44.848 +00:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:49:44.848 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.849 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 16:49:44.849 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:49:44.849 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:49:44.854 +00:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 2AE5B9E8B7B0EDFD86FD709A56EA7C92E2569E52)
2025-10-18 16:49:44.858 +00:00 [INF] No migrations were applied. The database is already up to date.
2025-10-18 16:49:45.049 +00:00 [INF] Now listening on: http://[::]:8080
2025-10-18 16:49:45.049 +00:00 [INF] Now listening on: https://[::]:8081
2025-10-18 16:49:45.049 +00:00 [DBG] Loaded hosting startup assembly CarsTradeAPI
2025-10-18 16:49:45.050 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-18 16:49:45.051 +00:00 [INF] Hosting environment: Development
2025-10-18 16:49:45.051 +00:00 [INF] Content root path: /app
2025-10-18 16:49:45.051 +00:00 [DBG] Hosting started
2025-10-18 16:49:45.241 +00:00 [DBG] Connection id "0HNGECPBPLLJT" accepted.
2025-10-18 16:49:45.242 +00:00 [DBG] Connection id "0HNGECPBPLLJT" started.
2025-10-18 16:49:45.285 +00:00 [DBG] Connection 0HNGECPBPLLJT established using the following protocol: "Tls13"
2025-10-18 16:49:45.332 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/swagger/index.html - null null
2025-10-18 16:49:45.333 +00:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-10-18 16:49:45.346 +00:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-10-18 16:49:45.347 +00:00 [DBG] Request did not match any endpoints
2025-10-18 16:49:45.470 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/swagger/index.html - 200 null text/html;charset=utf-8 138.6062ms
2025-10-18 16:49:45.551 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/swagger/v1/swagger.json - null null
2025-10-18 16:49:45.551 +00:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-10-18 16:49:45.551 +00:00 [DBG] Request did not match any endpoints
2025-10-18 16:49:45.801 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 249.8611ms
2025-10-18 16:50:31.372 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Employee/CreateAdminForTestCommand - application/json 233
2025-10-18 16:50:31.433 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/CreateAdminForTestCommand'
2025-10-18 16:50:31.436 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI)' with route pattern 'api/Employee/CreateAdminForTestCommand' is valid for the request path '/api/Employee/CreateAdminForTestCommand'
2025-10-18 16:50:31.438 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI)'
2025-10-18 16:50:31.440 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:50:31.537 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:50:31.539 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI)'
2025-10-18 16:50:31.559 +00:00 [INF] Route matched with {action = "CreateAdminForTest", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.ShowEmployeeDto]] CreateAdminForTest(CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand) on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI).
2025-10-18 16:50:31.560 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 16:50:31.561 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 16:50:31.562 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 16:50:31.562 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 16:50:31.562 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 16:50:31.563 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI)
2025-10-18 16:50:31.566 +00:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-18 16:50:31.567 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI)
2025-10-18 16:50:31.585 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand' ...
2025-10-18 16:50:31.588 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand' using the name '' in request data ...
2025-10-18 16:50:31.589 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 16:50:31.614 +00:00 [DBG] Connection id "0HNGECPBPLLJT", Request id "0HNGECPBPLLJT:00000005": started reading request body.
2025-10-18 16:50:31.614 +00:00 [DBG] Connection id "0HNGECPBPLLJT", Request id "0HNGECPBPLLJT:00000005": done reading request body.
2025-10-18 16:50:31.626 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand'
2025-10-18 16:50:31.626 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand'.
2025-10-18 16:50:31.627 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand'.
2025-10-18 16:50:31.627 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand' ...
2025-10-18 16:50:31.635 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateAdminForTest.CreateAdminForTestCommand'.
2025-10-18 16:50:31.637 +00:00 [INF] Начало обработки запроса CreateAdminForTest
2025-10-18 16:50:31.747 +00:00 [INF] Начало обработки команды CreateAdminForTestCommand
2025-10-18 16:50:31.748 +00:00 [INF] Checking IdempotencyRequest for key: sdfgew3452
2025-10-18 16:50:31.759 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 16:50:31.806 +00:00 [DBG] Compiling query expression: 
'DbSet<IdempotencyRequest>()
    .AsNoTracking()
    .FirstOrDefault(r => r.Key == __key_0)'
2025-10-18 16:50:31.925 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<IdempotencyRequest>(
    asyncEnumerable: new SingleQueryingEnumerable<IdempotencyRequest>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: IdempotencyRequest.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: IdempotencyRequest.CreatedAt (DateTime) Required, 1], [Property: IdempotencyRequest.Key (string) Required MaxLength(100), 2], [Property: IdempotencyRequest.ResourceId (Guid?), 3], [Property: IdempotencyRequest.ResourceType (string) Required MaxLength(50), 4], [Property: IdempotencyRequest.Responsejson (string), 5], [Property: IdempotencyRequest.Status (string) Required MaxLength(50), 6] }
            SELECT TOP(1) i.Id, i.CreatedAt, i.Key, i.ResourceId, i.ResourceType, i.Responsejson, i.Status
            FROM IdempotencyRequests AS i
            WHERE i.Key == @__key_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, IdempotencyRequest>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 16:50:31.943 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:50:31.943 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 16:50:31.944 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:31.944 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:31.944 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:50:31.945 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:50:31.948 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2025-10-18 16:50:31.949 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 16:50:31.978 +00:00 [INF] Executed DbCommand (9ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 16:50:31.982 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:31.982 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 3ms reading results.
2025-10-18 16:50:31.983 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:31.983 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:50:31.984 +00:00 [INF] IdempotencyRequest found: false
2025-10-18 16:50:31.987 +00:00 [INF] Этап проверки уникальности логина test1 в репозитории
2025-10-18 16:50:31.989 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()
    .Any(x => x.EmployeeLogin == __employeeLogin_0)'
2025-10-18 16:50:31.997 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Employees AS e
                WHERE e.employee_login == @__employeeLogin_0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 16:50:32.000 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.000 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.001 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:50:32.001 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:50:32.001 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:50:32.001 +00:00 [DBG] Executing DbCommand [Parameters=[@__employeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_login = @__employeeLogin_0)
2025-10-18 16:50:32.024 +00:00 [INF] Executed DbCommand (23ms) [Parameters=[@__employeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_login = @__employeeLogin_0)
2025-10-18 16:50:32.029 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.030 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 4ms reading results.
2025-10-18 16:50:32.030 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.030 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:50:32.031 +00:00 [INF] Проверка уникальности логина test1 завершена. Результат: false
2025-10-18 16:50:32.094 +00:00 [INF] Этап создания работника с ID "fa3c85fe-ac33-4dd1-8515-7a0be1bc134c" в репозитории
2025-10-18 16:50:32.095 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()
    .FirstOrDefault(x => x.EmployeeLogin == __employee_EmployeeLogin_0)'
2025-10-18 16:50:32.099 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Employee>(
    asyncEnumerable: new SingleQueryingEnumerable<Employee>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Employee.EmployeeId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Employee.EmployeeAge (uint) Required, 1], [Property: Employee.EmployeeLogin (string) Required Index, 2], [Property: Employee.EmployeeMiddlename (string) Required, 3], [Property: Employee.EmployeeName (string) Required, 4], [Property: Employee.EmployeePassword (string) Required MaxLength(260), 5], [Property: Employee.EmployeeRole (string) Required, 6], [Property: Employee.EmployeeSellCounter (uint?), 7], [Property: Employee.EmployeeSurname (string) Required, 8] }
            SELECT TOP(1) e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
            FROM Employees AS e
            WHERE e.employee_login == @__employee_EmployeeLogin_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Employee>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 16:50:32.100 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.100 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.101 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:50:32.101 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:50:32.101 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:50:32.101 +00:00 [DBG] Executing DbCommand [Parameters=[@__employee_EmployeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__employee_EmployeeLogin_0
LIMIT 1
2025-10-18 16:50:32.103 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__employee_EmployeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__employee_EmployeeLogin_0
LIMIT 1
2025-10-18 16:50:32.137 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.137 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 33ms reading results.
2025-10-18 16:50:32.137 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.138 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:50:32.184 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 16:50:32.186 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 16:50:32.188 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 16:50:32.198 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 16:50:32.233 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.233 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.234 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:50:32.234 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:50:32.236 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-10-18 16:50:32.236 +00:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int64), @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?' (DbType = Int64), @p8='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Employees" (employee_id, employee_age, employee_login, employee_middlename, employee_name, employee_password, employee_role, employee_sellcounter, employee_surname)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-10-18 16:50:32.242 +00:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int64), @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?' (DbType = Int64), @p8='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Employees" (employee_id, employee_age, employee_login, employee_middlename, employee_name, employee_password, employee_role, employee_sellcounter, employee_surname)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-10-18 16:50:32.245 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.246 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 2ms reading results.
2025-10-18 16:50:32.246 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.247 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:50:32.253 +00:00 [DBG] An entity of type 'Employee' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 16:50:32.255 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 16:50:32.255 +00:00 [INF] Работник успешно создан с ID: "fa3c85fe-ac33-4dd1-8515-7a0be1bc134c"
2025-10-18 16:50:32.266 +00:00 [DBG] Compiling query expression: 
'DbSet<IdempotencyRequest>()
    .Any(r => r.Key == __key_0)'
2025-10-18 16:50:32.267 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM IdempotencyRequests AS i
                WHERE i.Key == @__key_0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 16:50:32.268 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.268 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.268 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:50:32.269 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:50:32.269 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:50:32.269 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 16:50:32.272 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 16:50:32.273 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.273 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 16:50:32.273 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.273 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:50:32.288 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'IdempotencyRequest' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 16:50:32.289 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 16:50:32.289 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 16:50:32.296 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 16:50:32.297 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.297 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.298 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:50:32.298 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:50:32.299 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:50:32.299 +00:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 16:50:32.326 +00:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 16:50:32.347 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.347 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 20ms reading results.
2025-10-18 16:50:32.348 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.348 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:50:32.350 +00:00 [DBG] An entity of type 'IdempotencyRequest' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 16:50:32.350 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 16:50:32.350 +00:00 [INF] IdempotencyRequest saved for key: sdfgew3452
2025-10-18 16:50:32.539 +00:00 [INF] Администратор успешно создан с ID: "fa3c85fe-ac33-4dd1-8515-7a0be1bc134c"
2025-10-18 16:50:32.544 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 16:50:32.546 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 16:50:32.546 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 16:50:32.547 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 16:50:32.547 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 16:50:32.548 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 16:50:32.549 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.ShowEmployeeDto'.
2025-10-18 16:50:32.556 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI) in 993.1115ms
2025-10-18 16:50:32.557 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateAdminForTest (CarsTradeAPI)'
2025-10-18 16:50:32.558 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 16:50:32.560 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:32.561 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:50:32.561 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Employee/CreateAdminForTestCommand - 200 null application/json; charset=utf-8 1190.0798ms
2025-10-18 16:50:59.175 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - application/json 45
2025-10-18 16:50:59.201 +00:00 [DBG] 1 candidate(s) found for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 16:50:59.202 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)' with route pattern 'api/EmployeeAuthentication/Authenticate' is valid for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 16:50:59.202 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 16:50:59.202 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:50:59.204 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 16:50:59.204 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 16:50:59.208 +00:00 [INF] Route matched with {action = "Authenticate", controller = "EmployeeAuthentication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto]] Authenticate(CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand) on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI).
2025-10-18 16:50:59.209 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 16:50:59.209 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 16:50:59.210 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 16:50:59.210 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 16:50:59.210 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 16:50:59.210 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 16:50:59.211 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 16:50:59.212 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 16:50:59.212 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' using the name '' in request data ...
2025-10-18 16:50:59.213 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 16:50:59.214 +00:00 [DBG] Connection id "0HNGECPBPLLJT", Request id "0HNGECPBPLLJT:00000007": started reading request body.
2025-10-18 16:50:59.215 +00:00 [DBG] Connection id "0HNGECPBPLLJT", Request id "0HNGECPBPLLJT:00000007": done reading request body.
2025-10-18 16:50:59.216 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'
2025-10-18 16:50:59.216 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 16:50:59.216 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 16:50:59.217 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 16:50:59.218 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 16:50:59.219 +00:00 [INF] Начало обработки запроса аутентификации сотрудника
2025-10-18 16:50:59.223 +00:00 [INF] Начало обработки команды EmployeeAuthenticationCommand
2025-10-18 16:50:59.224 +00:00 [INF] Этап получения сотрудника по логину test1 в репозитории
2025-10-18 16:50:59.263 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 16:50:59.264 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()
    .FirstOrDefault(x => x.EmployeeLogin == __login_0)'
2025-10-18 16:50:59.268 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Employee>(
    asyncEnumerable: new SingleQueryingEnumerable<Employee>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Employee.EmployeeId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Employee.EmployeeAge (uint) Required, 1], [Property: Employee.EmployeeLogin (string) Required Index, 2], [Property: Employee.EmployeeMiddlename (string) Required, 3], [Property: Employee.EmployeeName (string) Required, 4], [Property: Employee.EmployeePassword (string) Required MaxLength(260), 5], [Property: Employee.EmployeeRole (string) Required, 6], [Property: Employee.EmployeeSellCounter (uint?), 7], [Property: Employee.EmployeeSurname (string) Required, 8] }
            SELECT TOP(1) e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
            FROM Employees AS e
            WHERE e.employee_login == @__login_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Employee>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 16:50:59.269 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:50:59.269 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 16:50:59.269 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:59.270 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:59.270 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:50:59.270 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:50:59.271 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:50:59.271 +00:00 [DBG] Executing DbCommand [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 16:50:59.272 +00:00 [INF] Executed DbCommand (1ms) [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 16:50:59.275 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 16:50:59.276 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:59.276 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 3ms reading results.
2025-10-18 16:50:59.276 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:59.277 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:50:59.277 +00:00 [INF] Сотрудник успешно получен с логином: test1
2025-10-18 16:50:59.356 +00:00 [INF] Пользователь с логином: test1 успешно аутентифицирован
2025-10-18 16:50:59.356 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 16:50:59.357 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 16:50:59.357 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 16:50:59.357 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 16:50:59.357 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 16:50:59.358 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 16:50:59.358 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto'.
2025-10-18 16:50:59.362 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI) in 151.6465ms
2025-10-18 16:50:59.362 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 16:50:59.363 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 16:50:59.363 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:50:59.363 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:50:59.364 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - 200 null application/json; charset=utf-8 188.2474ms
2025-10-18 16:51:20.075 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - null null
2025-10-18 16:51:20.089 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 16:51:20.090 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)' with route pattern 'api/Employee/GetAllEmployee/All' is valid for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 16:51:20.090 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 16:51:20.090 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 16:51:20.116 +00:00 [DBG] Successfully validated the token.
2025-10-18 16:51:20.118 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 16:51:20.122 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 16:51:20.123 +00:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-10-18 16:51:20.123 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - 403 0 null 48.1658ms
2025-10-18 16:59:28.958 +00:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-18 16:59:29.502 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 16:59:29.511 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:59:29.514 +00:00 [DBG] Created DbConnection. (2ms).
2025-10-18 16:59:29.524 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.559 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 16:59:29.560 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.564 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:59:29.649 +00:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-10-18 16:59:29.676 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.678 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.685 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (6ms).
2025-10-18 16:59:29.700 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 16:59:29.700 +00:00 [DBG] Creating DbConnection.
2025-10-18 16:59:29.701 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 16:59:29.706 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-18 16:59:29.706 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-10-18 16:59:29.707 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.753 +00:00 [DBG] Hosting starting
2025-10-18 16:59:29.789 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.790 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-10-18 16:59:29.790 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-10-18 16:59:29.794 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:59:29.802 +00:00 [DBG] Repository contains no viable default key. Caller should generate a key with immediate activation.
2025-10-18 16:59:29.803 +00:00 [DBG] Policy resolution states that a new key should be added to the key ring.
2025-10-18 16:59:29.805 +00:00 [INF] Creating key {391742be-65f4-4b16-8933-57a11d221327} with creation date 2025-10-18 16:59:29Z, activation date 2025-10-18 16:59:29Z, and expiration date 2026-01-16 16:59:29Z.
2025-10-18 16:59:29.810 +00:00 [DBG] Descriptor deserializer type for key {391742be-65f4-4b16-8933-57a11d221327} is 'Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'.
2025-10-18 16:59:29.812 +00:00 [DBG] No key escrow sink found. Not writing key {391742be-65f4-4b16-8933-57a11d221327} to escrow.
2025-10-18 16:59:29.813 +00:00 [WRN] No XML encryptor configured. Key {391742be-65f4-4b16-8933-57a11d221327} may be persisted to storage in unencrypted form.
2025-10-18 16:59:29.813 +00:00 [DBG] Key cache expiration token triggered by 'CreateNewKey' operation.
2025-10-18 16:59:29.814 +00:00 [DBG] Found key {391742be-65f4-4b16-8933-57a11d221327}.
2025-10-18 16:59:29.830 +00:00 [DBG] Considering key {391742be-65f4-4b16-8933-57a11d221327} with expiration date 2026-01-16 16:59:29Z as default key.
2025-10-18 16:59:29.835 +00:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-10-18 16:59:29.837 +00:00 [DBG] Using managed symmetric algorithm 'System.Security.Cryptography.Aes'.
2025-10-18 16:59:29.837 +00:00 [DBG] Using managed keyed hash algorithm 'System.Security.Cryptography.HMACSHA256'.
2025-10-18 16:59:29.840 +00:00 [DBG] Using key {391742be-65f4-4b16-8933-57a11d221327} as the default key.
2025-10-18 16:59:29.841 +00:00 [DBG] Key ring with default key {391742be-65f4-4b16-8933-57a11d221327} was loaded during application startup.
2025-10-18 16:59:29.862 +00:00 [INF] Executed DbCommand (67ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:59:29.863 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.885 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (21ms).
2025-10-18 16:59:29.913 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.913 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.913 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:59:29.914 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:59:29.914 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:59:29.915 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:59:29.920 +00:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:59:29.936 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.937 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 15ms reading results.
2025-10-18 16:59:29.938 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.938 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:59:29.940 +00:00 [DBG] Migrating using database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.940 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.948 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.949 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.949 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:59:29.949 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 16:59:29.950 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:59:29.950 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:59:29.950 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.950 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.951 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:59:29.954 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:59:29.954 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.954 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:59:29.955 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.963 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.963 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.964 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:59:29.964 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 16:59:29.964 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:59:29.965 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 16:59:29.965 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.965 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.965 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:59:29.968 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 16:59:29.981 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.981 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:59:29.982 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.982 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:29.982 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 16:59:29.983 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:59:29.983 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 16:59:29.983 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:59:30.006 +00:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 16:59:30.006 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:30.007 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 16:59:30.007 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 16:59:30.007 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 16:59:30.009 +00:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 2AE5B9E8B7B0EDFD86FD709A56EA7C92E2569E52)
2025-10-18 16:59:30.017 +00:00 [INF] No migrations were applied. The database is already up to date.
2025-10-18 16:59:30.211 +00:00 [INF] Now listening on: http://[::]:8080
2025-10-18 16:59:30.211 +00:00 [INF] Now listening on: https://[::]:8081
2025-10-18 16:59:30.212 +00:00 [DBG] Loaded hosting startup assembly CarsTradeAPI
2025-10-18 16:59:30.212 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-18 16:59:30.212 +00:00 [INF] Hosting environment: Development
2025-10-18 16:59:30.213 +00:00 [INF] Content root path: /app
2025-10-18 16:59:30.213 +00:00 [DBG] Hosting started
2025-10-18 16:59:30.350 +00:00 [DBG] Connection id "0HNGECUQ5MQO4" accepted.
2025-10-18 16:59:30.351 +00:00 [DBG] Connection id "0HNGECUQ5MQO4" started.
2025-10-18 16:59:30.371 +00:00 [DBG] Connection 0HNGECUQ5MQO4 established using the following protocol: "Tls13"
2025-10-18 16:59:30.424 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/swagger/index.html - null null
2025-10-18 16:59:30.425 +00:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-10-18 16:59:30.437 +00:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-10-18 16:59:30.438 +00:00 [DBG] Request did not match any endpoints
2025-10-18 16:59:30.562 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/swagger/index.html - 200 null text/html;charset=utf-8 138.4292ms
2025-10-18 16:59:30.640 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/swagger/v1/swagger.json - null null
2025-10-18 16:59:30.640 +00:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-10-18 16:59:30.640 +00:00 [DBG] Request did not match any endpoints
2025-10-18 16:59:30.813 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 172.8963ms
2025-10-18 17:00:31.080 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - application/json 45
2025-10-18 17:00:31.098 +00:00 [DBG] 1 candidate(s) found for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 17:00:31.105 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)' with route pattern 'api/EmployeeAuthentication/Authenticate' is valid for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 17:00:31.106 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 17:00:31.107 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 17:00:31.202 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 17:00:31.205 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 17:00:31.221 +00:00 [INF] Route matched with {action = "Authenticate", controller = "EmployeeAuthentication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto]] Authenticate(CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand) on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI).
2025-10-18 17:00:31.223 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 17:00:31.223 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 17:00:31.224 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 17:00:31.224 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 17:00:31.224 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 17:00:31.226 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 17:00:31.228 +00:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-18 17:00:31.229 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 17:00:31.244 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 17:00:31.246 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' using the name '' in request data ...
2025-10-18 17:00:31.247 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 17:00:31.268 +00:00 [DBG] Connection id "0HNGECUQ5MQO4", Request id "0HNGECUQ5MQO4:00000005": started reading request body.
2025-10-18 17:00:31.269 +00:00 [DBG] Connection id "0HNGECUQ5MQO4", Request id "0HNGECUQ5MQO4:00000005": done reading request body.
2025-10-18 17:00:31.278 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'
2025-10-18 17:00:31.279 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 17:00:31.279 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 17:00:31.279 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 17:00:31.284 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 17:00:31.287 +00:00 [INF] Начало обработки запроса аутентификации сотрудника
2025-10-18 17:00:31.394 +00:00 [INF] Начало обработки команды EmployeeAuthenticationCommand
2025-10-18 17:00:31.396 +00:00 [INF] Этап получения сотрудника по логину test1 в репозитории
2025-10-18 17:00:31.430 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 17:00:31.449 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()
    .FirstOrDefault(x => x.EmployeeLogin == __login_0)'
2025-10-18 17:00:31.573 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Employee>(
    asyncEnumerable: new SingleQueryingEnumerable<Employee>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Employee.EmployeeId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Employee.EmployeeAge (uint) Required, 1], [Property: Employee.EmployeeLogin (string) Required Index, 2], [Property: Employee.EmployeeMiddlename (string) Required, 3], [Property: Employee.EmployeeName (string) Required, 4], [Property: Employee.EmployeePassword (string) Required MaxLength(260), 5], [Property: Employee.EmployeeRole (string) Required, 6], [Property: Employee.EmployeeSellCounter (uint?), 7], [Property: Employee.EmployeeSurname (string) Required, 8] }
            SELECT TOP(1) e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
            FROM Employees AS e
            WHERE e.employee_login == @__login_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Employee>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 17:00:31.591 +00:00 [DBG] Creating DbConnection.
2025-10-18 17:00:31.591 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 17:00:31.591 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 17:00:31.592 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 17:00:31.592 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 17:00:31.592 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 17:00:31.595 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-10-18 17:00:31.597 +00:00 [DBG] Executing DbCommand [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 17:00:31.605 +00:00 [INF] Executed DbCommand (9ms) [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 17:00:31.655 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 17:00:31.675 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 17:00:31.676 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 70ms reading results.
2025-10-18 17:00:31.676 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 17:00:31.676 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 17:00:31.677 +00:00 [INF] Сотрудник успешно получен с логином: test1
2025-10-18 17:00:31.763 +00:00 [INF] Пользователь с логином: test1 успешно аутентифицирован
2025-10-18 17:00:31.768 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 17:00:31.769 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 17:00:31.770 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 17:00:31.770 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 17:00:31.770 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 17:00:31.771 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 17:00:31.772 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto'.
2025-10-18 17:00:31.784 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI) in 557.5988ms
2025-10-18 17:00:31.785 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 17:00:31.786 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 17:00:31.788 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 17:00:31.789 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 17:00:31.789 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - 200 null application/json; charset=utf-8 729.5118ms
2025-10-18 17:00:54.868 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - null null
2025-10-18 17:00:54.884 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 17:00:54.884 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)' with route pattern 'api/Employee/GetAllEmployee/All' is valid for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 17:00:54.884 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 17:00:54.884 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 17:00:54.909 +00:00 [DBG] Successfully validated the token.
2025-10-18 17:00:54.911 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 17:00:54.915 +00:00 [DBG] Authorization was successful.
2025-10-18 17:00:54.916 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 17:00:54.920 +00:00 [INF] Route matched with {action = "GetAllEmployee", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.ShowEmployeeDto]]] GetAllEmployee() on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI).
2025-10-18 17:00:54.920 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 17:00:54.921 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 17:00:54.921 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 17:00:54.921 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 17:00:54.922 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 17:00:54.922 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI)
2025-10-18 17:00:54.923 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI)
2025-10-18 17:00:54.924 +00:00 [INF] Начало обработки запроса GetAllEmployee
2025-10-18 17:00:54.927 +00:00 [INF] Начало обработки команды GetAllEmployeeQuery
2025-10-18 17:00:55.170 +00:00 [INF] Этап получения всех сотрудников в репозитории
2025-10-18 17:00:55.200 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 17:00:55.202 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()'
2025-10-18 17:00:55.205 +00:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Employee>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Employee.EmployeeId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Employee.EmployeeAge (uint) Required, 1], [Property: Employee.EmployeeLogin (string) Required Index, 2], [Property: Employee.EmployeeMiddlename (string) Required, 3], [Property: Employee.EmployeeName (string) Required, 4], [Property: Employee.EmployeePassword (string) Required MaxLength(260), 5], [Property: Employee.EmployeeRole (string) Required, 6], [Property: Employee.EmployeeSellCounter (uint?), 7], [Property: Employee.EmployeeSurname (string) Required, 8] }
        SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
        FROM Employees AS e), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Employee>, 
    CarsTradeAPI.Data.CarsTradeDbContext, 
    False, 
    False, 
    True
)'
2025-10-18 17:00:55.206 +00:00 [DBG] Creating DbConnection.
2025-10-18 17:00:55.206 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 17:00:55.206 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 17:00:55.207 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 17:00:55.207 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 17:00:55.207 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 17:00:55.207 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 17:00:55.208 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
2025-10-18 17:00:55.211 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
2025-10-18 17:00:55.212 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 17:00:55.213 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 17:00:55.213 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 17:00:55.214 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 17:00:55.214 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 17:00:55.214 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 17:00:55.214 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 3ms reading results.
2025-10-18 17:00:55.215 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 17:00:55.215 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 17:00:55.215 +00:00 [INF] Все сотрудники успешно получены. Количество: 5
2025-10-18 17:00:55.242 +00:00 [INF] Успешное получение всех сотрудников. Количество: 5
2025-10-18 17:00:55.243 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 17:00:55.243 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 17:00:55.243 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 17:00:55.244 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 17:00:55.244 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 17:00:55.244 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 17:00:55.245 +00:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.ShowEmployeeDto, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 17:00:55.246 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI) in 324.4799ms
2025-10-18 17:00:55.247 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 17:00:55.247 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 17:00:55.247 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 17:00:55.248 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 17:00:55.248 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - 200 null application/json; charset=utf-8 386.5601ms
2025-10-18 18:00:56.847 +00:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-18 18:00:57.465 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:00:57.477 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:00:57.482 +00:00 [DBG] Created DbConnection. (3ms).
2025-10-18 18:00:57.495 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:57.536 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:00:57.544 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:57.548 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (1ms).
2025-10-18 18:00:57.630 +00:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-10-18 18:00:57.673 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:57.676 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:57.684 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (8ms).
2025-10-18 18:00:57.690 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 18:00:57.691 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:00:57.691 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:00:57.696 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-18 18:00:57.697 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-10-18 18:00:57.697 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:57.773 +00:00 [DBG] Hosting starting
2025-10-18 18:00:57.775 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:57.814 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 18:00:57.815 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-10-18 18:00:57.816 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-10-18 18:00:57.831 +00:00 [DBG] Repository contains no viable default key. Caller should generate a key with immediate activation.
2025-10-18 18:00:57.831 +00:00 [DBG] Policy resolution states that a new key should be added to the key ring.
2025-10-18 18:00:57.835 +00:00 [INF] Creating key {81ad7495-9911-43ce-b268-2242b90e8ff6} with creation date 2025-10-18 18:00:57Z, activation date 2025-10-18 18:00:57Z, and expiration date 2026-01-16 18:00:57Z.
2025-10-18 18:00:57.842 +00:00 [DBG] Descriptor deserializer type for key {81ad7495-9911-43ce-b268-2242b90e8ff6} is 'Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'.
2025-10-18 18:00:57.846 +00:00 [DBG] No key escrow sink found. Not writing key {81ad7495-9911-43ce-b268-2242b90e8ff6} to escrow.
2025-10-18 18:00:57.847 +00:00 [WRN] No XML encryptor configured. Key {81ad7495-9911-43ce-b268-2242b90e8ff6} may be persisted to storage in unencrypted form.
2025-10-18 18:00:57.859 +00:00 [DBG] Key cache expiration token triggered by 'CreateNewKey' operation.
2025-10-18 18:00:57.861 +00:00 [DBG] Found key {81ad7495-9911-43ce-b268-2242b90e8ff6}.
2025-10-18 18:00:57.869 +00:00 [DBG] Considering key {81ad7495-9911-43ce-b268-2242b90e8ff6} with expiration date 2026-01-16 18:00:57Z as default key.
2025-10-18 18:00:57.877 +00:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-10-18 18:00:57.879 +00:00 [DBG] Using managed symmetric algorithm 'System.Security.Cryptography.Aes'.
2025-10-18 18:00:57.880 +00:00 [DBG] Using managed keyed hash algorithm 'System.Security.Cryptography.HMACSHA256'.
2025-10-18 18:00:57.883 +00:00 [DBG] Using key {81ad7495-9911-43ce-b268-2242b90e8ff6} as the default key.
2025-10-18 18:00:57.885 +00:00 [DBG] Key ring with default key {81ad7495-9911-43ce-b268-2242b90e8ff6} was loaded during application startup.
2025-10-18 18:00:57.886 +00:00 [INF] Executed DbCommand (103ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 18:00:57.888 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:57.901 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (12ms).
2025-10-18 18:00:57.911 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:57.912 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:57.912 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:00:57.912 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:00:57.912 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:00:57.924 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 18:00:57.941 +00:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 18:00:57.961 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:57.963 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 20ms reading results.
2025-10-18 18:00:57.963 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:57.963 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:00:57.973 +00:00 [DBG] Migrating using database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:57.973 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:57.996 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:57.996 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:57.996 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:00:57.997 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 18:00:57.997 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 18:00:58.025 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (3ms).
2025-10-18 18:00:58.026 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:58.026 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:58.027 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 18:00:58.030 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 18:00:58.031 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:58.031 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:00:58.031 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:58.039 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:58.040 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:58.040 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:00:58.040 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 18:00:58.041 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 18:00:58.041 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 18:00:58.041 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:58.041 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:58.042 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 18:00:58.044 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 18:00:58.044 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:58.045 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:00:58.045 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:58.045 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:58.046 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:00:58.046 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:00:58.046 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:00:58.046 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 18:00:58.049 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 18:00:58.049 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:58.050 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 1ms reading results.
2025-10-18 18:00:58.050 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:00:58.051 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:00:58.058 +00:00 [INF] No migrations were applied. The database is already up to date.
2025-10-18 18:00:58.070 +00:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 2AE5B9E8B7B0EDFD86FD709A56EA7C92E2569E52)
2025-10-18 18:00:58.265 +00:00 [INF] Now listening on: http://[::]:8080
2025-10-18 18:00:58.265 +00:00 [INF] Now listening on: https://[::]:8081
2025-10-18 18:00:58.266 +00:00 [DBG] Loaded hosting startup assembly CarsTradeAPI
2025-10-18 18:00:58.266 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-18 18:00:58.267 +00:00 [INF] Hosting environment: Development
2025-10-18 18:00:58.267 +00:00 [INF] Content root path: /app
2025-10-18 18:00:58.267 +00:00 [DBG] Hosting started
2025-10-18 18:00:58.436 +00:00 [DBG] Connection id "0HNGEE15A1BV1" accepted.
2025-10-18 18:00:58.437 +00:00 [DBG] Connection id "0HNGEE15A1BV1" started.
2025-10-18 18:00:58.465 +00:00 [DBG] Connection 0HNGEE15A1BV1 established using the following protocol: "Tls13"
2025-10-18 18:00:58.529 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/swagger/index.html - null null
2025-10-18 18:00:58.530 +00:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-10-18 18:00:58.544 +00:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-10-18 18:00:58.545 +00:00 [DBG] Request did not match any endpoints
2025-10-18 18:00:58.685 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/swagger/index.html - 200 null text/html;charset=utf-8 155.6637ms
2025-10-18 18:00:58.764 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/swagger/v1/swagger.json - null null
2025-10-18 18:00:58.764 +00:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-10-18 18:00:58.765 +00:00 [DBG] Request did not match any endpoints
2025-10-18 18:00:58.933 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 169.0184ms
2025-10-18 18:01:44.040 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - application/json 45
2025-10-18 18:01:44.045 +00:00 [DBG] 1 candidate(s) found for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 18:01:44.048 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)' with route pattern 'api/EmployeeAuthentication/Authenticate' is valid for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 18:01:44.049 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 18:01:44.051 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:01:44.149 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 18:01:44.151 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 18:01:44.170 +00:00 [INF] Route matched with {action = "Authenticate", controller = "EmployeeAuthentication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto]] Authenticate(CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand) on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI).
2025-10-18 18:01:44.171 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:01:44.172 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:01:44.173 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:01:44.173 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:01:44.174 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:01:44.175 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 18:01:44.178 +00:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-18 18:01:44.179 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 18:01:44.194 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 18:01:44.196 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' using the name '' in request data ...
2025-10-18 18:01:44.197 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:01:44.218 +00:00 [DBG] Connection id "0HNGEE15A1BV1", Request id "0HNGEE15A1BV1:00000005": started reading request body.
2025-10-18 18:01:44.218 +00:00 [DBG] Connection id "0HNGEE15A1BV1", Request id "0HNGEE15A1BV1:00000005": done reading request body.
2025-10-18 18:01:44.226 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'
2025-10-18 18:01:44.227 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 18:01:44.228 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 18:01:44.228 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 18:01:44.233 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 18:01:44.236 +00:00 [INF] Начало обработки запроса аутентификации сотрудника
2025-10-18 18:01:44.345 +00:00 [INF] Начало обработки команды EmployeeAuthenticationCommand
2025-10-18 18:01:44.346 +00:00 [INF] Этап получения сотрудника по логину test1 в репозитории
2025-10-18 18:01:44.381 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:01:44.399 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()
    .FirstOrDefault(x => x.EmployeeLogin == __login_0)'
2025-10-18 18:01:44.521 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Employee>(
    asyncEnumerable: new SingleQueryingEnumerable<Employee>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Employee.EmployeeId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Employee.EmployeeAge (uint) Required, 1], [Property: Employee.EmployeeLogin (string) Required Index, 2], [Property: Employee.EmployeeMiddlename (string) Required, 3], [Property: Employee.EmployeeName (string) Required, 4], [Property: Employee.EmployeePassword (string) Required MaxLength(260), 5], [Property: Employee.EmployeeRole (string) Required, 6], [Property: Employee.EmployeeSellCounter (uint?), 7], [Property: Employee.EmployeeSurname (string) Required, 8] }
            SELECT TOP(1) e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
            FROM Employees AS e
            WHERE e.employee_login == @__login_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Employee>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:01:44.539 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:01:44.539 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:01:44.539 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:01:44.540 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:01:44.540 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:01:44.540 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:01:44.543 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-10-18 18:01:44.544 +00:00 [DBG] Executing DbCommand [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 18:01:44.553 +00:00 [INF] Executed DbCommand (10ms) [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 18:01:44.580 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:01:44.599 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:01:44.599 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 46ms reading results.
2025-10-18 18:01:44.599 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:01:44.600 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:01:44.600 +00:00 [INF] Сотрудник успешно получен с логином: test1
2025-10-18 18:01:44.686 +00:00 [INF] Пользователь с логином: test1 успешно аутентифицирован
2025-10-18 18:01:44.690 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:01:44.692 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:01:44.693 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:01:44.693 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:01:44.693 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:01:44.694 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:01:44.695 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto'.
2025-10-18 18:01:44.707 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI) in 530.8951ms
2025-10-18 18:01:44.707 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 18:01:44.709 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:01:44.711 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:01:44.711 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:01:44.712 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - 200 null application/json; charset=utf-8 691.9251ms
2025-10-18 18:02:04.777 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - null null
2025-10-18 18:02:04.785 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 18:02:04.786 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)' with route pattern 'api/Employee/GetAllEmployee/All' is valid for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 18:02:04.786 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 18:02:04.786 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:02:04.814 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:02:04.815 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:02:04.820 +00:00 [DBG] Authorization was successful.
2025-10-18 18:02:04.820 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 18:02:04.824 +00:00 [INF] Route matched with {action = "GetAllEmployee", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.ShowEmployeeDto]]] GetAllEmployee() on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI).
2025-10-18 18:02:04.824 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:02:04.825 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:02:04.825 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:02:04.825 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:02:04.825 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:02:04.826 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI)
2025-10-18 18:02:04.826 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI)
2025-10-18 18:02:04.827 +00:00 [INF] Начало обработки запроса GetAllEmployee
2025-10-18 18:02:04.831 +00:00 [INF] Начало обработки команды GetAllEmployeeQuery
2025-10-18 18:02:05.051 +00:00 [INF] Этап получения всех сотрудников в репозитории
2025-10-18 18:02:05.083 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:02:05.085 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()'
2025-10-18 18:02:05.088 +00:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Employee>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Employee.EmployeeId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Employee.EmployeeAge (uint) Required, 1], [Property: Employee.EmployeeLogin (string) Required Index, 2], [Property: Employee.EmployeeMiddlename (string) Required, 3], [Property: Employee.EmployeeName (string) Required, 4], [Property: Employee.EmployeePassword (string) Required MaxLength(260), 5], [Property: Employee.EmployeeRole (string) Required, 6], [Property: Employee.EmployeeSellCounter (uint?), 7], [Property: Employee.EmployeeSurname (string) Required, 8] }
        SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
        FROM Employees AS e), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Employee>, 
    CarsTradeAPI.Data.CarsTradeDbContext, 
    False, 
    False, 
    True
)'
2025-10-18 18:02:05.089 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:02:05.089 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:02:05.089 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:02:05.089 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:02:05.090 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:02:05.090 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:02:05.090 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:02:05.090 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
2025-10-18 18:02:05.113 +00:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
2025-10-18 18:02:05.115 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:02:05.116 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:02:05.116 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:02:05.117 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:02:05.117 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:02:05.117 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:02:05.117 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 3ms reading results.
2025-10-18 18:02:05.118 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:02:05.118 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:02:05.118 +00:00 [INF] Все сотрудники успешно получены. Количество: 5
2025-10-18 18:02:05.142 +00:00 [INF] Успешное получение всех сотрудников. Количество: 5
2025-10-18 18:02:05.143 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:02:05.143 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:02:05.143 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:02:05.144 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:02:05.144 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:02:05.144 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:02:05.144 +00:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.ShowEmployeeDto, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 18:02:05.146 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI) in 320.5067ms
2025-10-18 18:02:05.146 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 18:02:05.147 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:02:05.147 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:02:05.147 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:02:05.148 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - 200 null application/json; charset=utf-8 394.6766ms
2025-10-18 18:03:06.301 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - application/json 255
2025-10-18 18:03:06.328 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/CreateEmployee'
2025-10-18 18:03:06.328 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)' with route pattern 'api/Employee/CreateEmployee' is valid for the request path '/api/Employee/CreateEmployee'
2025-10-18 18:03:06.329 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)'
2025-10-18 18:03:06.329 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:03:06.335 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:03:06.335 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:03:06.338 +00:00 [DBG] Authorization was successful.
2025-10-18 18:03:06.338 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)'
2025-10-18 18:03:06.341 +00:00 [INF] Route matched with {action = "CreateEmployee", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.ShowEmployeeDto]] CreateEmployee(CarsTradeAPI.Features.EmployeeOperation.CreateEmployee.CreateEmployeeCommand) on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI).
2025-10-18 18:03:06.342 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:03:06.342 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:03:06.342 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:03:06.343 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:03:06.343 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:03:06.343 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI)
2025-10-18 18:03:06.344 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI)
2025-10-18 18:03:06.345 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateEmployee.CreateEmployeeCommand' ...
2025-10-18 18:03:06.345 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateEmployee.CreateEmployeeCommand' using the name '' in request data ...
2025-10-18 18:03:06.346 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:03:06.347 +00:00 [DBG] Connection id "0HNGEE15A1BV1", Request id "0HNGEE15A1BV1:00000009": started reading request body.
2025-10-18 18:03:06.347 +00:00 [DBG] Connection id "0HNGEE15A1BV1", Request id "0HNGEE15A1BV1:00000009": done reading request body.
2025-10-18 18:03:06.350 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.EmployeeOperation.CreateEmployee.CreateEmployeeCommand'
2025-10-18 18:03:06.351 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateEmployee.CreateEmployeeCommand'.
2025-10-18 18:03:06.351 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateEmployee.CreateEmployeeCommand'.
2025-10-18 18:03:06.351 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateEmployee.CreateEmployeeCommand' ...
2025-10-18 18:03:06.354 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.CreateEmployee.CreateEmployeeCommand'.
2025-10-18 18:03:06.355 +00:00 [INF] Начало обработки запроса CreateEmployee
2025-10-18 18:03:06.368 +00:00 [INF] Начало обработки команды CreateEmployeeCommand
2025-10-18 18:03:06.369 +00:00 [INF] Checking IdempotencyRequest for key: 2345234ewrwer
2025-10-18 18:03:06.370 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:03:06.374 +00:00 [DBG] Compiling query expression: 
'DbSet<IdempotencyRequest>()
    .AsNoTracking()
    .FirstOrDefault(r => r.Key == __key_0)'
2025-10-18 18:03:06.378 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<IdempotencyRequest>(
    asyncEnumerable: new SingleQueryingEnumerable<IdempotencyRequest>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: IdempotencyRequest.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: IdempotencyRequest.CreatedAt (DateTime) Required, 1], [Property: IdempotencyRequest.Key (string) Required MaxLength(100), 2], [Property: IdempotencyRequest.ResourceId (Guid?), 3], [Property: IdempotencyRequest.ResourceType (string) Required MaxLength(50), 4], [Property: IdempotencyRequest.Responsejson (string), 5], [Property: IdempotencyRequest.Status (string) Required MaxLength(50), 6] }
            SELECT TOP(1) i.Id, i.CreatedAt, i.Key, i.ResourceId, i.ResourceType, i.Responsejson, i.Status
            FROM IdempotencyRequests AS i
            WHERE i.Key == @__key_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, IdempotencyRequest>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:03:06.379 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:03:06.379 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:03:06.380 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.380 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.380 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:03:06.380 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:03:06.381 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:03:06.381 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:03:06.404 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:03:06.438 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.439 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 13ms reading results.
2025-10-18 18:03:06.439 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.439 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:03:06.441 +00:00 [INF] IdempotencyRequest found: false
2025-10-18 18:03:06.445 +00:00 [INF] Этап проверки уникальности логина testuser1 в репозитории
2025-10-18 18:03:06.446 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()
    .Any(x => x.EmployeeLogin == __employeeLogin_0)'
2025-10-18 18:03:06.453 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Employees AS e
                WHERE e.employee_login == @__employeeLogin_0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:03:06.456 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.457 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.457 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:03:06.457 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:03:06.457 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:03:06.458 +00:00 [DBG] Executing DbCommand [Parameters=[@__employeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_login = @__employeeLogin_0)
2025-10-18 18:03:06.460 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__employeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_login = @__employeeLogin_0)
2025-10-18 18:03:06.465 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.465 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 4ms reading results.
2025-10-18 18:03:06.465 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.465 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:03:06.466 +00:00 [INF] Проверка уникальности логина testuser1 завершена. Результат: false
2025-10-18 18:03:06.518 +00:00 [INF] Этап создания работника с ID "7bd84fc5-4710-485f-a05a-9d40a97aaa25" в репозитории
2025-10-18 18:03:06.518 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()
    .FirstOrDefault(x => x.EmployeeLogin == __employee_EmployeeLogin_0)'
2025-10-18 18:03:06.521 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Employee>(
    asyncEnumerable: new SingleQueryingEnumerable<Employee>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Employee.EmployeeId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Employee.EmployeeAge (uint) Required, 1], [Property: Employee.EmployeeLogin (string) Required Index, 2], [Property: Employee.EmployeeMiddlename (string) Required, 3], [Property: Employee.EmployeeName (string) Required, 4], [Property: Employee.EmployeePassword (string) Required MaxLength(260), 5], [Property: Employee.EmployeeRole (string) Required, 6], [Property: Employee.EmployeeSellCounter (uint?), 7], [Property: Employee.EmployeeSurname (string) Required, 8] }
            SELECT TOP(1) e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
            FROM Employees AS e
            WHERE e.employee_login == @__employee_EmployeeLogin_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Employee>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:03:06.522 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.522 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.522 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:03:06.522 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:03:06.523 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:03:06.523 +00:00 [DBG] Executing DbCommand [Parameters=[@__employee_EmployeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__employee_EmployeeLogin_0
LIMIT 1
2025-10-18 18:03:06.525 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__employee_EmployeeLogin_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__employee_EmployeeLogin_0
LIMIT 1
2025-10-18 18:03:06.526 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.526 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:03:06.526 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.527 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:03:06.542 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:03:06.545 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:03:06.547 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:03:06.556 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 18:03:06.593 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.593 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.595 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:03:06.595 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:03:06.596 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-10-18 18:03:06.597 +00:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int64), @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?' (DbType = Int64), @p8='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Employees" (employee_id, employee_age, employee_login, employee_middlename, employee_name, employee_password, employee_role, employee_sellcounter, employee_surname)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-10-18 18:03:06.603 +00:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int64), @p2='?', @p3='?', @p4='?', @p5='?', @p6='?', @p7='?' (DbType = Int64), @p8='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Employees" (employee_id, employee_age, employee_login, employee_middlename, employee_name, employee_password, employee_role, employee_sellcounter, employee_surname)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-10-18 18:03:06.606 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.606 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 3ms reading results.
2025-10-18 18:03:06.607 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.607 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:03:06.613 +00:00 [DBG] An entity of type 'Employee' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:03:06.614 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 18:03:06.614 +00:00 [INF] Работник успешно создан с ID: "7bd84fc5-4710-485f-a05a-9d40a97aaa25"
2025-10-18 18:03:06.617 +00:00 [DBG] Compiling query expression: 
'DbSet<IdempotencyRequest>()
    .Any(r => r.Key == __key_0)'
2025-10-18 18:03:06.618 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM IdempotencyRequests AS i
                WHERE i.Key == @__key_0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:03:06.619 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.619 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.619 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:03:06.620 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:03:06.620 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:03:06.620 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 18:03:06.623 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 18:03:06.624 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.624 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:03:06.624 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.625 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:03:06.637 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'IdempotencyRequest' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:03:06.637 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:03:06.638 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:03:06.644 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 18:03:06.645 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.646 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.646 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:03:06.646 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:03:06.646 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:03:06.647 +00:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 18:03:06.673 +00:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 18:03:06.674 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.674 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:03:06.675 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.675 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:03:06.676 +00:00 [DBG] An entity of type 'IdempotencyRequest' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:03:06.676 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 18:03:06.676 +00:00 [INF] IdempotencyRequest saved for key: 2345234ewrwer
2025-10-18 18:03:06.680 +00:00 [INF] Пользователь успешно создан с ID: "7bd84fc5-4710-485f-a05a-9d40a97aaa25"
2025-10-18 18:03:06.680 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:03:06.680 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:03:06.680 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:03:06.681 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:03:06.681 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:03:06.681 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:03:06.681 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.ShowEmployeeDto'.
2025-10-18 18:03:06.682 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI) in 338.391ms
2025-10-18 18:03:06.682 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)'
2025-10-18 18:03:06.682 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:03:06.683 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:06.683 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:03:06.683 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - 200 null application/json; charset=utf-8 402.8741ms
2025-10-18 18:03:26.671 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - application/json 53
2025-10-18 18:03:26.692 +00:00 [DBG] 1 candidate(s) found for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 18:03:26.692 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)' with route pattern 'api/EmployeeAuthentication/Authenticate' is valid for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 18:03:26.693 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 18:03:26.693 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:03:26.694 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:03:26.694 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:03:26.695 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 18:03:26.695 +00:00 [INF] Route matched with {action = "Authenticate", controller = "EmployeeAuthentication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto]] Authenticate(CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand) on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI).
2025-10-18 18:03:26.695 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:03:26.696 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:03:26.696 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:03:26.696 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:03:26.696 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:03:26.697 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 18:03:26.697 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 18:03:26.697 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 18:03:26.697 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' using the name '' in request data ...
2025-10-18 18:03:26.698 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:03:26.698 +00:00 [DBG] Connection id "0HNGEE15A1BV1", Request id "0HNGEE15A1BV1:0000000B": started reading request body.
2025-10-18 18:03:26.698 +00:00 [DBG] Connection id "0HNGEE15A1BV1", Request id "0HNGEE15A1BV1:0000000B": done reading request body.
2025-10-18 18:03:26.698 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'
2025-10-18 18:03:26.699 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 18:03:26.699 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 18:03:26.699 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 18:03:26.700 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 18:03:26.700 +00:00 [INF] Начало обработки запроса аутентификации сотрудника
2025-10-18 18:03:26.702 +00:00 [INF] Начало обработки команды EmployeeAuthenticationCommand
2025-10-18 18:03:26.702 +00:00 [INF] Этап получения сотрудника по логину testuser1 в репозитории
2025-10-18 18:03:26.703 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:03:26.706 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:03:26.706 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:03:26.706 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:26.707 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:26.707 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:03:26.707 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:03:26.708 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:03:26.708 +00:00 [DBG] Executing DbCommand [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 18:03:26.711 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 18:03:26.713 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:03:26.714 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:26.714 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 2ms reading results.
2025-10-18 18:03:26.715 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:26.715 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:03:26.716 +00:00 [INF] Сотрудник успешно получен с логином: testuser1
2025-10-18 18:03:26.772 +00:00 [INF] Пользователь с логином: testuser1 успешно аутентифицирован
2025-10-18 18:03:26.773 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:03:26.773 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:03:26.774 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:03:26.774 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:03:26.774 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:03:26.775 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:03:26.775 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto'.
2025-10-18 18:03:26.775 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI) in 78.7528ms
2025-10-18 18:03:26.776 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 18:03:26.776 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:03:26.776 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:03:26.776 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:03:26.777 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - 200 null application/json; charset=utf-8 105.8899ms
2025-10-18 18:03:52.074 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - null null
2025-10-18 18:03:52.122 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 18:03:52.128 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)' with route pattern 'api/Employee/GetAllEmployee/All' is valid for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 18:03:52.128 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 18:03:52.129 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:03:52.130 +00:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14121: JWT is not a well formed JWE, there must be four dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(ReadOnlyMemory`1 encodedTokenMemory)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
2025-10-18 18:03:52.166 +00:00 [INF] Bearer was not authenticated. Failure message: IDX14121: JWT is not a well formed JWE, there must be four dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-10-18 18:03:52.167 +00:00 [DBG] Policy authentication schemes  did not succeed
2025-10-18 18:03:52.168 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 18:03:52.172 +00:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-10-18 18:03:52.172 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - 401 0 null 98.1229ms
2025-10-18 18:04:07.970 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - application/json 255
2025-10-18 18:04:07.991 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/CreateEmployee'
2025-10-18 18:04:07.992 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)' with route pattern 'api/Employee/CreateEmployee' is valid for the request path '/api/Employee/CreateEmployee'
2025-10-18 18:04:07.992 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)'
2025-10-18 18:04:07.992 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:04:07.993 +00:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14121: JWT is not a well formed JWE, there must be four dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(ReadOnlyMemory`1 encodedTokenMemory)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
2025-10-18 18:04:07.993 +00:00 [INF] Bearer was not authenticated. Failure message: IDX14121: JWT is not a well formed JWE, there must be four dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-10-18 18:04:07.993 +00:00 [DBG] Policy authentication schemes  did not succeed
2025-10-18 18:04:07.994 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 18:04:07.994 +00:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-10-18 18:04:07.995 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - 401 0 null 24.1601ms
2025-10-18 18:04:07.995 +00:00 [DBG] Connection id "0HNGEE15A1BV1", Request id "0HNGEE15A1BV1:0000000F": started reading request body.
2025-10-18 18:04:07.995 +00:00 [DBG] Connection id "0HNGEE15A1BV1", Request id "0HNGEE15A1BV1:0000000F": done reading request body.
2025-10-18 18:04:56.808 +00:00 [DBG] Connection id "0HNGEE15A1BV1" received FIN.
2025-10-18 18:04:56.841 +00:00 [DBG] Connection id "0HNGEE15A1BV1" is closed. The last processed stream ID was 15.
2025-10-18 18:04:56.842 +00:00 [DBG] Connection id "0HNGEE15A1BV1" sending FIN because: "The Socket transport's send loop completed gracefully."
2025-10-18 18:04:56.842 +00:00 [DBG] The connection queue processing loop for 0HNGEE15A1BV1 completed.
2025-10-18 18:04:56.845 +00:00 [DBG] Connection id "0HNGEE15A1BV1" stopped.
2025-10-18 18:05:40.655 +00:00 [DBG] Connection id "0HNGEE15A1BV2" accepted.
2025-10-18 18:05:40.670 +00:00 [DBG] Connection id "0HNGEE15A1BV2" started.
2025-10-18 18:05:40.674 +00:00 [DBG] Connection 0HNGEE15A1BV2 established using the following protocol: "Tls13"
2025-10-18 18:05:40.698 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/CarModel/CreateCarModel - application/json 432
2025-10-18 18:05:40.719 +00:00 [DBG] 1 candidate(s) found for the request path '/api/CarModel/CreateCarModel'
2025-10-18 18:05:40.740 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.CarModelOperation.CarModelController.CreateCarModel (CarsTradeAPI)' with route pattern 'api/CarModel/CreateCarModel' is valid for the request path '/api/CarModel/CreateCarModel'
2025-10-18 18:05:40.759 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.CarModelOperation.CarModelController.CreateCarModel (CarsTradeAPI)'
2025-10-18 18:05:40.765 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:05:40.766 +00:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14121: JWT is not a well formed JWE, there must be four dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(ReadOnlyMemory`1 encodedTokenMemory)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
2025-10-18 18:05:40.767 +00:00 [INF] Bearer was not authenticated. Failure message: IDX14121: JWT is not a well formed JWE, there must be four dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-10-18 18:05:40.767 +00:00 [DBG] Policy authentication schemes  did not succeed
2025-10-18 18:05:40.768 +00:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-10-18 18:05:40.769 +00:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-10-18 18:05:40.769 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/CarModel/CreateCarModel - 401 0 null 71.6387ms
2025-10-18 18:05:40.769 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:00000001": started reading request body.
2025-10-18 18:05:40.770 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:00000001": done reading request body.
2025-10-18 18:05:57.904 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - application/json 53
2025-10-18 18:05:57.904 +00:00 [DBG] 1 candidate(s) found for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 18:05:57.904 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)' with route pattern 'api/EmployeeAuthentication/Authenticate' is valid for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 18:05:57.905 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 18:05:57.905 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:05:57.905 +00:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14121: JWT is not a well formed JWE, there must be four dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(ReadOnlyMemory`1 encodedTokenMemory)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
2025-10-18 18:05:57.906 +00:00 [INF] Bearer was not authenticated. Failure message: IDX14121: JWT is not a well formed JWE, there must be four dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EncodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-10-18 18:05:57.906 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 18:05:57.906 +00:00 [INF] Route matched with {action = "Authenticate", controller = "EmployeeAuthentication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto]] Authenticate(CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand) on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI).
2025-10-18 18:05:57.906 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:05:57.907 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:05:57.910 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:05:57.911 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:05:57.911 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:05:57.912 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 18:05:57.912 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 18:05:57.912 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 18:05:57.913 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' using the name '' in request data ...
2025-10-18 18:05:57.913 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:05:57.914 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:00000003": started reading request body.
2025-10-18 18:05:57.914 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:00000003": done reading request body.
2025-10-18 18:05:57.914 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'
2025-10-18 18:05:57.914 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 18:05:57.914 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 18:05:57.915 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 18:05:57.915 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 18:05:57.915 +00:00 [INF] Начало обработки запроса аутентификации сотрудника
2025-10-18 18:05:57.921 +00:00 [INF] Начало обработки команды EmployeeAuthenticationCommand
2025-10-18 18:05:57.922 +00:00 [INF] Этап получения сотрудника по логину testuser1 в репозитории
2025-10-18 18:05:57.923 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:05:57.925 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:05:57.925 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:05:57.925 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:05:57.979 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:05:57.979 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:05:57.979 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:05:57.980 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:05:57.980 +00:00 [DBG] Executing DbCommand [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 18:05:57.982 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 18:05:57.982 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:05:57.982 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:05:57.983 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:05:57.983 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:05:57.983 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:05:57.984 +00:00 [INF] Сотрудник успешно получен с логином: testuser1
2025-10-18 18:05:58.036 +00:00 [INF] Пользователь с логином: testuser1 успешно аутентифицирован
2025-10-18 18:05:58.036 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:05:58.037 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:05:58.037 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:05:58.037 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:05:58.037 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:05:58.038 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:05:58.038 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto'.
2025-10-18 18:05:58.038 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI) in 126.8603ms
2025-10-18 18:05:58.039 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 18:05:58.039 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:05:58.039 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:05:58.039 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:05:58.040 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - 200 null application/json; charset=utf-8 136.1527ms
2025-10-18 18:06:19.800 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/CarModel/CreateCarModel - application/json 432
2025-10-18 18:06:19.834 +00:00 [DBG] 1 candidate(s) found for the request path '/api/CarModel/CreateCarModel'
2025-10-18 18:06:19.835 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.CarModelOperation.CarModelController.CreateCarModel (CarsTradeAPI)' with route pattern 'api/CarModel/CreateCarModel' is valid for the request path '/api/CarModel/CreateCarModel'
2025-10-18 18:06:19.835 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.CarModelOperation.CarModelController.CreateCarModel (CarsTradeAPI)'
2025-10-18 18:06:19.836 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:06:19.836 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:06:19.837 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:06:19.837 +00:00 [DBG] Authorization was successful.
2025-10-18 18:06:19.837 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.CarModelOperation.CarModelController.CreateCarModel (CarsTradeAPI)'
2025-10-18 18:06:19.840 +00:00 [INF] Route matched with {action = "CreateCarModel", controller = "CarModel"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.CarModelOperation.CarModelDto.ShowCarModelDto]] CreateCarModel(CarsTradeAPI.Features.CarModelOperation.CreateCarModel.CreateCarModelCommand) on controller CarsTradeAPI.Features.CarModelOperation.CarModelController (CarsTradeAPI).
2025-10-18 18:06:19.840 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:06:19.840 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:06:19.840 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:06:19.841 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:06:19.841 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:06:19.841 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.CarModelOperation.CarModelController (CarsTradeAPI)
2025-10-18 18:06:19.842 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.CarModelOperation.CarModelController (CarsTradeAPI)
2025-10-18 18:06:19.842 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.CarModelOperation.CreateCarModel.CreateCarModelCommand' ...
2025-10-18 18:06:19.842 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.CarModelOperation.CreateCarModel.CreateCarModelCommand' using the name '' in request data ...
2025-10-18 18:06:19.843 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:06:19.848 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:00000005": started reading request body.
2025-10-18 18:06:19.849 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:00000005": done reading request body.
2025-10-18 18:06:19.859 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.CarModelOperation.CreateCarModel.CreateCarModelCommand'
2025-10-18 18:06:19.859 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.CarModelOperation.CreateCarModel.CreateCarModelCommand'.
2025-10-18 18:06:19.859 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.CarModelOperation.CreateCarModel.CreateCarModelCommand'.
2025-10-18 18:06:19.860 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.CarModelOperation.CreateCarModel.CreateCarModelCommand' ...
2025-10-18 18:06:19.864 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.CarModelOperation.CreateCarModel.CreateCarModelCommand'.
2025-10-18 18:06:19.865 +00:00 [INF] Начало обработки запроса CreateCarModel
2025-10-18 18:06:19.878 +00:00 [INF] Начало обработки команды CreateCarModelCommand
2025-10-18 18:06:19.879 +00:00 [INF] Checking IdempotencyRequest for key: dfgsdfgsdfgsdg23
2025-10-18 18:06:19.879 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:06:19.880 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:06:19.880 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:06:19.880 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:06:19.881 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:06:19.881 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:06:19.881 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:06:19.881 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:06:19.882 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:06:19.890 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:06:19.918 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:06:19.919 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 7ms reading results.
2025-10-18 18:06:19.920 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:06:19.921 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:06:19.942 +00:00 [INF] IdempotencyRequest found: false
2025-10-18 18:06:19.966 +00:00 [INF] Этап создания CarModel в репозитории
2025-10-18 18:06:19.973 +00:00 [DBG] 'CarsTradeDbContext' generated a value for the property 'CarModel.CarModelId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:06:19.988 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'CarModel' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:06:19.988 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:06:19.988 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:06:19.994 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 18:06:19.995 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:06:19.995 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:06:19.996 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:06:19.996 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:06:19.996 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:06:19.997 +00:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?', @p2='?' (DbType = Object), @p3='?', @p4='?' (DbType = Object), @p5='?', @p6='?', @p7='?' (DbType = Decimal), @p8='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "CarModels" (car_id, car_color, car_configuration, car_country, car_engine, car_manufacturer, car_model, car_price, "car_productionDateTime")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-10-18 18:06:20.012 +00:00 [INF] Executed DbCommand (16ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?', @p2='?' (DbType = Object), @p3='?', @p4='?' (DbType = Object), @p5='?', @p6='?', @p7='?' (DbType = Decimal), @p8='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "CarModels" (car_id, car_color, car_configuration, car_country, car_engine, car_manufacturer, car_model, car_price, "car_productionDateTime")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-10-18 18:06:20.013 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:06:20.013 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:06:20.013 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:06:20.014 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:06:20.015 +00:00 [DBG] An entity of type 'CarModel' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:06:20.016 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 18:06:20.016 +00:00 [INF] Модель машины успешно создана с ID: "39bbb487-392f-44fe-8b65-ea145763347b"
2025-10-18 18:06:20.016 +00:00 [INF] Объект CarModel успешно создан с ID: "39bbb487-392f-44fe-8b65-ea145763347b"
2025-10-18 18:06:20.021 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:06:20.022 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:06:20.022 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:06:20.022 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:06:20.022 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:06:20.023 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 18:06:20.025 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 18:06:20.026 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:06:20.026 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:06:20.027 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:06:20.027 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:06:20.027 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'IdempotencyRequest' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:06:20.027 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:06:20.028 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:06:20.028 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 18:06:20.028 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:06:20.029 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:06:20.029 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:06:20.029 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:06:20.029 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:06:20.029 +00:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 18:06:20.032 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 18:06:20.033 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:06:20.033 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:06:20.034 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:06:20.034 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:06:20.034 +00:00 [DBG] An entity of type 'IdempotencyRequest' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:06:20.034 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 18:06:20.035 +00:00 [INF] IdempotencyRequest saved for key: dfgsdfgsdfgsdg23
2025-10-18 18:06:20.036 +00:00 [INF] Объект CarModel успешно преобразован в ShowCarModelDto с ID: "39bbb487-392f-44fe-8b65-ea145763347b"
2025-10-18 18:06:20.036 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:06:20.037 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:06:20.037 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:06:20.037 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:06:20.037 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:06:20.037 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:06:20.038 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.CarModelOperation.CarModelDto.ShowCarModelDto'.
2025-10-18 18:06:20.039 +00:00 [INF] Executed action CarsTradeAPI.Features.CarModelOperation.CarModelController.CreateCarModel (CarsTradeAPI) in 197.7971ms
2025-10-18 18:06:20.039 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.CarModelOperation.CarModelController.CreateCarModel (CarsTradeAPI)'
2025-10-18 18:06:20.039 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:06:20.040 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:06:20.040 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:06:20.040 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/CarModel/CreateCarModel - 200 null application/json; charset=utf-8 240.4428ms
2025-10-18 18:07:17.930 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/CarInventory/CreateCarInventory - application/json 108
2025-10-18 18:07:17.959 +00:00 [DBG] 1 candidate(s) found for the request path '/api/CarInventory/CreateCarInventory'
2025-10-18 18:07:17.983 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.CarInventoryOperation.CarInventoryController.CreateCarInventory (CarsTradeAPI)' with route pattern 'api/CarInventory/CreateCarInventory' is valid for the request path '/api/CarInventory/CreateCarInventory'
2025-10-18 18:07:17.983 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.CarInventoryOperation.CarInventoryController.CreateCarInventory (CarsTradeAPI)'
2025-10-18 18:07:17.984 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:07:17.984 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:07:17.985 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:07:17.985 +00:00 [DBG] Authorization was successful.
2025-10-18 18:07:17.986 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.CarInventoryOperation.CarInventoryController.CreateCarInventory (CarsTradeAPI)'
2025-10-18 18:07:17.989 +00:00 [INF] Route matched with {action = "CreateCarInventory", controller = "CarInventory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.CarInventoryOperation.CarInventoryDto.ShowCarInventoryDto]] CreateCarInventory(CarsTradeAPI.Features.CarInventoryOperation.CreateCarInventory.CreateCarInventoryCommand) on controller CarsTradeAPI.Features.CarInventoryOperation.CarInventoryController (CarsTradeAPI).
2025-10-18 18:07:17.989 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:07:17.989 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:07:17.989 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:07:17.990 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:07:17.990 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:07:17.990 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.CarInventoryOperation.CarInventoryController (CarsTradeAPI)
2025-10-18 18:07:17.991 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.CarInventoryOperation.CarInventoryController (CarsTradeAPI)
2025-10-18 18:07:17.991 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.CarInventoryOperation.CreateCarInventory.CreateCarInventoryCommand' ...
2025-10-18 18:07:17.991 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.CarInventoryOperation.CreateCarInventory.CreateCarInventoryCommand' using the name '' in request data ...
2025-10-18 18:07:17.992 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:07:17.993 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:00000007": started reading request body.
2025-10-18 18:07:17.993 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:00000007": done reading request body.
2025-10-18 18:07:17.995 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.CarInventoryOperation.CreateCarInventory.CreateCarInventoryCommand'
2025-10-18 18:07:17.995 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.CarInventoryOperation.CreateCarInventory.CreateCarInventoryCommand'.
2025-10-18 18:07:17.995 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.CarInventoryOperation.CreateCarInventory.CreateCarInventoryCommand'.
2025-10-18 18:07:17.995 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.CarInventoryOperation.CreateCarInventory.CreateCarInventoryCommand' ...
2025-10-18 18:07:17.997 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.CarInventoryOperation.CreateCarInventory.CreateCarInventoryCommand'.
2025-10-18 18:07:17.998 +00:00 [INF] Получен запрос на создание нового CarInventory
2025-10-18 18:07:18.008 +00:00 [INF] Начало обработки команды CreateCarInventoryCommand
2025-10-18 18:07:18.008 +00:00 [INF] Checking IdempotencyRequest for key: SwinSuasd
2025-10-18 18:07:18.009 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:07:18.010 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:07:18.010 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:07:18.010 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.011 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.011 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:07:18.011 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:07:18.011 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:07:18.011 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:07:18.015 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:07:18.016 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.017 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:07:18.038 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.039 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (1ms).
2025-10-18 18:07:18.040 +00:00 [INF] IdempotencyRequest found: false
2025-10-18 18:07:18.041 +00:00 [INF] Этап получения CarModel с ID: "39bbb487-392f-44fe-8b65-ea145763347b" в репозитории
2025-10-18 18:07:18.043 +00:00 [DBG] Compiling query expression: 
'DbSet<CarModel>()
    .FirstOrDefault(id => id.CarModelId == __CarModelId_0)'
2025-10-18 18:07:18.046 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CarModel>(
    asyncEnumerable: new SingleQueryingEnumerable<CarModel>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CarModel.CarModelId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CarModel.CarColor (string) Required, 1], [Property: CarModel.CarConfiguration (CarConfiguration) Required, 2], [Property: CarModel.CarCountry (string) Required, 3], [Property: CarModel.CarEngine (Engine), 4], [Property: CarModel.CarManufacturer (string) Required Index, 5], [Property: CarModel.CarModelName (string) Required Index, 6], [Property: CarModel.CarPrice (decimal) Required, 7], [Property: CarModel.ProductionDateTime (DateTime) Required, 8] }
            SELECT TOP(1) c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c.car_productionDateTime
            FROM CarModels AS c
            WHERE c.car_id == @__CarModelId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CarModel>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:07:18.047 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.047 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.047 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:07:18.048 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:07:18.048 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:07:18.048 +00:00 [DBG] Executing DbCommand [Parameters=[@__CarModelId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c."car_productionDateTime"
FROM "CarModels" AS c
WHERE c.car_id = @__CarModelId_0
LIMIT 1
2025-10-18 18:07:18.071 +00:00 [INF] Executed DbCommand (23ms) [Parameters=[@__CarModelId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c."car_productionDateTime"
FROM "CarModels" AS c
WHERE c.car_id = @__CarModelId_0
LIMIT 1
2025-10-18 18:07:18.081 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'CarModel' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:07:18.081 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.081 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 9ms reading results.
2025-10-18 18:07:18.082 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.082 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:07:18.082 +00:00 [INF] Модель машины с ID: "39bbb487-392f-44fe-8b65-ea145763347b" успешно получена
2025-10-18 18:07:18.085 +00:00 [INF] Этап создания CarInventory с ID: "eefe6d2c-0e1b-470e-8443-cf96b5884a07" в репозитории
2025-10-18 18:07:18.086 +00:00 [DBG] Compiling query expression: 
'DbSet<CarInventory>()
    .FirstOrDefault(c => c.InventoryId == __inventory_InventoryId_0)'
2025-10-18 18:07:18.089 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CarInventory>(
    asyncEnumerable: new SingleQueryingEnumerable<CarInventory>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CarInventory.InventoryId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CarInventory.CarModelId (Guid) Required FK Index, 1], [Property: CarInventory.LastUpdated (DateTime) Required, 2], [Property: CarInventory.Quantity (uint) Required, 3] }
            SELECT TOP(1) c.inventory_id, c.car_model_id, c.last_updated, c.quantity
            FROM CarInventories AS c
            WHERE c.inventory_id == @__inventory_InventoryId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CarInventory>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:07:18.089 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.090 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.090 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:07:18.090 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:07:18.090 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:07:18.090 +00:00 [DBG] Executing DbCommand [Parameters=[@__inventory_InventoryId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT c.inventory_id, c.car_model_id, c.last_updated, c.quantity
FROM "CarInventories" AS c
WHERE c.inventory_id = @__inventory_InventoryId_0
LIMIT 1
2025-10-18 18:07:18.093 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__inventory_InventoryId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT c.inventory_id, c.car_model_id, c.last_updated, c.quantity
FROM "CarInventories" AS c
WHERE c.inventory_id = @__inventory_InventoryId_0
LIMIT 1
2025-10-18 18:07:18.114 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.115 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 21ms reading results.
2025-10-18 18:07:18.115 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.115 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:07:18.124 +00:00 [DBG] The navigation 'CarInventory.CarModel' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:07:18.130 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'CarInventory' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:07:18.131 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:07:18.131 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:07:18.133 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 18:07:18.134 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.135 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.135 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:07:18.135 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:07:18.135 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:07:18.136 +00:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime), @p3='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "CarInventories" (inventory_id, car_model_id, last_updated, quantity)
VALUES (@p0, @p1, @p2, @p3);
2025-10-18 18:07:18.148 +00:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = DateTime), @p3='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "CarInventories" (inventory_id, car_model_id, last_updated, quantity)
VALUES (@p0, @p1, @p2, @p3);
2025-10-18 18:07:18.149 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.149 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:07:18.149 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.149 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:07:18.150 +00:00 [DBG] An entity of type 'CarInventory' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:07:18.150 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 18:07:18.150 +00:00 [INF] Объект CarInventory успешно создан с ID: "eefe6d2c-0e1b-470e-8443-cf96b5884a07"
2025-10-18 18:07:18.150 +00:00 [INF] Объект CarInventory успешно создан с ID: "eefe6d2c-0e1b-470e-8443-cf96b5884a07"
2025-10-18 18:07:18.155 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.155 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.155 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:07:18.155 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:07:18.156 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:07:18.156 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 18:07:18.159 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 18:07:18.180 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.181 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 21ms reading results.
2025-10-18 18:07:18.181 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.181 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:07:18.182 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'IdempotencyRequest' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:07:18.182 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:07:18.182 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:07:18.182 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 18:07:18.183 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.183 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.183 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:07:18.183 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:07:18.184 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:07:18.184 +00:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 18:07:18.207 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 18:07:18.207 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.208 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:07:18.209 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.209 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:07:18.209 +00:00 [DBG] An entity of type 'IdempotencyRequest' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:07:18.209 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 18:07:18.210 +00:00 [INF] IdempotencyRequest saved for key: SwinSuasd
2025-10-18 18:07:18.210 +00:00 [INF] Объект CarInventory с ID: "eefe6d2c-0e1b-470e-8443-cf96b5884a07" успешно создан
2025-10-18 18:07:18.211 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:07:18.211 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:07:18.211 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:07:18.211 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:07:18.212 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:07:18.212 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:07:18.212 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.CarInventoryOperation.CarInventoryDto.ShowCarInventoryDto'.
2025-10-18 18:07:18.213 +00:00 [INF] Executed action CarsTradeAPI.Features.CarInventoryOperation.CarInventoryController.CreateCarInventory (CarsTradeAPI) in 222.7028ms
2025-10-18 18:07:18.213 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.CarInventoryOperation.CarInventoryController.CreateCarInventory (CarsTradeAPI)'
2025-10-18 18:07:18.213 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:07:18.214 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:07:18.214 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:07:18.214 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/CarInventory/CreateCarInventory - 200 null application/json; charset=utf-8 284.5164ms
2025-10-18 18:08:44.852 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/Buyer/GetAllBuyers - null null
2025-10-18 18:08:44.906 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Buyer/GetAllBuyers'
2025-10-18 18:08:44.913 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.BuyerOperation.BuyerController.GetAllBuyers (CarsTradeAPI)' with route pattern 'api/Buyer/GetAllBuyers' is valid for the request path '/api/Buyer/GetAllBuyers'
2025-10-18 18:08:44.920 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.BuyerOperation.BuyerController.GetAllBuyers (CarsTradeAPI)'
2025-10-18 18:08:44.920 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:08:44.921 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:08:44.921 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:08:44.921 +00:00 [DBG] Authorization was successful.
2025-10-18 18:08:44.922 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.BuyerOperation.BuyerController.GetAllBuyers (CarsTradeAPI)'
2025-10-18 18:08:44.924 +00:00 [INF] Route matched with {action = "GetAllBuyers", controller = "Buyer"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[CarsTradeAPI.Features.BuyerOperation.BuyerDto.ShowBuyerDto]]] GetAllBuyers() on controller CarsTradeAPI.Features.BuyerOperation.BuyerController (CarsTradeAPI).
2025-10-18 18:08:44.924 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:08:44.924 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:08:44.925 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:08:44.925 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:08:44.925 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:08:44.925 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.BuyerOperation.BuyerController (CarsTradeAPI)
2025-10-18 18:08:44.926 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.BuyerOperation.BuyerController (CarsTradeAPI)
2025-10-18 18:08:44.927 +00:00 [INF] Получен запрос на получение всех покупателей
2025-10-18 18:08:44.929 +00:00 [INF] Начало обработки запроса GetBuyersQuery
2025-10-18 18:08:44.935 +00:00 [INF] Этап получения всех покупателей в репозитории
2025-10-18 18:08:44.935 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:08:44.936 +00:00 [DBG] Compiling query expression: 
'DbSet<Buyer>()'
2025-10-18 18:08:44.940 +00:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Buyer>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Buyer.BuyerId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Buyer.BuyerAddress (string) Required, 1], [Property: Buyer.BuyerEmail (string) Required, 2], [Property: Buyer.BuyerMiddlename (string) Required, 3], [Property: Buyer.BuyerName (string) Required, 4], [Property: Buyer.BuyerSurname (string) Required, 5], [Property: Buyer.CreatedAt (DateTime) Required, 6], [Property: Buyer.PhoneNumber (string) Required, 7] }
        SELECT b.buyer_id, b.buyer_adress, b.buyer_email, b.buyer_middlename, b.buyer_name, b.buyer_surname, b.buyer_created_date, b.phone_number
        FROM Buyers AS b), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Buyer>, 
    CarsTradeAPI.Data.CarsTradeDbContext, 
    False, 
    False, 
    True
)'
2025-10-18 18:08:44.940 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:08:44.941 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:08:44.941 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:08:44.941 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:08:44.941 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:08:44.941 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:08:44.942 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:08:44.942 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT b.buyer_id, b.buyer_adress, b.buyer_email, b.buyer_middlename, b.buyer_name, b.buyer_surname, b.buyer_created_date, b.phone_number
FROM "Buyers" AS b
2025-10-18 18:08:44.965 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT b.buyer_id, b.buyer_adress, b.buyer_email, b.buyer_middlename, b.buyer_name, b.buyer_surname, b.buyer_created_date, b.phone_number
FROM "Buyers" AS b
2025-10-18 18:08:45.003 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Buyer' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:08:45.010 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:08:45.010 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 37ms reading results.
2025-10-18 18:08:45.011 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:08:45.011 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:08:45.011 +00:00 [INF] Все покупатели успешно получены. Количество: 1
2025-10-18 18:08:45.011 +00:00 [INF] Успешное получение 1 покупателей
2025-10-18 18:08:45.018 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:08:45.019 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:08:45.019 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:08:45.019 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:08:45.019 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:08:45.019 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:08:45.020 +00:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Features.BuyerOperation.BuyerDto.ShowBuyerDto, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 18:08:45.021 +00:00 [INF] Executed action CarsTradeAPI.Features.BuyerOperation.BuyerController.GetAllBuyers (CarsTradeAPI) in 95.0666ms
2025-10-18 18:08:45.021 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.BuyerOperation.BuyerController.GetAllBuyers (CarsTradeAPI)'
2025-10-18 18:08:45.021 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:08:45.021 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:08:45.022 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:08:45.022 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/Buyer/GetAllBuyers - 200 null application/json; charset=utf-8 170.4146ms
2025-10-18 18:09:26.139 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - application/json 255
2025-10-18 18:09:26.140 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/CreateEmployee'
2025-10-18 18:09:26.155 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)' with route pattern 'api/Employee/CreateEmployee' is valid for the request path '/api/Employee/CreateEmployee'
2025-10-18 18:09:26.155 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.CreateEmployee (CarsTradeAPI)'
2025-10-18 18:09:26.155 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:09:26.156 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:09:26.156 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:09:26.156 +00:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-18 18:09:26.158 +00:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-10-18 18:09:26.158 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Employee/CreateEmployee - 403 0 null 18.9356ms
2025-10-18 18:09:26.158 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:0000000B": started reading request body.
2025-10-18 18:09:26.158 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:0000000B": done reading request body.
2025-10-18 18:10:05.092 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/Orders/GetAllOrders/All - null null
2025-10-18 18:10:05.120 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Orders/GetAllOrders/All'
2025-10-18 18:10:05.127 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.GetAllOrders (CarsTradeAPI)' with route pattern 'api/Orders/GetAllOrders/All' is valid for the request path '/api/Orders/GetAllOrders/All'
2025-10-18 18:10:05.127 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.GetAllOrders (CarsTradeAPI)'
2025-10-18 18:10:05.127 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:10:05.128 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:10:05.129 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:10:05.129 +00:00 [DBG] Authorization was successful.
2025-10-18 18:10:05.129 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.GetAllOrders (CarsTradeAPI)'
2025-10-18 18:10:05.132 +00:00 [INF] Route matched with {action = "GetAllOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto]]] GetAllOrders() on controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI).
2025-10-18 18:10:05.133 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:10:05.133 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:10:05.133 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:10:05.133 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:10:05.133 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:10:05.134 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:10:05.134 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:10:05.135 +00:00 [INF] Получение запроса на выдачу всех заказов
2025-10-18 18:10:05.138 +00:00 [INF] Начало обработки команды GetAllOrdersQuery
2025-10-18 18:10:05.143 +00:00 [INF] Этап получения всех заказов в репозитории
2025-10-18 18:10:05.145 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:10:05.146 +00:00 [DBG] Compiling query expression: 
'DbSet<Order>()
    .Include(o => o.OrderItems)
    .ThenInclude(oi => oi.CarModel)'
2025-10-18 18:10:05.153 +00:00 [DBG] Including navigation: 'Order.OrderItems'.
2025-10-18 18:10:05.158 +00:00 [DBG] Including navigation: 'OrderItem.CarModel'.
2025-10-18 18:10:05.203 +00:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Order>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Order.OrderId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Order.BuyerId (Guid) Required FK Index, 1], [Property: Order.EmployeeId (Guid) Required FK Index, 2], [Property: Order.OrderAddress (OrderAddress) Required, 3], [Property: Order.OrderCompletionDate (DateTime?), 4], [Property: Order.OrderCreateDate (DateTime) Required, 5], [Property: Order.OrderPrice (decimal) Required, 6] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: OrderItem.OrderItemId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: OrderItem.CarModelId (Guid) Required FK Index, 8], [Property: OrderItem.OrderId (Guid) Required FK Index, 9], [Property: OrderItem.OrderItemComments (string), 10], [Property: OrderItem.OrderQuantity (long) Required, 11], [Property: OrderItem.UnitPrice (decimal) Required, 12] }
            3 -> Dictionary<IProperty, int> { [Property: CarModel.CarModelId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: CarModel.CarColor (string) Required, 14], [Property: CarModel.CarConfiguration (CarConfiguration) Required, 15], [Property: CarModel.CarCountry (string) Required, 16], [Property: CarModel.CarEngine (Engine), 17], [Property: CarModel.CarManufacturer (string) Required Index, 18], [Property: CarModel.CarModelName (string) Required Index, 19], [Property: CarModel.CarPrice (decimal) Required, 20], [Property: CarModel.ProductionDateTime (DateTime) Required, 21] }
            4 -> 7
            5 -> 13
        SELECT o.order_id, o.BuyerId, o.EmployeeId, o.order_delivery_address, o.order_completion_date, o.order_create_date, o.order_price, t.orderitem_id, t.CarModelId, t.OrderId, t.comments, t.order_quantity, t.unit_price, t.car_id, t.car_color, t.car_configuration, t.car_country, t.car_engine, t.car_manufacturer, t.car_model, t.car_price, t.car_productionDateTime
        FROM Orders AS o
        LEFT JOIN 
        (
            SELECT o0.orderitem_id, o0.CarModelId, o0.OrderId, o0.comments, o0.order_quantity, o0.unit_price, c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c.car_productionDateTime
            FROM OrderItems AS o0
            INNER JOIN CarModels AS c ON o0.CarModelId == c.car_id
        ) AS t ON o.order_id == t.OrderId
        ORDER BY o.order_id ASC, t.orderitem_id ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Order>, 
    CarsTradeAPI.Data.CarsTradeDbContext, 
    False, 
    False, 
    True
)'
2025-10-18 18:10:05.206 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:10:05.206 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:10:05.206 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:10:05.206 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:10:05.206 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:10:05.207 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:10:05.207 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:10:05.207 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o.order_id, o."BuyerId", o."EmployeeId", o.order_delivery_address, o.order_completion_date, o.order_create_date, o.order_price, t.orderitem_id, t."CarModelId", t."OrderId", t.comments, t.order_quantity, t.unit_price, t.car_id, t.car_color, t.car_configuration, t.car_country, t.car_engine, t.car_manufacturer, t.car_model, t.car_price, t."car_productionDateTime"
FROM "Orders" AS o
LEFT JOIN (
    SELECT o0.orderitem_id, o0."CarModelId", o0."OrderId", o0.comments, o0.order_quantity, o0.unit_price, c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c."car_productionDateTime"
    FROM "OrderItems" AS o0
    INNER JOIN "CarModels" AS c ON o0."CarModelId" = c.car_id
) AS t ON o.order_id = t."OrderId"
ORDER BY o.order_id, t.orderitem_id
2025-10-18 18:10:05.213 +00:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o.order_id, o."BuyerId", o."EmployeeId", o.order_delivery_address, o.order_completion_date, o.order_create_date, o.order_price, t.orderitem_id, t."CarModelId", t."OrderId", t.comments, t.order_quantity, t.unit_price, t.car_id, t.car_color, t.car_configuration, t.car_country, t.car_engine, t.car_manufacturer, t.car_model, t.car_price, t."car_productionDateTime"
FROM "Orders" AS o
LEFT JOIN (
    SELECT o0.orderitem_id, o0."CarModelId", o0."OrderId", o0.comments, o0.order_quantity, o0.unit_price, c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c."car_productionDateTime"
    FROM "OrderItems" AS o0
    INNER JOIN "CarModels" AS c ON o0."CarModelId" = c.car_id
) AS t ON o.order_id = t."OrderId"
ORDER BY o.order_id, t.orderitem_id
2025-10-18 18:10:05.221 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Order' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:10:05.233 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'OrderItem' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:10:05.240 +00:00 [DBG] The navigation 'OrderItem.CarModel' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:10:05.240 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'CarModel' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:10:05.241 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:10:05.241 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 27ms reading results.
2025-10-18 18:10:05.241 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:10:05.242 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:10:05.242 +00:00 [INF] Все заказы успешно получены, количество: 1
2025-10-18 18:10:05.254 +00:00 [INF] Успешное получение 1 заказов
2025-10-18 18:10:05.254 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:10:05.255 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:10:05.255 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:10:05.255 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:10:05.255 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:10:05.256 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:10:05.256 +00:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 18:10:05.257 +00:00 [INF] Executed action CarsTradeAPI.Features.OrdersOperation.OrdersController.GetAllOrders (CarsTradeAPI) in 123.5132ms
2025-10-18 18:10:05.257 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.GetAllOrders (CarsTradeAPI)'
2025-10-18 18:10:05.258 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:10:05.258 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:10:05.258 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:10:05.258 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/Orders/GetAllOrders/All - 200 null application/json; charset=utf-8 166.6045ms
2025-10-18 18:10:37.979 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Orders/CreateOrder - application/json 484
2025-10-18 18:10:38.006 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Orders/CreateOrder'
2025-10-18 18:10:38.013 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)' with route pattern 'api/Orders/CreateOrder' is valid for the request path '/api/Orders/CreateOrder'
2025-10-18 18:10:38.013 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:10:38.014 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:10:38.014 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:10:38.014 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:10:38.015 +00:00 [DBG] Authorization was successful.
2025-10-18 18:10:38.015 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:10:38.017 +00:00 [INF] Route matched with {action = "CreateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto]] CreateOrder(CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand) on controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI).
2025-10-18 18:10:38.017 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:10:38.018 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:10:38.018 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:10:38.018 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:10:38.018 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:10:38.018 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:10:38.019 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:10:38.019 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' ...
2025-10-18 18:10:38.019 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' using the name '' in request data ...
2025-10-18 18:10:38.019 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:10:38.022 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:0000000F": started reading request body.
2025-10-18 18:10:38.022 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:0000000F": done reading request body.
2025-10-18 18:10:38.025 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'
2025-10-18 18:10:38.026 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:10:38.026 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:10:38.026 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' ...
2025-10-18 18:10:38.031 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:10:38.032 +00:00 [INF] Получен запрос на создание нового заказа
2025-10-18 18:10:38.049 +00:00 [INF] Начало обработки команды CreateOrderCommand для ключа dfgdsffhgs34324
2025-10-18 18:10:38.049 +00:00 [INF] Checking IdempotencyRequest for key: dfgdsffhgs34324
2025-10-18 18:10:38.049 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:10:38.050 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:10:38.050 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:10:38.050 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:10:38.051 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:10:38.051 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:10:38.051 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:10:38.051 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:10:38.051 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:10:38.054 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:10:38.075 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:10:38.075 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 21ms reading results.
2025-10-18 18:10:38.077 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:10:38.077 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (1ms).
2025-10-18 18:10:38.078 +00:00 [INF] IdempotencyRequest found: false
2025-10-18 18:10:38.082 +00:00 [INF] Этап проверки существования покупателя с ID "51991a83-f3de-474f-b55e-a133f6564ad9" в репозитории
2025-10-18 18:10:38.082 +00:00 [DBG] Compiling query expression: 
'DbSet<Buyer>()
    .Any(o => o.BuyerId == __buyerId_0)'
2025-10-18 18:10:38.084 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Buyers AS b
                WHERE b.buyer_id == @__buyerId_0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:10:38.084 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:10:38.084 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:10:38.085 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:10:38.085 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:10:38.085 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:10:38.085 +00:00 [DBG] Executing DbCommand [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:10:38.088 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:10:38.089 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:10:38.089 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:10:38.089 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:10:38.089 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:10:38.090 +00:00 [INF] Проверка существования прошла успешно, результат false
2025-10-18 18:10:38.090 +00:00 [WRN] Покупатель с ID "51991a83-f3de-474f-b55e-a133f6564ad9" не найден
2025-10-18 18:10:38.091 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:10:38.091 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:10:38.091 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:10:38.092 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:10:38.092 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:10:38.092 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:10:38.092 +00:00 [INF] Executing NotFoundObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Infrastructure.ValidationBehavior.ErrorDetail, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 18:10:38.100 +00:00 [INF] Executed action CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI) in 81.4361ms
2025-10-18 18:10:38.100 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:10:38.100 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:10:38.101 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:10:38.101 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:10:38.101 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Orders/CreateOrder - 404 null application/json; charset=utf-8 122.0856ms
2025-10-18 18:10:58.601 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/Buyer/GetAllBuyers - null null
2025-10-18 18:10:58.626 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Buyer/GetAllBuyers'
2025-10-18 18:10:58.628 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.BuyerOperation.BuyerController.GetAllBuyers (CarsTradeAPI)' with route pattern 'api/Buyer/GetAllBuyers' is valid for the request path '/api/Buyer/GetAllBuyers'
2025-10-18 18:10:58.628 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.BuyerOperation.BuyerController.GetAllBuyers (CarsTradeAPI)'
2025-10-18 18:10:58.628 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:10:58.629 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:10:58.630 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:10:58.630 +00:00 [DBG] Authorization was successful.
2025-10-18 18:10:58.631 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.BuyerOperation.BuyerController.GetAllBuyers (CarsTradeAPI)'
2025-10-18 18:10:58.631 +00:00 [INF] Route matched with {action = "GetAllBuyers", controller = "Buyer"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[CarsTradeAPI.Features.BuyerOperation.BuyerDto.ShowBuyerDto]]] GetAllBuyers() on controller CarsTradeAPI.Features.BuyerOperation.BuyerController (CarsTradeAPI).
2025-10-18 18:10:58.631 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:10:58.632 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:10:58.632 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:10:58.632 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:10:58.632 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:10:58.633 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.BuyerOperation.BuyerController (CarsTradeAPI)
2025-10-18 18:10:58.634 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.BuyerOperation.BuyerController (CarsTradeAPI)
2025-10-18 18:10:58.634 +00:00 [INF] Получен запрос на получение всех покупателей
2025-10-18 18:10:58.635 +00:00 [INF] Начало обработки запроса GetBuyersQuery
2025-10-18 18:10:58.676 +00:00 [INF] Получение всех покупателей в количестве 1
2025-10-18 18:10:58.676 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:10:58.677 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:10:58.677 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:10:58.677 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:10:58.678 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:10:58.678 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:10:58.678 +00:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Features.BuyerOperation.BuyerDto.ShowBuyerDto, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 18:10:58.679 +00:00 [INF] Executed action CarsTradeAPI.Features.BuyerOperation.BuyerController.GetAllBuyers (CarsTradeAPI) in 45.1441ms
2025-10-18 18:10:58.679 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.BuyerOperation.BuyerController.GetAllBuyers (CarsTradeAPI)'
2025-10-18 18:10:58.679 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/Buyer/GetAllBuyers - 200 null application/json; charset=utf-8 78.312ms
2025-10-18 18:11:11.696 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Orders/CreateOrder - application/json 484
2025-10-18 18:11:11.717 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Orders/CreateOrder'
2025-10-18 18:11:11.717 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)' with route pattern 'api/Orders/CreateOrder' is valid for the request path '/api/Orders/CreateOrder'
2025-10-18 18:11:11.718 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:11:11.718 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:11:11.718 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:11:11.719 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:11:11.719 +00:00 [DBG] Authorization was successful.
2025-10-18 18:11:11.719 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:11:11.719 +00:00 [INF] Route matched with {action = "CreateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto]] CreateOrder(CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand) on controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI).
2025-10-18 18:11:11.720 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:11:11.720 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:11:11.720 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:11:11.720 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:11:11.720 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:11:11.721 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:11:11.721 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:11:11.721 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' ...
2025-10-18 18:11:11.722 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' using the name '' in request data ...
2025-10-18 18:11:11.722 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:11:11.722 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:00000013": started reading request body.
2025-10-18 18:11:11.722 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:00000013": done reading request body.
2025-10-18 18:11:11.723 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'
2025-10-18 18:11:11.723 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:11:11.723 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:11:11.723 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' ...
2025-10-18 18:11:11.724 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:11:11.724 +00:00 [INF] Получен запрос на создание нового заказа
2025-10-18 18:11:11.726 +00:00 [INF] Начало обработки команды CreateOrderCommand для ключа dfgdsffhgs34324
2025-10-18 18:11:11.726 +00:00 [INF] Checking IdempotencyRequest for key: dfgdsffhgs34324
2025-10-18 18:11:11.727 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:11:11.728 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:11:11.728 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:11:11.728 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:11.821 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:11.822 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:11:11.822 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:11:11.822 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:11:11.822 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:11:11.825 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:11:11.825 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:11.825 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:11:11.826 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:11.826 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:11:11.826 +00:00 [INF] IdempotencyRequest found: false
2025-10-18 18:11:11.826 +00:00 [INF] Этап проверки существования покупателя с ID "fff39040-5257-421f-8e13-f2af3fd91055" в репозитории
2025-10-18 18:11:11.827 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:11.827 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:11.827 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:11:11.828 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:11:11.828 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:11:11.828 +00:00 [DBG] Executing DbCommand [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:11:11.830 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:11:11.831 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:11.832 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 1ms reading results.
2025-10-18 18:11:11.832 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:11.832 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:11:11.832 +00:00 [INF] Проверка существования прошла успешно, результат true
2025-10-18 18:11:11.833 +00:00 [INF] Этап проверки существования работника с ID "3fa85f64-5717-4562-b3fc-2c963f66afa6" в репозитории
2025-10-18 18:11:11.834 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()
    .Any(o => o.EmployeeId == __employeeId_0)'
2025-10-18 18:11:11.836 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Employees AS e
                WHERE e.employee_id == @__employeeId_0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:11:11.836 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:11.836 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:11.837 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:11:11.837 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:11:11.837 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:11:11.837 +00:00 [DBG] Executing DbCommand [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_id = @__employeeId_0)
2025-10-18 18:11:11.840 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_id = @__employeeId_0)
2025-10-18 18:11:11.841 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:11.841 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:11:11.841 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:11.841 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:11:11.842 +00:00 [INF] Проверка существования прошла успешно, результат false
2025-10-18 18:11:11.842 +00:00 [WRN] Сотрудник с ID "3fa85f64-5717-4562-b3fc-2c963f66afa6" не найден
2025-10-18 18:11:11.842 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:11:11.843 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:11:11.843 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:11:11.843 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:11:11.843 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:11:11.843 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:11:11.843 +00:00 [INF] Executing NotFoundObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Infrastructure.ValidationBehavior.ErrorDetail, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 18:11:11.844 +00:00 [INF] Executed action CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI) in 123.0556ms
2025-10-18 18:11:11.844 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:11:11.844 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:11:11.845 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:11.845 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:11:11.845 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Orders/CreateOrder - 404 null application/json; charset=utf-8 149.0516ms
2025-10-18 18:11:40.573 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Orders/CreateOrder - application/json 484
2025-10-18 18:11:40.594 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Orders/CreateOrder'
2025-10-18 18:11:40.607 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)' with route pattern 'api/Orders/CreateOrder' is valid for the request path '/api/Orders/CreateOrder'
2025-10-18 18:11:40.608 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:11:40.611 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:11:40.612 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:11:40.612 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:11:40.613 +00:00 [DBG] Authorization was successful.
2025-10-18 18:11:40.613 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:11:40.613 +00:00 [INF] Route matched with {action = "CreateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto]] CreateOrder(CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand) on controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI).
2025-10-18 18:11:40.613 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:11:40.613 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:11:40.614 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:11:40.614 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:11:40.614 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:11:40.614 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:11:40.614 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:11:40.615 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' ...
2025-10-18 18:11:40.615 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' using the name '' in request data ...
2025-10-18 18:11:40.615 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:11:40.615 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:00000015": started reading request body.
2025-10-18 18:11:40.616 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:00000015": done reading request body.
2025-10-18 18:11:40.616 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'
2025-10-18 18:11:40.616 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:11:40.616 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:11:40.617 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' ...
2025-10-18 18:11:40.617 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:11:40.617 +00:00 [INF] Получен запрос на создание нового заказа
2025-10-18 18:11:40.620 +00:00 [INF] Начало обработки команды CreateOrderCommand для ключа dfgdsffhgs34324
2025-10-18 18:11:40.620 +00:00 [INF] Checking IdempotencyRequest for key: dfgdsffhgs34324
2025-10-18 18:11:40.620 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:11:40.621 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:11:40.621 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:11:40.621 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:40.621 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:40.622 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:11:40.622 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:11:40.622 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:11:40.622 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:11:40.625 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:11:40.638 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:40.639 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 7ms reading results.
2025-10-18 18:11:40.639 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:40.640 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:11:40.640 +00:00 [INF] IdempotencyRequest found: false
2025-10-18 18:11:40.641 +00:00 [INF] Этап проверки существования покупателя с ID "fff39040-5257-421f-8e13-f2af3fd91055" в репозитории
2025-10-18 18:11:40.642 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:40.643 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:40.643 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:11:40.643 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:11:40.644 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:11:40.644 +00:00 [DBG] Executing DbCommand [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:11:40.667 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:11:40.668 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:40.669 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:11:40.669 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:40.669 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:11:40.669 +00:00 [INF] Проверка существования прошла успешно, результат true
2025-10-18 18:11:40.670 +00:00 [INF] Этап проверки существования работника с ID "3fa85f64-5717-4562-b3fc-2c963f66afa6" в репозитории
2025-10-18 18:11:40.670 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:40.670 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:40.671 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:11:40.671 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:11:40.671 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:11:40.671 +00:00 [DBG] Executing DbCommand [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_id = @__employeeId_0)
2025-10-18 18:11:40.674 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_id = @__employeeId_0)
2025-10-18 18:11:40.675 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:40.675 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:11:40.675 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:40.676 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:11:40.676 +00:00 [INF] Проверка существования прошла успешно, результат false
2025-10-18 18:11:40.676 +00:00 [WRN] Сотрудник с ID "3fa85f64-5717-4562-b3fc-2c963f66afa6" не найден
2025-10-18 18:11:40.676 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:11:40.677 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:11:40.677 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:11:40.677 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:11:40.677 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:11:40.677 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:11:40.678 +00:00 [INF] Executing NotFoundObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Infrastructure.ValidationBehavior.ErrorDetail, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 18:11:40.678 +00:00 [INF] Executed action CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI) in 63.8454ms
2025-10-18 18:11:40.678 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:11:40.679 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:11:40.679 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:11:40.679 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:11:40.679 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Orders/CreateOrder - 404 null application/json; charset=utf-8 106.4849ms
2025-10-18 18:14:46.615 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Orders/CreateOrder - application/json 484
2025-10-18 18:14:46.643 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Orders/CreateOrder'
2025-10-18 18:14:46.652 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)' with route pattern 'api/Orders/CreateOrder' is valid for the request path '/api/Orders/CreateOrder'
2025-10-18 18:14:46.652 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:14:46.653 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:14:46.653 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:14:46.654 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:14:46.654 +00:00 [DBG] Authorization was successful.
2025-10-18 18:14:46.654 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:14:46.654 +00:00 [INF] Route matched with {action = "CreateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto]] CreateOrder(CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand) on controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI).
2025-10-18 18:14:46.655 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:14:46.655 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:14:46.655 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:14:46.655 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:14:46.655 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:14:46.656 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:14:46.656 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:14:46.656 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' ...
2025-10-18 18:14:46.656 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' using the name '' in request data ...
2025-10-18 18:14:46.657 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:14:46.657 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:00000017": started reading request body.
2025-10-18 18:14:46.657 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:00000017": done reading request body.
2025-10-18 18:14:46.658 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'
2025-10-18 18:14:46.658 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:14:46.658 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:14:46.658 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' ...
2025-10-18 18:14:46.659 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:14:46.659 +00:00 [INF] Получен запрос на создание нового заказа
2025-10-18 18:14:46.659 +00:00 [INF] Начало обработки команды CreateOrderCommand для ключа dfgdsffhgs34324
2025-10-18 18:14:46.660 +00:00 [INF] Checking IdempotencyRequest for key: dfgdsffhgs34324
2025-10-18 18:14:46.661 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:14:46.661 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:14:46.661 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:14:46.662 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:14:46.662 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:14:46.662 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:14:46.663 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:14:46.663 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:14:46.663 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:14:46.666 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:14:46.667 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:14:46.667 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:14:46.668 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:14:46.668 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:14:46.669 +00:00 [INF] IdempotencyRequest found: false
2025-10-18 18:14:46.690 +00:00 [INF] Этап проверки существования покупателя с ID "fff39040-5257-421f-8e13-f2af3fd91055" в репозитории
2025-10-18 18:14:46.712 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:14:46.713 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:14:46.713 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:14:46.713 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:14:46.713 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:14:46.714 +00:00 [DBG] Executing DbCommand [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:14:46.737 +00:00 [INF] Executed DbCommand (23ms) [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:14:46.778 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:14:46.779 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 21ms reading results.
2025-10-18 18:14:46.779 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:14:46.779 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:14:46.779 +00:00 [INF] Проверка существования прошла успешно, результат true
2025-10-18 18:14:46.780 +00:00 [INF] Этап проверки существования работника с ID "ea3c1119-310b-452c-92f6-cee77f6ce1fc" в репозитории
2025-10-18 18:14:46.780 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:14:46.780 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:14:46.781 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:14:46.781 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:14:46.781 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:14:46.781 +00:00 [DBG] Executing DbCommand [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_id = @__employeeId_0)
2025-10-18 18:14:46.784 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_id = @__employeeId_0)
2025-10-18 18:14:46.785 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:14:46.785 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:14:46.786 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:14:46.786 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:14:46.786 +00:00 [INF] Проверка существования прошла успешно, результат false
2025-10-18 18:14:46.786 +00:00 [WRN] Сотрудник с ID "ea3c1119-310b-452c-92f6-cee77f6ce1fc" не найден
2025-10-18 18:14:46.787 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:14:46.787 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:14:46.787 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:14:46.787 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:14:46.787 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:14:46.788 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:14:46.788 +00:00 [INF] Executing NotFoundObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Infrastructure.ValidationBehavior.ErrorDetail, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 18:14:46.788 +00:00 [INF] Executed action CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI) in 132.6672ms
2025-10-18 18:14:46.788 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:14:46.789 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:14:46.789 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:14:46.790 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:14:46.790 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Orders/CreateOrder - 404 null application/json; charset=utf-8 174.8121ms
2025-10-18 18:15:37.457 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Orders/CreateOrder - application/json 484
2025-10-18 18:15:37.464 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Orders/CreateOrder'
2025-10-18 18:15:37.464 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)' with route pattern 'api/Orders/CreateOrder' is valid for the request path '/api/Orders/CreateOrder'
2025-10-18 18:15:37.464 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:15:37.464 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:15:37.465 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:15:37.465 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:15:37.466 +00:00 [DBG] Authorization was successful.
2025-10-18 18:15:37.466 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:15:37.466 +00:00 [INF] Route matched with {action = "CreateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto]] CreateOrder(CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand) on controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI).
2025-10-18 18:15:37.467 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:15:37.467 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:15:37.467 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:15:37.467 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:15:37.467 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:15:37.468 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:15:37.468 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:15:37.468 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' ...
2025-10-18 18:15:37.468 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' using the name '' in request data ...
2025-10-18 18:15:37.469 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:15:37.469 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:00000019": started reading request body.
2025-10-18 18:15:37.469 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:00000019": done reading request body.
2025-10-18 18:15:37.470 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'
2025-10-18 18:15:37.470 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:15:37.470 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:15:37.470 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' ...
2025-10-18 18:15:37.471 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:15:37.471 +00:00 [INF] Получен запрос на создание нового заказа
2025-10-18 18:15:37.471 +00:00 [INF] Начало обработки команды CreateOrderCommand для ключа dfgdsffhgs34324
2025-10-18 18:15:37.472 +00:00 [INF] Checking IdempotencyRequest for key: dfgdsffhgs34324
2025-10-18 18:15:37.472 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:15:37.473 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:15:37.473 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:15:37.473 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:15:37.473 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:15:37.473 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:15:37.474 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:15:37.474 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:15:37.474 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:15:37.481 +00:00 [INF] Executed DbCommand (7ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:15:37.512 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:15:37.521 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 33ms reading results.
2025-10-18 18:15:37.522 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:15:37.522 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:15:37.522 +00:00 [INF] IdempotencyRequest found: false
2025-10-18 18:15:37.522 +00:00 [INF] Этап проверки существования покупателя с ID "fff39040-5257-421f-8e13-f2af3fd91055" в репозитории
2025-10-18 18:15:37.523 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:15:37.524 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:15:37.524 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:15:37.524 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:15:37.525 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:15:37.525 +00:00 [DBG] Executing DbCommand [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:15:37.528 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:15:37.528 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:15:37.529 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:15:37.529 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:15:37.529 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:15:37.529 +00:00 [INF] Проверка существования прошла успешно, результат true
2025-10-18 18:15:37.530 +00:00 [INF] Этап проверки существования работника с ID "ea3c1119-310b-452c-92f6-cee77f6ce1fc" в репозитории
2025-10-18 18:15:37.530 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:15:37.530 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:15:37.531 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:15:37.531 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:15:37.531 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:15:37.531 +00:00 [DBG] Executing DbCommand [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_id = @__employeeId_0)
2025-10-18 18:15:37.534 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_id = @__employeeId_0)
2025-10-18 18:15:37.535 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:15:37.535 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:15:37.535 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:15:37.535 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:15:37.536 +00:00 [INF] Проверка существования прошла успешно, результат false
2025-10-18 18:15:37.536 +00:00 [WRN] Сотрудник с ID "ea3c1119-310b-452c-92f6-cee77f6ce1fc" не найден
2025-10-18 18:15:37.536 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:15:37.536 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:15:37.537 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:15:37.537 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:15:37.537 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:15:37.537 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:15:37.537 +00:00 [INF] Executing NotFoundObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Infrastructure.ValidationBehavior.ErrorDetail, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 18:15:37.538 +00:00 [INF] Executed action CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI) in 70.3434ms
2025-10-18 18:15:37.538 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:15:37.538 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:15:37.539 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:15:37.539 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:15:37.539 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Orders/CreateOrder - 404 null application/json; charset=utf-8 81.8782ms
2025-10-18 18:18:24.512 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Orders/CreateOrder - application/json 484
2025-10-18 18:18:24.513 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Orders/CreateOrder'
2025-10-18 18:18:24.513 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)' with route pattern 'api/Orders/CreateOrder' is valid for the request path '/api/Orders/CreateOrder'
2025-10-18 18:18:24.513 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:18:24.513 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:18:24.514 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:18:24.514 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:18:24.515 +00:00 [DBG] Authorization was successful.
2025-10-18 18:18:24.515 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:18:24.515 +00:00 [INF] Route matched with {action = "CreateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto]] CreateOrder(CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand) on controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI).
2025-10-18 18:18:24.516 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:18:24.516 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:18:24.516 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:18:24.516 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:18:24.516 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:18:24.517 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:18:24.517 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:18:24.517 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' ...
2025-10-18 18:18:24.518 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' using the name '' in request data ...
2025-10-18 18:18:24.518 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:18:24.518 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:0000001B": started reading request body.
2025-10-18 18:18:24.518 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:0000001B": done reading request body.
2025-10-18 18:18:24.519 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'
2025-10-18 18:18:24.519 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:18:24.519 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:18:24.519 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' ...
2025-10-18 18:18:24.520 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:18:24.520 +00:00 [INF] Получен запрос на создание нового заказа
2025-10-18 18:18:24.521 +00:00 [INF] Начало обработки команды CreateOrderCommand для ключа dfgdsffhgs34324
2025-10-18 18:18:24.522 +00:00 [INF] Checking IdempotencyRequest for key: dfgdsffhgs34324
2025-10-18 18:18:24.523 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:18:24.523 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:18:24.524 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:18:24.524 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:24.535 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:24.536 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:18:24.536 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:18:24.536 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:18:24.536 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:18:24.539 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:18:24.539 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:24.540 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:18:24.540 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:24.540 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:18:24.540 +00:00 [INF] IdempotencyRequest found: false
2025-10-18 18:18:24.541 +00:00 [INF] Этап проверки существования покупателя с ID "fff39040-5257-421f-8e13-f2af3fd91055" в репозитории
2025-10-18 18:18:24.541 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:24.541 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:24.541 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:18:24.542 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:18:24.542 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:18:24.542 +00:00 [DBG] Executing DbCommand [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:18:24.545 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:18:24.566 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:24.567 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 20ms reading results.
2025-10-18 18:18:24.567 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:24.567 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:18:24.567 +00:00 [INF] Проверка существования прошла успешно, результат true
2025-10-18 18:18:24.568 +00:00 [INF] Этап проверки существования работника с ID "ea3c1119-310b-452c-92f6-cee77f6ce1fc" в репозитории
2025-10-18 18:18:24.568 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:24.568 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:24.568 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:18:24.569 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:18:24.569 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:18:24.569 +00:00 [DBG] Executing DbCommand [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_id = @__employeeId_0)
2025-10-18 18:18:24.592 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_id = @__employeeId_0)
2025-10-18 18:18:24.593 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:24.593 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:18:24.594 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:24.594 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:18:24.594 +00:00 [INF] Проверка существования прошла успешно, результат false
2025-10-18 18:18:24.595 +00:00 [WRN] Сотрудник с ID "ea3c1119-310b-452c-92f6-cee77f6ce1fc" не найден
2025-10-18 18:18:24.595 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:18:24.595 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:18:24.595 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:18:24.596 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:18:24.596 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:18:24.596 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:18:24.596 +00:00 [INF] Executing NotFoundObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Infrastructure.ValidationBehavior.ErrorDetail, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 18:18:24.597 +00:00 [INF] Executed action CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI) in 79.8495ms
2025-10-18 18:18:24.597 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:18:24.597 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:18:24.597 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:24.598 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:18:24.598 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Orders/CreateOrder - 404 null application/json; charset=utf-8 85.9476ms
2025-10-18 18:18:38.095 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Orders/CreateOrder - application/json 484
2025-10-18 18:18:38.117 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Orders/CreateOrder'
2025-10-18 18:18:38.117 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)' with route pattern 'api/Orders/CreateOrder' is valid for the request path '/api/Orders/CreateOrder'
2025-10-18 18:18:38.117 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:18:38.118 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:18:38.118 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:18:38.118 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:18:38.119 +00:00 [DBG] Authorization was successful.
2025-10-18 18:18:38.119 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:18:38.122 +00:00 [INF] Route matched with {action = "CreateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto]] CreateOrder(CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand) on controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI).
2025-10-18 18:18:38.122 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:18:38.122 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:18:38.122 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:18:38.123 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:18:38.123 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:18:38.123 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:18:38.123 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:18:38.124 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' ...
2025-10-18 18:18:38.124 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' using the name '' in request data ...
2025-10-18 18:18:38.124 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:18:38.126 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:0000001D": started reading request body.
2025-10-18 18:18:38.126 +00:00 [DBG] Connection id "0HNGEE15A1BV2", Request id "0HNGEE15A1BV2:0000001D": done reading request body.
2025-10-18 18:18:38.128 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'
2025-10-18 18:18:38.128 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:18:38.128 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:18:38.128 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' ...
2025-10-18 18:18:38.130 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:18:38.130 +00:00 [INF] Получен запрос на создание нового заказа
2025-10-18 18:18:38.133 +00:00 [INF] Начало обработки команды CreateOrderCommand для ключа dfgdsffhgs34324
2025-10-18 18:18:38.133 +00:00 [INF] Checking IdempotencyRequest for key: dfgdsffhgs34324
2025-10-18 18:18:38.134 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:18:38.134 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:18:38.135 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:18:38.135 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:38.135 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:38.135 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:18:38.136 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:18:38.136 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:18:38.136 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:18:38.138 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:18:38.139 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:38.140 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:18:38.140 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:38.140 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:18:38.141 +00:00 [INF] IdempotencyRequest found: false
2025-10-18 18:18:38.141 +00:00 [INF] Этап проверки существования покупателя с ID "fff39040-5257-421f-8e13-f2af3fd91055" в репозитории
2025-10-18 18:18:38.143 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:38.143 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:38.144 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:18:38.144 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:18:38.144 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:18:38.145 +00:00 [DBG] Executing DbCommand [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:18:38.147 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:18:38.148 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:38.148 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:18:38.148 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:38.148 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:18:38.149 +00:00 [INF] Проверка существования прошла успешно, результат true
2025-10-18 18:18:38.149 +00:00 [INF] Этап проверки существования работника с ID "ea3c1119-310b-452c-92f6-cee77f6ce1fc" в репозитории
2025-10-18 18:18:38.149 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:38.149 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:38.150 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:18:38.150 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:18:38.150 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:18:38.150 +00:00 [DBG] Executing DbCommand [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_id = @__employeeId_0)
2025-10-18 18:18:38.152 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_id = @__employeeId_0)
2025-10-18 18:18:38.154 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:38.154 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:18:38.154 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:38.154 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:18:38.155 +00:00 [INF] Проверка существования прошла успешно, результат false
2025-10-18 18:18:38.155 +00:00 [WRN] Сотрудник с ID "ea3c1119-310b-452c-92f6-cee77f6ce1fc" не найден
2025-10-18 18:18:38.155 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:18:38.155 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:18:38.156 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:18:38.156 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:18:38.156 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:18:38.156 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:18:38.156 +00:00 [INF] Executing NotFoundObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Infrastructure.ValidationBehavior.ErrorDetail, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 18:18:38.157 +00:00 [INF] Executed action CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI) in 34.2599ms
2025-10-18 18:18:38.158 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:18:38.158 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:18:38.158 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:18:38.158 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:18:38.158 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Orders/CreateOrder - 404 null application/json; charset=utf-8 63.2679ms
2025-10-18 18:21:42.482 +00:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2025-10-18 18:21:43.041 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:21:43.050 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:21:43.053 +00:00 [DBG] Created DbConnection. (2ms).
2025-10-18 18:21:43.062 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.098 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:21:43.100 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.103 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:21:43.170 +00:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2025-10-18 18:21:43.208 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.210 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.218 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (7ms).
2025-10-18 18:21:43.223 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 18:21:43.224 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:21:43.224 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:21:43.229 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (3ms).
2025-10-18 18:21:43.230 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (6ms).
2025-10-18 18:21:43.230 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.317 +00:00 [DBG] Hosting starting
2025-10-18 18:21:43.321 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.373 +00:00 [WRN] Using an in-memory repository. Keys will not be persisted to storage.
2025-10-18 18:21:43.373 +00:00 [WRN] Neither user profile nor HKLM registry available. Using an ephemeral key repository. Protected data will be unavailable when application exits.
2025-10-18 18:21:43.375 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 18:21:43.386 +00:00 [DBG] Repository contains no viable default key. Caller should generate a key with immediate activation.
2025-10-18 18:21:43.386 +00:00 [DBG] Policy resolution states that a new key should be added to the key ring.
2025-10-18 18:21:43.388 +00:00 [INF] Creating key {37a886e0-0761-4cd3-9337-d203ede61889} with creation date 2025-10-18 18:21:43Z, activation date 2025-10-18 18:21:43Z, and expiration date 2026-01-16 18:21:43Z.
2025-10-18 18:21:43.393 +00:00 [DBG] Descriptor deserializer type for key {37a886e0-0761-4cd3-9337-d203ede61889} is 'Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'.
2025-10-18 18:21:43.396 +00:00 [DBG] No key escrow sink found. Not writing key {37a886e0-0761-4cd3-9337-d203ede61889} to escrow.
2025-10-18 18:21:43.396 +00:00 [WRN] No XML encryptor configured. Key {37a886e0-0761-4cd3-9337-d203ede61889} may be persisted to storage in unencrypted form.
2025-10-18 18:21:43.397 +00:00 [DBG] Key cache expiration token triggered by 'CreateNewKey' operation.
2025-10-18 18:21:43.398 +00:00 [DBG] Found key {37a886e0-0761-4cd3-9337-d203ede61889}.
2025-10-18 18:21:43.415 +00:00 [DBG] Considering key {37a886e0-0761-4cd3-9337-d203ede61889} with expiration date 2026-01-16 18:21:43Z as default key.
2025-10-18 18:21:43.419 +00:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2025-10-18 18:21:43.422 +00:00 [DBG] Using managed symmetric algorithm 'System.Security.Cryptography.Aes'.
2025-10-18 18:21:43.423 +00:00 [DBG] Using managed keyed hash algorithm 'System.Security.Cryptography.HMACSHA256'.
2025-10-18 18:21:43.426 +00:00 [DBG] Using key {37a886e0-0761-4cd3-9337-d203ede61889} as the default key.
2025-10-18 18:21:43.427 +00:00 [DBG] Key ring with default key {37a886e0-0761-4cd3-9337-d203ede61889} was loaded during application startup.
2025-10-18 18:21:43.447 +00:00 [INF] Executed DbCommand (91ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 18:21:43.448 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.449 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (1ms).
2025-10-18 18:21:43.525 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.525 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.526 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:21:43.526 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:21:43.533 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2025-10-18 18:21:43.534 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 18:21:43.540 +00:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 18:21:43.556 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.557 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 15ms reading results.
2025-10-18 18:21:43.557 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.557 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:21:43.560 +00:00 [DBG] Migrating using database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.560 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.589 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.589 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.589 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:21:43.590 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 18:21:43.590 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 18:21:43.590 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 18:21:43.591 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.591 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.591 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 18:21:43.595 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 18:21:43.595 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.595 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:21:43.596 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.604 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.604 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.604 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:21:43.605 +00:00 [DBG] Creating DbCommand for 'ExecuteScalar'.
2025-10-18 18:21:43.605 +00:00 [DBG] Created DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 18:21:43.605 +00:00 [DBG] Initialized DbCommand for 'ExecuteScalar' (0ms).
2025-10-18 18:21:43.605 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.606 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.606 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 18:21:43.608 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1 FROM pg_catalog.pg_class c
    JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace
    WHERE n.nspname='public' AND
          c.relname='__EFMigrationsHistory'
)
2025-10-18 18:21:43.608 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.609 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:21:43.609 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.609 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.609 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:21:43.610 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:21:43.610 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:21:43.610 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 18:21:43.633 +00:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2025-10-18 18:21:43.637 +00:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 2AE5B9E8B7B0EDFD86FD709A56EA7C92E2569E52)
2025-10-18 18:21:43.638 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.643 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 5ms reading results.
2025-10-18 18:21:43.644 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:21:43.644 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:21:43.652 +00:00 [INF] No migrations were applied. The database is already up to date.
2025-10-18 18:21:43.844 +00:00 [INF] Now listening on: http://[::]:8080
2025-10-18 18:21:43.844 +00:00 [INF] Now listening on: https://[::]:8081
2025-10-18 18:21:43.844 +00:00 [DBG] Loaded hosting startup assembly CarsTradeAPI
2025-10-18 18:21:43.845 +00:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-18 18:21:43.845 +00:00 [INF] Hosting environment: Development
2025-10-18 18:21:43.845 +00:00 [INF] Content root path: /app
2025-10-18 18:21:43.846 +00:00 [DBG] Hosting started
2025-10-18 18:21:43.985 +00:00 [DBG] Connection id "0HNGEECOGGL5G" accepted.
2025-10-18 18:21:43.986 +00:00 [DBG] Connection id "0HNGEECOGGL5G" started.
2025-10-18 18:21:44.005 +00:00 [DBG] Connection 0HNGEECOGGL5G established using the following protocol: "Tls13"
2025-10-18 18:21:44.057 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/swagger/index.html - null null
2025-10-18 18:21:44.058 +00:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2025-10-18 18:21:44.073 +00:00 [DBG] No candidates found for the request path '/swagger/index.html'
2025-10-18 18:21:44.074 +00:00 [DBG] Request did not match any endpoints
2025-10-18 18:21:44.200 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/swagger/index.html - 200 null text/html;charset=utf-8 144.2974ms
2025-10-18 18:21:44.301 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/swagger/v1/swagger.json - null null
2025-10-18 18:21:44.302 +00:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2025-10-18 18:21:44.302 +00:00 [DBG] Request did not match any endpoints
2025-10-18 18:21:44.493 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 191.6524ms
2025-10-18 18:23:59.532 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - application/json 53
2025-10-18 18:23:59.538 +00:00 [DBG] 1 candidate(s) found for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 18:23:59.541 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)' with route pattern 'api/EmployeeAuthentication/Authenticate' is valid for the request path '/api/EmployeeAuthentication/Authenticate'
2025-10-18 18:23:59.542 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 18:23:59.544 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:23:59.639 +00:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2025-10-18 18:23:59.641 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 18:23:59.660 +00:00 [INF] Route matched with {action = "Authenticate", controller = "EmployeeAuthentication"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto]] Authenticate(CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand) on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI).
2025-10-18 18:23:59.661 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:23:59.661 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:23:59.662 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:23:59.663 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:23:59.663 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:23:59.664 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 18:23:59.666 +00:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-10-18 18:23:59.667 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController (CarsTradeAPI)
2025-10-18 18:23:59.683 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 18:23:59.685 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' using the name '' in request data ...
2025-10-18 18:23:59.686 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:23:59.707 +00:00 [DBG] Connection id "0HNGEECOGGL5G", Request id "0HNGEECOGGL5G:00000005": started reading request body.
2025-10-18 18:23:59.708 +00:00 [DBG] Connection id "0HNGEECOGGL5G", Request id "0HNGEECOGGL5G:00000005": done reading request body.
2025-10-18 18:23:59.716 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'
2025-10-18 18:23:59.717 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 18:23:59.717 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 18:23:59.717 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand' ...
2025-10-18 18:23:59.723 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthentication.EmployeeAuthenticationCommand'.
2025-10-18 18:23:59.726 +00:00 [INF] Начало обработки запроса аутентификации сотрудника
2025-10-18 18:23:59.864 +00:00 [INF] Начало обработки команды EmployeeAuthenticationCommand
2025-10-18 18:23:59.866 +00:00 [INF] Этап получения сотрудника по логину testuser1 в репозитории
2025-10-18 18:23:59.920 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:23:59.939 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()
    .FirstOrDefault(x => x.EmployeeLogin == __login_0)'
2025-10-18 18:24:00.071 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Employee>(
    asyncEnumerable: new SingleQueryingEnumerable<Employee>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Employee.EmployeeId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Employee.EmployeeAge (uint) Required, 1], [Property: Employee.EmployeeLogin (string) Required Index, 2], [Property: Employee.EmployeeMiddlename (string) Required, 3], [Property: Employee.EmployeeName (string) Required, 4], [Property: Employee.EmployeePassword (string) Required MaxLength(260), 5], [Property: Employee.EmployeeRole (string) Required, 6], [Property: Employee.EmployeeSellCounter (uint?), 7], [Property: Employee.EmployeeSurname (string) Required, 8] }
            SELECT TOP(1) e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
            FROM Employees AS e
            WHERE e.employee_login == @__login_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Employee>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:24:00.093 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:24:00.093 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:24:00.093 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:24:00.094 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:24:00.094 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:24:00.094 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:24:00.097 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-10-18 18:24:00.099 +00:00 [DBG] Executing DbCommand [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 18:24:00.111 +00:00 [INF] Executed DbCommand (13ms) [Parameters=[@__login_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
WHERE e.employee_login = @__login_0
LIMIT 1
2025-10-18 18:24:00.201 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:24:00.219 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:24:00.220 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 87ms reading results.
2025-10-18 18:24:00.220 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:24:00.220 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:24:00.221 +00:00 [INF] Сотрудник успешно получен с логином: testuser1
2025-10-18 18:24:00.307 +00:00 [INF] Пользователь с логином: testuser1 успешно аутентифицирован
2025-10-18 18:24:00.311 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:24:00.313 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:24:00.314 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:24:00.315 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:24:00.315 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:24:00.316 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:24:00.316 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.AuthResultDto'.
2025-10-18 18:24:00.328 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI) in 663.3008ms
2025-10-18 18:24:00.329 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeAuthenticationController.Authenticate (CarsTradeAPI)'
2025-10-18 18:24:00.332 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:24:00.334 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:24:00.335 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (1ms).
2025-10-18 18:24:00.336 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/EmployeeAuthentication/Authenticate - 200 null application/json; charset=utf-8 847.8837ms
2025-10-18 18:24:22.917 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - null null
2025-10-18 18:24:22.943 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 18:24:22.943 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)' with route pattern 'api/Employee/GetAllEmployee/All' is valid for the request path '/api/Employee/GetAllEmployee/All'
2025-10-18 18:24:22.944 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 18:24:22.944 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:24:22.969 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:24:22.970 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:24:22.974 +00:00 [DBG] Authorization was successful.
2025-10-18 18:24:22.975 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 18:24:22.978 +00:00 [INF] Route matched with {action = "GetAllEmployee", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.ShowEmployeeDto]]] GetAllEmployee() on controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI).
2025-10-18 18:24:22.978 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:24:22.978 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:24:22.978 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:24:22.979 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:24:22.979 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:24:22.980 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI)
2025-10-18 18:24:22.981 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.EmployeeOperation.EmployeeController (CarsTradeAPI)
2025-10-18 18:24:22.981 +00:00 [INF] Начало обработки запроса GetAllEmployee
2025-10-18 18:24:22.985 +00:00 [INF] Начало обработки команды GetAllEmployeeQuery
2025-10-18 18:24:23.302 +00:00 [INF] Этап получения всех сотрудников в репозитории
2025-10-18 18:24:23.335 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:24:23.337 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()'
2025-10-18 18:24:23.339 +00:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Employee>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Employee.EmployeeId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Employee.EmployeeAge (uint) Required, 1], [Property: Employee.EmployeeLogin (string) Required Index, 2], [Property: Employee.EmployeeMiddlename (string) Required, 3], [Property: Employee.EmployeeName (string) Required, 4], [Property: Employee.EmployeePassword (string) Required MaxLength(260), 5], [Property: Employee.EmployeeRole (string) Required, 6], [Property: Employee.EmployeeSellCounter (uint?), 7], [Property: Employee.EmployeeSurname (string) Required, 8] }
        SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
        FROM Employees AS e), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Employee>, 
    CarsTradeAPI.Data.CarsTradeDbContext, 
    False, 
    False, 
    True
)'
2025-10-18 18:24:23.340 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:24:23.340 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:24:23.341 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:24:23.341 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:24:23.341 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:24:23.342 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:24:23.342 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:24:23.342 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
2025-10-18 18:24:23.345 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT e.employee_id, e.employee_age, e.employee_login, e.employee_middlename, e.employee_name, e.employee_password, e.employee_role, e.employee_sellcounter, e.employee_surname
FROM "Employees" AS e
2025-10-18 18:24:23.346 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:24:23.347 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:24:23.348 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:24:23.348 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:24:23.348 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:24:23.348 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Employee' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:24:23.349 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:24:23.349 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 3ms reading results.
2025-10-18 18:24:23.349 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:24:23.349 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:24:23.350 +00:00 [INF] Все сотрудники успешно получены. Количество: 6
2025-10-18 18:24:23.375 +00:00 [INF] Успешное получение всех сотрудников. Количество: 6
2025-10-18 18:24:23.376 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:24:23.376 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:24:23.377 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:24:23.377 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:24:23.377 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:24:23.377 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:24:23.377 +00:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Features.EmployeeOperation.EmployeeDto.ShowEmployeeDto, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 18:24:23.379 +00:00 [INF] Executed action CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI) in 399.64ms
2025-10-18 18:24:23.380 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.EmployeeOperation.EmployeeController.GetAllEmployee (CarsTradeAPI)'
2025-10-18 18:24:23.380 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:24:23.380 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:24:23.380 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:24:23.381 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/Employee/GetAllEmployee/All - 200 null application/json; charset=utf-8 463.9582ms
2025-10-18 18:25:28.354 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/Buyer/GetAllBuyers - null null
2025-10-18 18:25:28.382 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Buyer/GetAllBuyers'
2025-10-18 18:25:28.389 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.BuyerOperation.BuyerController.GetAllBuyers (CarsTradeAPI)' with route pattern 'api/Buyer/GetAllBuyers' is valid for the request path '/api/Buyer/GetAllBuyers'
2025-10-18 18:25:28.389 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.BuyerOperation.BuyerController.GetAllBuyers (CarsTradeAPI)'
2025-10-18 18:25:28.390 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:25:28.392 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:25:28.393 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:25:28.394 +00:00 [DBG] Authorization was successful.
2025-10-18 18:25:28.394 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.BuyerOperation.BuyerController.GetAllBuyers (CarsTradeAPI)'
2025-10-18 18:25:28.397 +00:00 [INF] Route matched with {action = "GetAllBuyers", controller = "Buyer"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[CarsTradeAPI.Features.BuyerOperation.BuyerDto.ShowBuyerDto]]] GetAllBuyers() on controller CarsTradeAPI.Features.BuyerOperation.BuyerController (CarsTradeAPI).
2025-10-18 18:25:28.397 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:25:28.397 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:25:28.398 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:25:28.398 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:25:28.398 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:25:28.398 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.BuyerOperation.BuyerController (CarsTradeAPI)
2025-10-18 18:25:28.399 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.BuyerOperation.BuyerController (CarsTradeAPI)
2025-10-18 18:25:28.400 +00:00 [INF] Получен запрос на получение всех покупателей
2025-10-18 18:25:28.403 +00:00 [INF] Начало обработки запроса GetBuyersQuery
2025-10-18 18:25:28.409 +00:00 [INF] Этап получения всех покупателей в репозитории
2025-10-18 18:25:28.411 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:25:28.412 +00:00 [DBG] Compiling query expression: 
'DbSet<Buyer>()'
2025-10-18 18:25:28.416 +00:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Buyer>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Buyer.BuyerId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Buyer.BuyerAddress (string) Required, 1], [Property: Buyer.BuyerEmail (string) Required, 2], [Property: Buyer.BuyerMiddlename (string) Required, 3], [Property: Buyer.BuyerName (string) Required, 4], [Property: Buyer.BuyerSurname (string) Required, 5], [Property: Buyer.CreatedAt (DateTime) Required, 6], [Property: Buyer.PhoneNumber (string) Required, 7] }
        SELECT b.buyer_id, b.buyer_adress, b.buyer_email, b.buyer_middlename, b.buyer_name, b.buyer_surname, b.buyer_created_date, b.phone_number
        FROM Buyers AS b), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Buyer>, 
    CarsTradeAPI.Data.CarsTradeDbContext, 
    False, 
    False, 
    True
)'
2025-10-18 18:25:28.416 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:25:28.417 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:25:28.417 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:25:28.417 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:25:28.417 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:25:28.418 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:25:28.418 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:25:28.418 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT b.buyer_id, b.buyer_adress, b.buyer_email, b.buyer_middlename, b.buyer_name, b.buyer_surname, b.buyer_created_date, b.phone_number
FROM "Buyers" AS b
2025-10-18 18:25:28.421 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT b.buyer_id, b.buyer_adress, b.buyer_email, b.buyer_middlename, b.buyer_name, b.buyer_surname, b.buyer_created_date, b.phone_number
FROM "Buyers" AS b
2025-10-18 18:25:28.451 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Buyer' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:25:28.460 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:25:28.460 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 38ms reading results.
2025-10-18 18:25:28.461 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:25:28.461 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:25:28.461 +00:00 [INF] Все покупатели успешно получены. Количество: 1
2025-10-18 18:25:28.461 +00:00 [INF] Успешное получение 1 покупателей
2025-10-18 18:25:28.467 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:25:28.467 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:25:28.468 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:25:28.468 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:25:28.468 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:25:28.468 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:25:28.469 +00:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Features.BuyerOperation.BuyerDto.ShowBuyerDto, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 18:25:28.470 +00:00 [INF] Executed action CarsTradeAPI.Features.BuyerOperation.BuyerController.GetAllBuyers (CarsTradeAPI) in 71.457ms
2025-10-18 18:25:28.470 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.BuyerOperation.BuyerController.GetAllBuyers (CarsTradeAPI)'
2025-10-18 18:25:28.470 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:25:28.471 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:25:28.471 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:25:28.471 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/Buyer/GetAllBuyers - 200 null application/json; charset=utf-8 117.5813ms
2025-10-18 18:26:16.813 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/CarModel/GetCarModels/All - null null
2025-10-18 18:26:16.865 +00:00 [DBG] 1 candidate(s) found for the request path '/api/CarModel/GetCarModels/All'
2025-10-18 18:26:16.866 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.CarModelOperation.CarModelController.GetCarModel (CarsTradeAPI)' with route pattern 'api/CarModel/GetCarModels/All' is valid for the request path '/api/CarModel/GetCarModels/All'
2025-10-18 18:26:16.866 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.CarModelOperation.CarModelController.GetCarModel (CarsTradeAPI)'
2025-10-18 18:26:16.866 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:26:16.867 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:26:16.868 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:26:16.869 +00:00 [DBG] Authorization was successful.
2025-10-18 18:26:16.870 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.CarModelOperation.CarModelController.GetCarModel (CarsTradeAPI)'
2025-10-18 18:26:16.873 +00:00 [INF] Route matched with {action = "GetCarModel", controller = "CarModel"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[CarsTradeAPI.Features.CarModelOperation.CarModelDto.ShowCarModelDto]]] GetCarModel() on controller CarsTradeAPI.Features.CarModelOperation.CarModelController (CarsTradeAPI).
2025-10-18 18:26:16.873 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:26:16.873 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:26:16.874 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:26:16.874 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:26:16.874 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:26:16.874 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.CarModelOperation.CarModelController (CarsTradeAPI)
2025-10-18 18:26:16.875 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.CarModelOperation.CarModelController (CarsTradeAPI)
2025-10-18 18:26:16.876 +00:00 [INF] Начало обработки запроса GetCarModel для получения всех моделей
2025-10-18 18:26:16.880 +00:00 [INF] Начало обработки команды GetCarModelQuery
2025-10-18 18:26:16.955 +00:00 [INF] Этап получения всех CarModels в репозитории
2025-10-18 18:26:16.957 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:26:16.958 +00:00 [DBG] Compiling query expression: 
'DbSet<CarModel>()'
2025-10-18 18:26:16.964 +00:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<CarModel>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CarModel.CarModelId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CarModel.CarColor (string) Required, 1], [Property: CarModel.CarConfiguration (CarConfiguration) Required, 2], [Property: CarModel.CarCountry (string) Required, 3], [Property: CarModel.CarEngine (Engine), 4], [Property: CarModel.CarManufacturer (string) Required Index, 5], [Property: CarModel.CarModelName (string) Required Index, 6], [Property: CarModel.CarPrice (decimal) Required, 7], [Property: CarModel.ProductionDateTime (DateTime) Required, 8] }
        SELECT c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c.car_productionDateTime
        FROM CarModels AS c), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CarModel>, 
    CarsTradeAPI.Data.CarsTradeDbContext, 
    False, 
    False, 
    True
)'
2025-10-18 18:26:16.965 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:26:16.967 +00:00 [DBG] Created DbConnection. (1ms).
2025-10-18 18:26:16.967 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:16.968 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:16.968 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:26:16.968 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:16.969 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:16.969 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c."car_productionDateTime"
FROM "CarModels" AS c
2025-10-18 18:26:16.972 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c."car_productionDateTime"
FROM "CarModels" AS c
2025-10-18 18:26:16.996 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'CarModel' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:17.006 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'CarModel' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:17.007 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'CarModel' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:17.007 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'CarModel' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:17.008 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'CarModel' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:17.008 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'CarModel' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:17.008 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'CarModel' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:17.009 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:17.009 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 36ms reading results.
2025-10-18 18:26:17.009 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:17.009 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:26:17.010 +00:00 [INF] Все модели автомобилей успешно получены, количество: 7
2025-10-18 18:26:17.022 +00:00 [INF] Успешное получение 7 моделей автомобилей
2025-10-18 18:26:17.022 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:26:17.023 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:26:17.023 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:26:17.023 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:26:17.023 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:26:17.023 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:26:17.024 +00:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Features.CarModelOperation.CarModelDto.ShowCarModelDto, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 18:26:17.026 +00:00 [INF] Executed action CarsTradeAPI.Features.CarModelOperation.CarModelController.GetCarModel (CarsTradeAPI) in 151.4422ms
2025-10-18 18:26:17.026 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.CarModelOperation.CarModelController.GetCarModel (CarsTradeAPI)'
2025-10-18 18:26:17.026 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:26:17.027 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:17.027 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:26:17.027 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/CarModel/GetCarModels/All - 200 null application/json; charset=utf-8 214.7947ms
2025-10-18 18:26:43.220 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Orders/CreateOrder - application/json 475
2025-10-18 18:26:43.242 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Orders/CreateOrder'
2025-10-18 18:26:43.242 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)' with route pattern 'api/Orders/CreateOrder' is valid for the request path '/api/Orders/CreateOrder'
2025-10-18 18:26:43.243 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:26:43.243 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:26:43.244 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:26:43.244 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:26:43.244 +00:00 [DBG] Authorization was successful.
2025-10-18 18:26:43.245 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:26:43.248 +00:00 [INF] Route matched with {action = "CreateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto]] CreateOrder(CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand) on controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI).
2025-10-18 18:26:43.248 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:26:43.248 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:26:43.248 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:26:43.249 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:26:43.249 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:26:43.249 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:26:43.249 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:26:43.250 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' ...
2025-10-18 18:26:43.250 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' using the name '' in request data ...
2025-10-18 18:26:43.251 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:26:43.255 +00:00 [DBG] Connection id "0HNGEECOGGL5G", Request id "0HNGEECOGGL5G:0000000D": started reading request body.
2025-10-18 18:26:43.255 +00:00 [DBG] Connection id "0HNGEECOGGL5G", Request id "0HNGEECOGGL5G:0000000D": done reading request body.
2025-10-18 18:26:43.262 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'
2025-10-18 18:26:43.263 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:26:43.263 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:26:43.263 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand' ...
2025-10-18 18:26:43.269 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.CreateOrder.CreateOrderCommand'.
2025-10-18 18:26:43.270 +00:00 [INF] Получен запрос на создание нового заказа
2025-10-18 18:26:43.289 +00:00 [INF] Начало обработки команды CreateOrderCommand для ключа asdfawr23423
2025-10-18 18:26:43.290 +00:00 [INF] Checking IdempotencyRequest for key: asdfawr23423
2025-10-18 18:26:43.291 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:26:43.294 +00:00 [DBG] Compiling query expression: 
'DbSet<IdempotencyRequest>()
    .AsNoTracking()
    .FirstOrDefault(r => r.Key == __key_0)'
2025-10-18 18:26:43.299 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<IdempotencyRequest>(
    asyncEnumerable: new SingleQueryingEnumerable<IdempotencyRequest>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: IdempotencyRequest.Id (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: IdempotencyRequest.CreatedAt (DateTime) Required, 1], [Property: IdempotencyRequest.Key (string) Required MaxLength(100), 2], [Property: IdempotencyRequest.ResourceId (Guid?), 3], [Property: IdempotencyRequest.ResourceType (string) Required MaxLength(50), 4], [Property: IdempotencyRequest.Responsejson (string), 5], [Property: IdempotencyRequest.Status (string) Required MaxLength(50), 6] }
            SELECT TOP(1) i.Id, i.CreatedAt, i.Key, i.ResourceId, i.ResourceType, i.Responsejson, i.Status
            FROM IdempotencyRequests AS i
            WHERE i.Key == @__key_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, IdempotencyRequest>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:26:43.300 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:26:43.300 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:26:43.300 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.300 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.301 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:26:43.301 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.302 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2025-10-18 18:26:43.302 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:26:43.305 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:26:43.306 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.306 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:26:43.306 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.307 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:26:43.308 +00:00 [INF] IdempotencyRequest found: false
2025-10-18 18:26:43.313 +00:00 [INF] Этап проверки существования покупателя с ID "fff39040-5257-421f-8e13-f2af3fd91055" в репозитории
2025-10-18 18:26:43.315 +00:00 [DBG] Compiling query expression: 
'DbSet<Buyer>()
    .Any(o => o.BuyerId == __buyerId_0)'
2025-10-18 18:26:43.320 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Buyers AS b
                WHERE b.buyer_id == @__buyerId_0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:26:43.324 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.324 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.324 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:26:43.324 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.325 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.325 +00:00 [DBG] Executing DbCommand [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:26:43.328 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:26:43.331 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.332 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 3ms reading results.
2025-10-18 18:26:43.332 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.332 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:26:43.333 +00:00 [INF] Проверка существования прошла успешно, результат true
2025-10-18 18:26:43.334 +00:00 [INF] Этап проверки существования работника с ID "7bd84fc5-4710-485f-a05a-9d40a97aaa25" в репозитории
2025-10-18 18:26:43.334 +00:00 [DBG] Compiling query expression: 
'DbSet<Employee>()
    .Any(o => o.EmployeeId == __employeeId_0)'
2025-10-18 18:26:43.336 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Employees AS e
                WHERE e.employee_id == @__employeeId_0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:26:43.336 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.337 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.337 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:26:43.338 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.338 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.338 +00:00 [DBG] Executing DbCommand [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_id = @__employeeId_0)
2025-10-18 18:26:43.340 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__employeeId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Employees" AS e
    WHERE e.employee_id = @__employeeId_0)
2025-10-18 18:26:43.342 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.342 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 1ms reading results.
2025-10-18 18:26:43.342 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.343 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:26:43.343 +00:00 [INF] Проверка существования прошла успешно, результат true
2025-10-18 18:26:43.347 +00:00 [INF] Этап проверки существования машины с ID "39bbb487-392f-44fe-8b65-ea145763347b" в репозитории
2025-10-18 18:26:43.348 +00:00 [DBG] Compiling query expression: 
'DbSet<CarModel>()
    .Any(cm => (Guid?)cm.CarModelId == __carModelId_0)'
2025-10-18 18:26:43.350 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM CarModels AS c
                WHERE c.car_id == @__carModelId_0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:26:43.351 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.351 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.351 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:26:43.351 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.352 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.352 +00:00 [DBG] Executing DbCommand [Parameters=[@__carModelId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "CarModels" AS c
    WHERE c.car_id = @__carModelId_0)
2025-10-18 18:26:43.354 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__carModelId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "CarModels" AS c
    WHERE c.car_id = @__carModelId_0)
2025-10-18 18:26:43.376 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.376 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:26:43.376 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.377 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:26:43.377 +00:00 [INF] Проверка существования прошла успешно, результат true
2025-10-18 18:26:43.379 +00:00 [DBG] Compiling query expression: 
'DbSet<CarInventory>()
    .FirstOrDefault(ci => ci.CarModelId == __carModelId_0)'
2025-10-18 18:26:43.382 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CarInventory>(
    asyncEnumerable: new SingleQueryingEnumerable<CarInventory>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CarInventory.InventoryId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CarInventory.CarModelId (Guid) Required FK Index, 1], [Property: CarInventory.LastUpdated (DateTime) Required, 2], [Property: CarInventory.Quantity (uint) Required, 3] }
            SELECT TOP(1) c.inventory_id, c.car_model_id, c.last_updated, c.quantity
            FROM CarInventories AS c
            WHERE c.car_model_id == @__carModelId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CarInventory>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:26:43.383 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.383 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.383 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:26:43.383 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.384 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.384 +00:00 [DBG] Executing DbCommand [Parameters=[@__carModelId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT c.inventory_id, c.car_model_id, c.last_updated, c.quantity
FROM "CarInventories" AS c
WHERE c.car_model_id = @__carModelId_0
LIMIT 1
2025-10-18 18:26:43.386 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__carModelId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT c.inventory_id, c.car_model_id, c.last_updated, c.quantity
FROM "CarInventories" AS c
WHERE c.car_model_id = @__carModelId_0
LIMIT 1
2025-10-18 18:26:43.390 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'CarInventory' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:43.393 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.393 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 6ms reading results.
2025-10-18 18:26:43.393 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.394 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:26:43.395 +00:00 [INF] Этап получения цены машины с ID: "39bbb487-392f-44fe-8b65-ea145763347b" в репозитории
2025-10-18 18:26:43.396 +00:00 [DBG] Compiling query expression: 
'DbSet<CarModel>()
    .FirstOrDefault(cm => (Guid?)cm.CarModelId == __carModelId_0)'
2025-10-18 18:26:43.398 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<CarModel>(
    asyncEnumerable: new SingleQueryingEnumerable<CarModel>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: CarModel.CarModelId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: CarModel.CarColor (string) Required, 1], [Property: CarModel.CarConfiguration (CarConfiguration) Required, 2], [Property: CarModel.CarCountry (string) Required, 3], [Property: CarModel.CarEngine (Engine), 4], [Property: CarModel.CarManufacturer (string) Required Index, 5], [Property: CarModel.CarModelName (string) Required Index, 6], [Property: CarModel.CarPrice (decimal) Required, 7], [Property: CarModel.ProductionDateTime (DateTime) Required, 8] }
            SELECT TOP(1) c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c.car_productionDateTime
            FROM CarModels AS c
            WHERE c.car_id == @__carModelId_0), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, CarModel>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:26:43.399 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.399 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.400 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:26:43.400 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.400 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.401 +00:00 [DBG] Executing DbCommand [Parameters=[@__carModelId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c."car_productionDateTime"
FROM "CarModels" AS c
WHERE c.car_id = @__carModelId_0
LIMIT 1
2025-10-18 18:26:43.403 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__carModelId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c."car_productionDateTime"
FROM "CarModels" AS c
WHERE c.car_id = @__carModelId_0
LIMIT 1
2025-10-18 18:26:43.412 +00:00 [DBG] The navigation 'CarInventory.CarModel' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:43.417 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'CarModel' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:43.418 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.418 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 14ms reading results.
2025-10-18 18:26:43.419 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.419 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:26:43.420 +00:00 [INF] Цена машины с ID: "39bbb487-392f-44fe-8b65-ea145763347b" успешно получена
2025-10-18 18:26:43.423 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.423 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.423 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:26:43.424 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.424 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.424 +00:00 [DBG] Executing DbCommand [Parameters=[@__carModelId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT c.inventory_id, c.car_model_id, c.last_updated, c.quantity
FROM "CarInventories" AS c
WHERE c.car_model_id = @__carModelId_0
LIMIT 1
2025-10-18 18:26:43.427 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__carModelId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT c.inventory_id, c.car_model_id, c.last_updated, c.quantity
FROM "CarInventories" AS c
WHERE c.car_model_id = @__carModelId_0
LIMIT 1
2025-10-18 18:26:43.428 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.428 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:26:43.428 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.428 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:26:43.436 +00:00 [DBG] An entity of type 'CarInventory' tracked by 'CarsTradeDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:43.438 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:26:43.440 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:26:43.461 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 18:26:43.501 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.501 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.502 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:26:43.502 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.504 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2025-10-18 18:26:43.504 +00:00 [DBG] Executing DbCommand [Parameters=[@p3='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
UPDATE "CarInventories" SET car_model_id = @p0, last_updated = @p1, quantity = @p2
WHERE inventory_id = @p3;
2025-10-18 18:26:43.514 +00:00 [INF] Executed DbCommand (9ms) [Parameters=[@p3='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
UPDATE "CarInventories" SET car_model_id = @p0, last_updated = @p1, quantity = @p2
WHERE inventory_id = @p3;
2025-10-18 18:26:43.516 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.516 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 2ms reading results.
2025-10-18 18:26:43.517 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.517 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:26:43.519 +00:00 [DBG] An entity of type 'CarInventory' tracked by 'CarsTradeDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:43.520 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 18:26:43.523 +00:00 [INF] Этап создания заказа в репозитории
2025-10-18 18:26:43.545 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Order' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:43.554 +00:00 [DBG] The navigation 'OrderItem.CarModel' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:43.556 +00:00 [DBG] The navigation 'OrderItem.Order' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:43.557 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'OrderItem' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:43.558 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:26:43.558 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:26:43.565 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 18:26:43.574 +00:00 [DBG] Executing 2 update commands as a batch.
2025-10-18 18:26:43.575 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.576 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.577 +00:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2025-10-18 18:26:43.580 +00:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2025-10-18 18:26:43.581 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:26:43.581 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.582 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.582 +00:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (DbType = Object), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (DbType = Decimal), @p7='?' (DbType = Guid), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?', @p11='?' (DbType = Int64), @p12='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Orders" (order_id, "BuyerId", "EmployeeId", order_delivery_address, order_completion_date, order_create_date, order_price)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
INSERT INTO "OrderItems" (orderitem_id, "CarModelId", "OrderId", comments, order_quantity, unit_price)
VALUES (@p7, @p8, @p9, @p10, @p11, @p12);
2025-10-18 18:26:43.590 +00:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (DbType = Object), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?' (DbType = Decimal), @p7='?' (DbType = Guid), @p8='?' (DbType = Guid), @p9='?' (DbType = Guid), @p10='?', @p11='?' (DbType = Int64), @p12='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Orders" (order_id, "BuyerId", "EmployeeId", order_delivery_address, order_completion_date, order_create_date, order_price)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
INSERT INTO "OrderItems" (orderitem_id, "CarModelId", "OrderId", comments, order_quantity, unit_price)
VALUES (@p7, @p8, @p9, @p10, @p11, @p12);
2025-10-18 18:26:43.590 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.591 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:26:43.592 +00:00 [DBG] Committing transaction.
2025-10-18 18:26:43.597 +00:00 [DBG] Committed transaction.
2025-10-18 18:26:43.599 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.599 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:26:43.600 +00:00 [DBG] Disposing transaction.
2025-10-18 18:26:43.602 +00:00 [DBG] An entity of type 'Order' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:43.602 +00:00 [DBG] An entity of type 'OrderItem' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:43.603 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 2 entities written to the database.
2025-10-18 18:26:43.603 +00:00 [INF] Заказ успешно создан с ID: "ecd3f451-4c34-4998-a20d-c19bf3350375"
2025-10-18 18:26:43.611 +00:00 [DBG] Compiling query expression: 
'DbSet<IdempotencyRequest>()
    .Any(r => r.Key == __key_0)'
2025-10-18 18:26:43.613 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM IdempotencyRequests AS i
                WHERE i.Key == @__key_0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:26:43.613 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.614 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.614 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:26:43.614 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.614 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.615 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 18:26:43.618 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 18:26:43.618 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.618 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:26:43.618 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.619 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:26:43.629 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'IdempotencyRequest' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:43.630 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:26:43.630 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:26:43.634 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 18:26:43.635 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.635 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.636 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:26:43.636 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.636 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:26:43.637 +00:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 18:26:43.660 +00:00 [INF] Executed DbCommand (23ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 18:26:43.661 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.662 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 1ms reading results.
2025-10-18 18:26:43.662 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.663 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:26:43.664 +00:00 [DBG] An entity of type 'IdempotencyRequest' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:26:43.665 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 18:26:43.665 +00:00 [INF] IdempotencyRequest saved for key: asdfawr23423
2025-10-18 18:26:43.669 +00:00 [INF] Заказ успешно создан с ID: "ecd3f451-4c34-4998-a20d-c19bf3350375"
2025-10-18 18:26:43.670 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:26:43.670 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:26:43.670 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:26:43.670 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:26:43.671 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:26:43.671 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:26:43.671 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto'.
2025-10-18 18:26:43.673 +00:00 [INF] Executed action CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI) in 423.5851ms
2025-10-18 18:26:43.673 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.CreateOrder (CarsTradeAPI)'
2025-10-18 18:26:43.673 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:26:43.673 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:26:43.674 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:26:43.674 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Orders/CreateOrder - 200 null application/json; charset=utf-8 453.9097ms
2025-10-18 18:28:22.052 +00:00 [INF] Request starting HTTP/2 POST https://localhost:8081/api/Buyer/CreateBuyer - application/json 219
2025-10-18 18:28:22.104 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Buyer/CreateBuyer'
2025-10-18 18:28:22.105 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.BuyerOperation.BuyerController.CreateBuyer (CarsTradeAPI)' with route pattern 'api/Buyer/CreateBuyer' is valid for the request path '/api/Buyer/CreateBuyer'
2025-10-18 18:28:22.105 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.BuyerOperation.BuyerController.CreateBuyer (CarsTradeAPI)'
2025-10-18 18:28:22.106 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:28:22.106 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:28:22.107 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:28:22.107 +00:00 [DBG] Authorization was successful.
2025-10-18 18:28:22.107 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.BuyerOperation.BuyerController.CreateBuyer (CarsTradeAPI)'
2025-10-18 18:28:22.110 +00:00 [INF] Route matched with {action = "CreateBuyer", controller = "Buyer"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.BuyerOperation.BuyerDto.ShowBuyerDto]] CreateBuyer(CarsTradeAPI.Features.BuyerOperation.CreateBuyer.CreateBuyerCommand) on controller CarsTradeAPI.Features.BuyerOperation.BuyerController (CarsTradeAPI).
2025-10-18 18:28:22.111 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:28:22.111 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:28:22.111 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:28:22.111 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:28:22.112 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:28:22.112 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.BuyerOperation.BuyerController (CarsTradeAPI)
2025-10-18 18:28:22.112 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.BuyerOperation.BuyerController (CarsTradeAPI)
2025-10-18 18:28:22.112 +00:00 [DBG] Attempting to bind parameter 'createBuyerCommand' of type 'CarsTradeAPI.Features.BuyerOperation.CreateBuyer.CreateBuyerCommand' ...
2025-10-18 18:28:22.113 +00:00 [DBG] Attempting to bind parameter 'createBuyerCommand' of type 'CarsTradeAPI.Features.BuyerOperation.CreateBuyer.CreateBuyerCommand' using the name '' in request data ...
2025-10-18 18:28:22.113 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:28:22.114 +00:00 [DBG] Connection id "0HNGEECOGGL5G", Request id "0HNGEECOGGL5G:0000000F": started reading request body.
2025-10-18 18:28:22.114 +00:00 [DBG] Connection id "0HNGEECOGGL5G", Request id "0HNGEECOGGL5G:0000000F": done reading request body.
2025-10-18 18:28:22.116 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.BuyerOperation.CreateBuyer.CreateBuyerCommand'
2025-10-18 18:28:22.116 +00:00 [DBG] Done attempting to bind parameter 'createBuyerCommand' of type 'CarsTradeAPI.Features.BuyerOperation.CreateBuyer.CreateBuyerCommand'.
2025-10-18 18:28:22.117 +00:00 [DBG] Done attempting to bind parameter 'createBuyerCommand' of type 'CarsTradeAPI.Features.BuyerOperation.CreateBuyer.CreateBuyerCommand'.
2025-10-18 18:28:22.117 +00:00 [DBG] Attempting to validate the bound parameter 'createBuyerCommand' of type 'CarsTradeAPI.Features.BuyerOperation.CreateBuyer.CreateBuyerCommand' ...
2025-10-18 18:28:22.119 +00:00 [DBG] Done attempting to validate the bound parameter 'createBuyerCommand' of type 'CarsTradeAPI.Features.BuyerOperation.CreateBuyer.CreateBuyerCommand'.
2025-10-18 18:28:22.120 +00:00 [INF] Получен запрос на создание нового покупателя
2025-10-18 18:28:22.128 +00:00 [INF] Начало обработки команды CreateBuyerCommand
2025-10-18 18:28:22.128 +00:00 [INF] Checking IdempotencyRequest for key: erty345
2025-10-18 18:28:22.129 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:28:22.130 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:28:22.130 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:28:22.130 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.130 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.131 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:28:22.131 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:28:22.132 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:28:22.132 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:28:22.196 +00:00 [INF] Executed DbCommand (43ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:28:22.218 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.219 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 21ms reading results.
2025-10-18 18:28:22.220 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.221 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (1ms).
2025-10-18 18:28:22.222 +00:00 [INF] IdempotencyRequest found: false
2025-10-18 18:28:22.222 +00:00 [INF] Проверка уникальности номера телефона: 89314568732
2025-10-18 18:28:22.223 +00:00 [INF] Этап проверки уникальности номера телефона: 89314568732 в репозитории
2025-10-18 18:28:22.224 +00:00 [DBG] Compiling query expression: 
'DbSet<Buyer>()
    .Any(x => x.PhoneNumber == __buyerPhoneNumber_0)'
2025-10-18 18:28:22.226 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Buyers AS b
                WHERE b.phone_number == @__buyerPhoneNumber_0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:28:22.227 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.227 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.228 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:28:22.228 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:28:22.228 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:28:22.228 +00:00 [DBG] Executing DbCommand [Parameters=[@__buyerPhoneNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.phone_number = @__buyerPhoneNumber_0)
2025-10-18 18:28:22.231 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__buyerPhoneNumber_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.phone_number = @__buyerPhoneNumber_0)
2025-10-18 18:28:22.231 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.232 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:28:22.232 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.232 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:28:22.233 +00:00 [INF] Проверка уникальности номера телефона 89314568732 завершена. Результат: false
2025-10-18 18:28:22.233 +00:00 [INF] Проверка уникальности email: Surgut1@mail.ru
2025-10-18 18:28:22.234 +00:00 [INF] Этап проверки уникальности Email: Surgut1@mail.ru в репозитории
2025-10-18 18:28:22.234 +00:00 [DBG] Compiling query expression: 
'DbSet<Buyer>()
    .Any(x => x.BuyerEmail == __buyerEmail_0)'
2025-10-18 18:28:22.236 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleAsync<bool>(
    asyncEnumerable: new SingleQueryingEnumerable<bool>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> 0
            SELECT EXISTS (
                SELECT 1
                FROM Buyers AS b
                WHERE b.buyer_email == @__buyerEmail_0)), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:28:22.237 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.237 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.237 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:28:22.237 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:28:22.238 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:28:22.238 +00:00 [DBG] Executing DbCommand [Parameters=[@__buyerEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_email = @__buyerEmail_0)
2025-10-18 18:28:22.240 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__buyerEmail_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_email = @__buyerEmail_0)
2025-10-18 18:28:22.262 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.262 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:28:22.262 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.262 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:28:22.263 +00:00 [INF] Проверка уникальности Email Surgut1@mail.ru завершена. Результат: false
2025-10-18 18:28:22.265 +00:00 [INF] Этап создания покупателя с ID: "445093fb-bd79-49b7-950c-d590467cf883" в репозитории
2025-10-18 18:28:22.267 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Buyer' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:28:22.268 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:28:22.268 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:28:22.272 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 18:28:22.273 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.273 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.273 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:28:22.274 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:28:22.274 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:28:22.274 +00:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?' (DbType = DateTime), @p7='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Buyers" (buyer_id, buyer_adress, buyer_email, buyer_middlename, buyer_name, buyer_surname, buyer_created_date, phone_number)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-10-18 18:28:22.306 +00:00 [INF] Executed DbCommand (25ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?', @p2='?', @p3='?', @p4='?', @p5='?', @p6='?' (DbType = DateTime), @p7='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Buyers" (buyer_id, buyer_adress, buyer_email, buyer_middlename, buyer_name, buyer_surname, buyer_created_date, phone_number)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-10-18 18:28:22.381 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.382 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 7ms reading results.
2025-10-18 18:28:22.382 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.382 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:28:22.383 +00:00 [DBG] An entity of type 'Buyer' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:28:22.383 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 18:28:22.384 +00:00 [INF] Покупатель успешно создан с ID: "445093fb-bd79-49b7-950c-d590467cf883"
2025-10-18 18:28:22.384 +00:00 [INF] Пользователь успешно создан с ID: "445093fb-bd79-49b7-950c-d590467cf883"
2025-10-18 18:28:22.385 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.385 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.386 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:28:22.386 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:28:22.386 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:28:22.386 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 18:28:22.451 +00:00 [INF] Executed DbCommand (43ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 18:28:22.451 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.451 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:28:22.452 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.452 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:28:22.452 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'IdempotencyRequest' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:28:22.452 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:28:22.453 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:28:22.453 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 18:28:22.454 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.454 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.454 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:28:22.454 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:28:22.455 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:28:22.455 +00:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 18:28:22.457 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 18:28:22.458 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.458 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:28:22.458 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.459 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:28:22.459 +00:00 [DBG] An entity of type 'IdempotencyRequest' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:28:22.459 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 18:28:22.459 +00:00 [INF] IdempotencyRequest saved for key: erty345
2025-10-18 18:28:22.460 +00:00 [INF] Завершение обработки команды CreateBuyerCommand
2025-10-18 18:28:22.461 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:28:22.461 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:28:22.461 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:28:22.462 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:28:22.462 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:28:22.462 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:28:22.462 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.BuyerOperation.BuyerDto.ShowBuyerDto'.
2025-10-18 18:28:22.463 +00:00 [INF] Executed action CarsTradeAPI.Features.BuyerOperation.BuyerController.CreateBuyer (CarsTradeAPI) in 350.8198ms
2025-10-18 18:28:22.463 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.BuyerOperation.BuyerController.CreateBuyer (CarsTradeAPI)'
2025-10-18 18:28:22.463 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:28:22.463 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:28:22.464 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:28:22.464 +00:00 [INF] Request finished HTTP/2 POST https://localhost:8081/api/Buyer/CreateBuyer - 200 null application/json; charset=utf-8 411.3195ms
2025-10-18 18:28:47.762 +00:00 [INF] Request starting HTTP/2 PUT https://localhost:8081/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375 - application/json 56
2025-10-18 18:28:47.763 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375'
2025-10-18 18:28:47.764 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)' with route pattern 'api/Orders/EditOrder/{Id:Guid}' is valid for the request path '/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375'
2025-10-18 18:28:47.764 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)'
2025-10-18 18:28:47.765 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:28:47.766 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:28:47.767 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:28:47.768 +00:00 [DBG] Authorization was successful.
2025-10-18 18:28:47.768 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)'
2025-10-18 18:28:47.773 +00:00 [INF] Route matched with {action = "EditOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto]] EditOrder(System.Guid, System.String, CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand) on controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI).
2025-10-18 18:28:47.773 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:28:47.773 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:28:47.774 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:28:47.774 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:28:47.774 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:28:47.774 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:28:47.775 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:28:47.775 +00:00 [DBG] Attempting to bind parameter 'Id' of type 'System.Guid' ...
2025-10-18 18:28:47.776 +00:00 [DBG] Attempting to bind parameter 'Id' of type 'System.Guid' using the name 'Id' in request data ...
2025-10-18 18:28:47.777 +00:00 [DBG] Done attempting to bind parameter 'Id' of type 'System.Guid'.
2025-10-18 18:28:47.777 +00:00 [DBG] Done attempting to bind parameter 'Id' of type 'System.Guid'.
2025-10-18 18:28:47.777 +00:00 [DBG] Attempting to validate the bound parameter 'Id' of type 'System.Guid' ...
2025-10-18 18:28:47.778 +00:00 [DBG] Done attempting to validate the bound parameter 'Id' of type 'System.Guid'.
2025-10-18 18:28:47.778 +00:00 [DBG] Attempting to bind parameter 'idempotencyKey' of type 'System.String' ...
2025-10-18 18:28:47.779 +00:00 [DBG] Attempting to bind parameter 'idempotencyKey' of type 'System.String' using the name 'idempotencyKey' in request data ...
2025-10-18 18:28:47.781 +00:00 [DBG] Attempting to bind parameter 'idempotencyKey' of type 'System.String' using the name 'idempotencyKey' in request data ...
2025-10-18 18:28:47.781 +00:00 [DBG] Done attempting to bind parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:28:47.782 +00:00 [DBG] Done attempting to bind parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:28:47.782 +00:00 [DBG] Done attempting to bind parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:28:47.782 +00:00 [DBG] Attempting to validate the bound parameter 'idempotencyKey' of type 'System.String' ...
2025-10-18 18:28:47.783 +00:00 [DBG] Done attempting to validate the bound parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:28:47.783 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand' ...
2025-10-18 18:28:47.783 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand' using the name '' in request data ...
2025-10-18 18:28:47.783 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:28:47.788 +00:00 [DBG] Connection id "0HNGEECOGGL5G", Request id "0HNGEECOGGL5G:00000011": started reading request body.
2025-10-18 18:28:47.788 +00:00 [DBG] Connection id "0HNGEECOGGL5G", Request id "0HNGEECOGGL5G:00000011": done reading request body.
2025-10-18 18:28:47.796 +00:00 [DBG] JSON input formatter threw an exception: The JSON object contains a trailing comma at the end which is not supported in this mode. Change the reader options. Path: $ | LineNumber: 2 | BytePositionInLine: 0.
2025-10-18 18:28:47.797 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'.
2025-10-18 18:28:47.797 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'.
2025-10-18 18:28:47.797 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand' ...
2025-10-18 18:28:47.798 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'.
2025-10-18 18:28:47.799 +00:00 [DBG] The request has model state errors, returning an error response.
2025-10-18 18:28:47.801 +00:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-10-18 18:28:47.802 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:28:47.802 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]' and explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'. The content types in the accept header must be a subset of the explicitly set content types.
2025-10-18 18:28:47.803 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:28:47.803 +00:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-10-18 18:28:47.803 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-10-18 18:28:47.804 +00:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-10-18 18:28:47.822 +00:00 [INF] Executed action CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI) in 47.5577ms
2025-10-18 18:28:47.823 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)'
2025-10-18 18:28:47.823 +00:00 [INF] Request finished HTTP/2 PUT https://localhost:8081/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375 - 400 null application/problem+json; charset=utf-8 60.8099ms
2025-10-18 18:29:02.677 +00:00 [INF] Request starting HTTP/2 PUT https://localhost:8081/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375 - application/json 55
2025-10-18 18:29:02.698 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375'
2025-10-18 18:29:02.699 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)' with route pattern 'api/Orders/EditOrder/{Id:Guid}' is valid for the request path '/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375'
2025-10-18 18:29:02.699 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)'
2025-10-18 18:29:02.699 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:29:02.700 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:29:02.700 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:29:02.700 +00:00 [DBG] Authorization was successful.
2025-10-18 18:29:02.700 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)'
2025-10-18 18:29:02.701 +00:00 [INF] Route matched with {action = "EditOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto]] EditOrder(System.Guid, System.String, CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand) on controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI).
2025-10-18 18:29:02.701 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:29:02.701 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:29:02.702 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:29:02.702 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:29:02.702 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:29:02.702 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:29:02.703 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:29:02.703 +00:00 [DBG] Attempting to bind parameter 'Id' of type 'System.Guid' ...
2025-10-18 18:29:02.703 +00:00 [DBG] Attempting to bind parameter 'Id' of type 'System.Guid' using the name 'Id' in request data ...
2025-10-18 18:29:02.704 +00:00 [DBG] Done attempting to bind parameter 'Id' of type 'System.Guid'.
2025-10-18 18:29:02.704 +00:00 [DBG] Done attempting to bind parameter 'Id' of type 'System.Guid'.
2025-10-18 18:29:02.704 +00:00 [DBG] Attempting to validate the bound parameter 'Id' of type 'System.Guid' ...
2025-10-18 18:29:02.704 +00:00 [DBG] Done attempting to validate the bound parameter 'Id' of type 'System.Guid'.
2025-10-18 18:29:02.705 +00:00 [DBG] Attempting to bind parameter 'idempotencyKey' of type 'System.String' ...
2025-10-18 18:29:02.705 +00:00 [DBG] Attempting to bind parameter 'idempotencyKey' of type 'System.String' using the name 'idempotencyKey' in request data ...
2025-10-18 18:29:02.705 +00:00 [DBG] Attempting to bind parameter 'idempotencyKey' of type 'System.String' using the name 'idempotencyKey' in request data ...
2025-10-18 18:29:02.705 +00:00 [DBG] Done attempting to bind parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:29:02.706 +00:00 [DBG] Done attempting to bind parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:29:02.706 +00:00 [DBG] Done attempting to bind parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:29:02.706 +00:00 [DBG] Attempting to validate the bound parameter 'idempotencyKey' of type 'System.String' ...
2025-10-18 18:29:02.706 +00:00 [DBG] Done attempting to validate the bound parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:29:02.707 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand' ...
2025-10-18 18:29:02.707 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand' using the name '' in request data ...
2025-10-18 18:29:02.707 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:29:02.707 +00:00 [DBG] Connection id "0HNGEECOGGL5G", Request id "0HNGEECOGGL5G:00000013": started reading request body.
2025-10-18 18:29:02.707 +00:00 [DBG] Connection id "0HNGEECOGGL5G", Request id "0HNGEECOGGL5G:00000013": done reading request body.
2025-10-18 18:29:02.708 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'
2025-10-18 18:29:02.708 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'.
2025-10-18 18:29:02.708 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'.
2025-10-18 18:29:02.708 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand' ...
2025-10-18 18:29:02.710 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'.
2025-10-18 18:29:02.710 +00:00 [DBG] The request has model state errors, returning an error response.
2025-10-18 18:29:02.710 +00:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-10-18 18:29:02.711 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:29:02.711 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]' and explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'. The content types in the accept header must be a subset of the explicitly set content types.
2025-10-18 18:29:02.711 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:29:02.711 +00:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-10-18 18:29:02.711 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-10-18 18:29:02.712 +00:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-10-18 18:29:02.712 +00:00 [INF] Executed action CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI) in 9.75ms
2025-10-18 18:29:02.712 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)'
2025-10-18 18:29:02.712 +00:00 [INF] Request finished HTTP/2 PUT https://localhost:8081/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375 - 400 null application/problem+json; charset=utf-8 35.8073ms
2025-10-18 18:29:13.505 +00:00 [INF] Request starting HTTP/2 PUT https://localhost:8081/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375 - application/json 55
2025-10-18 18:29:13.506 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375'
2025-10-18 18:29:13.506 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)' with route pattern 'api/Orders/EditOrder/{Id:Guid}' is valid for the request path '/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375'
2025-10-18 18:29:13.506 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)'
2025-10-18 18:29:13.507 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:29:13.507 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:29:13.507 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:29:13.508 +00:00 [DBG] Authorization was successful.
2025-10-18 18:29:13.508 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)'
2025-10-18 18:29:13.508 +00:00 [INF] Route matched with {action = "EditOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto]] EditOrder(System.Guid, System.String, CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand) on controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI).
2025-10-18 18:29:13.510 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:29:13.510 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:29:13.511 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:29:13.511 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:29:13.511 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:29:13.512 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:29:13.512 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:29:13.513 +00:00 [DBG] Attempting to bind parameter 'Id' of type 'System.Guid' ...
2025-10-18 18:29:13.513 +00:00 [DBG] Attempting to bind parameter 'Id' of type 'System.Guid' using the name 'Id' in request data ...
2025-10-18 18:29:13.513 +00:00 [DBG] Done attempting to bind parameter 'Id' of type 'System.Guid'.
2025-10-18 18:29:13.514 +00:00 [DBG] Done attempting to bind parameter 'Id' of type 'System.Guid'.
2025-10-18 18:29:13.514 +00:00 [DBG] Attempting to validate the bound parameter 'Id' of type 'System.Guid' ...
2025-10-18 18:29:13.515 +00:00 [DBG] Done attempting to validate the bound parameter 'Id' of type 'System.Guid'.
2025-10-18 18:29:13.515 +00:00 [DBG] Attempting to bind parameter 'idempotencyKey' of type 'System.String' ...
2025-10-18 18:29:13.515 +00:00 [DBG] Attempting to bind parameter 'idempotencyKey' of type 'System.String' using the name 'idempotencyKey' in request data ...
2025-10-18 18:29:13.516 +00:00 [DBG] Attempting to bind parameter 'idempotencyKey' of type 'System.String' using the name 'idempotencyKey' in request data ...
2025-10-18 18:29:13.516 +00:00 [DBG] Done attempting to bind parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:29:13.516 +00:00 [DBG] Done attempting to bind parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:29:13.517 +00:00 [DBG] Done attempting to bind parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:29:13.518 +00:00 [DBG] Attempting to validate the bound parameter 'idempotencyKey' of type 'System.String' ...
2025-10-18 18:29:13.518 +00:00 [DBG] Done attempting to validate the bound parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:29:13.519 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand' ...
2025-10-18 18:29:13.519 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand' using the name '' in request data ...
2025-10-18 18:29:13.519 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:29:13.520 +00:00 [DBG] Connection id "0HNGEECOGGL5G", Request id "0HNGEECOGGL5G:00000015": started reading request body.
2025-10-18 18:29:13.520 +00:00 [DBG] Connection id "0HNGEECOGGL5G", Request id "0HNGEECOGGL5G:00000015": done reading request body.
2025-10-18 18:29:13.521 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'
2025-10-18 18:29:13.521 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'.
2025-10-18 18:29:13.521 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'.
2025-10-18 18:29:13.522 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand' ...
2025-10-18 18:29:13.522 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'.
2025-10-18 18:29:13.522 +00:00 [DBG] The request has model state errors, returning an error response.
2025-10-18 18:29:13.522 +00:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-10-18 18:29:13.523 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:29:13.523 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]' and explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'. The content types in the accept header must be a subset of the explicitly set content types.
2025-10-18 18:29:13.523 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:29:13.523 +00:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-10-18 18:29:13.524 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-10-18 18:29:13.524 +00:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-10-18 18:29:13.524 +00:00 [INF] Executed action CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI) in 12.5089ms
2025-10-18 18:29:13.524 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)'
2025-10-18 18:29:13.525 +00:00 [INF] Request finished HTTP/2 PUT https://localhost:8081/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375 - 400 null application/problem+json; charset=utf-8 19.6927ms
2025-10-18 18:29:33.294 +00:00 [INF] Request starting HTTP/2 PUT https://localhost:8081/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375 - application/json 55
2025-10-18 18:29:33.295 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375'
2025-10-18 18:29:33.295 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)' with route pattern 'api/Orders/EditOrder/{Id:Guid}' is valid for the request path '/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375'
2025-10-18 18:29:33.296 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)'
2025-10-18 18:29:33.296 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:29:33.296 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:29:33.297 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:29:33.297 +00:00 [DBG] Authorization was successful.
2025-10-18 18:29:33.297 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)'
2025-10-18 18:29:33.297 +00:00 [INF] Route matched with {action = "EditOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto]] EditOrder(System.Guid, System.String, CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand) on controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI).
2025-10-18 18:29:33.298 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:29:33.298 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:29:33.298 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:29:33.298 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:29:33.299 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:29:33.299 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:29:33.299 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:29:33.300 +00:00 [DBG] Attempting to bind parameter 'Id' of type 'System.Guid' ...
2025-10-18 18:29:33.302 +00:00 [DBG] Attempting to bind parameter 'Id' of type 'System.Guid' using the name 'Id' in request data ...
2025-10-18 18:29:33.302 +00:00 [DBG] Done attempting to bind parameter 'Id' of type 'System.Guid'.
2025-10-18 18:29:33.302 +00:00 [DBG] Done attempting to bind parameter 'Id' of type 'System.Guid'.
2025-10-18 18:29:33.303 +00:00 [DBG] Attempting to validate the bound parameter 'Id' of type 'System.Guid' ...
2025-10-18 18:29:33.303 +00:00 [DBG] Done attempting to validate the bound parameter 'Id' of type 'System.Guid'.
2025-10-18 18:29:33.304 +00:00 [DBG] Attempting to bind parameter 'idempotencyKey' of type 'System.String' ...
2025-10-18 18:29:33.304 +00:00 [DBG] Attempting to bind parameter 'idempotencyKey' of type 'System.String' using the name 'idempotencyKey' in request data ...
2025-10-18 18:29:33.305 +00:00 [DBG] Attempting to bind parameter 'idempotencyKey' of type 'System.String' using the name 'idempotencyKey' in request data ...
2025-10-18 18:29:33.306 +00:00 [DBG] Done attempting to bind parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:29:33.306 +00:00 [DBG] Done attempting to bind parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:29:33.306 +00:00 [DBG] Done attempting to bind parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:29:33.306 +00:00 [DBG] Attempting to validate the bound parameter 'idempotencyKey' of type 'System.String' ...
2025-10-18 18:29:33.307 +00:00 [DBG] Done attempting to validate the bound parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:29:33.307 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand' ...
2025-10-18 18:29:33.307 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand' using the name '' in request data ...
2025-10-18 18:29:33.307 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:29:33.308 +00:00 [DBG] Connection id "0HNGEECOGGL5G", Request id "0HNGEECOGGL5G:00000017": started reading request body.
2025-10-18 18:29:33.308 +00:00 [DBG] Connection id "0HNGEECOGGL5G", Request id "0HNGEECOGGL5G:00000017": done reading request body.
2025-10-18 18:29:33.308 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'
2025-10-18 18:29:33.308 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'.
2025-10-18 18:29:33.309 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'.
2025-10-18 18:29:33.309 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand' ...
2025-10-18 18:29:33.310 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'.
2025-10-18 18:29:33.310 +00:00 [DBG] The request has model state errors, returning an error response.
2025-10-18 18:29:33.310 +00:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2025-10-18 18:29:33.311 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:29:33.311 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]' and explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'. The content types in the accept header must be a subset of the explicitly set content types.
2025-10-18 18:29:33.311 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:29:33.312 +00:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2025-10-18 18:29:33.312 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2025-10-18 18:29:33.312 +00:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-10-18 18:29:33.312 +00:00 [INF] Executed action CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI) in 13.7034ms
2025-10-18 18:29:33.313 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)'
2025-10-18 18:29:33.313 +00:00 [INF] Request finished HTTP/2 PUT https://localhost:8081/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375 - 400 null application/problem+json; charset=utf-8 18.582ms
2025-10-18 18:31:20.336 +00:00 [INF] Request starting HTTP/2 PUT https://localhost:8081/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375 - application/json 143
2025-10-18 18:31:20.343 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375'
2025-10-18 18:31:20.349 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)' with route pattern 'api/Orders/EditOrder/{Id:Guid}' is valid for the request path '/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375'
2025-10-18 18:31:20.350 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)'
2025-10-18 18:31:20.350 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:31:20.351 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:31:20.351 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:31:20.352 +00:00 [DBG] Authorization was successful.
2025-10-18 18:31:20.352 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)'
2025-10-18 18:31:20.352 +00:00 [INF] Route matched with {action = "EditOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto]] EditOrder(System.Guid, System.String, CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand) on controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI).
2025-10-18 18:31:20.352 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:31:20.353 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:31:20.353 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:31:20.353 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:31:20.353 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:31:20.353 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:31:20.354 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:31:20.354 +00:00 [DBG] Attempting to bind parameter 'Id' of type 'System.Guid' ...
2025-10-18 18:31:20.354 +00:00 [DBG] Attempting to bind parameter 'Id' of type 'System.Guid' using the name 'Id' in request data ...
2025-10-18 18:31:20.354 +00:00 [DBG] Done attempting to bind parameter 'Id' of type 'System.Guid'.
2025-10-18 18:31:20.355 +00:00 [DBG] Done attempting to bind parameter 'Id' of type 'System.Guid'.
2025-10-18 18:31:20.355 +00:00 [DBG] Attempting to validate the bound parameter 'Id' of type 'System.Guid' ...
2025-10-18 18:31:20.355 +00:00 [DBG] Done attempting to validate the bound parameter 'Id' of type 'System.Guid'.
2025-10-18 18:31:20.355 +00:00 [DBG] Attempting to bind parameter 'idempotencyKey' of type 'System.String' ...
2025-10-18 18:31:20.356 +00:00 [DBG] Attempting to bind parameter 'idempotencyKey' of type 'System.String' using the name 'idempotencyKey' in request data ...
2025-10-18 18:31:20.356 +00:00 [DBG] Attempting to bind parameter 'idempotencyKey' of type 'System.String' using the name 'idempotencyKey' in request data ...
2025-10-18 18:31:20.356 +00:00 [DBG] Done attempting to bind parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:31:20.356 +00:00 [DBG] Done attempting to bind parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:31:20.356 +00:00 [DBG] Done attempting to bind parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:31:20.357 +00:00 [DBG] Attempting to validate the bound parameter 'idempotencyKey' of type 'System.String' ...
2025-10-18 18:31:20.357 +00:00 [DBG] Done attempting to validate the bound parameter 'idempotencyKey' of type 'System.String'.
2025-10-18 18:31:20.357 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand' ...
2025-10-18 18:31:20.357 +00:00 [DBG] Attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand' using the name '' in request data ...
2025-10-18 18:31:20.358 +00:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2025-10-18 18:31:20.358 +00:00 [DBG] Connection id "0HNGEECOGGL5G", Request id "0HNGEECOGGL5G:00000019": started reading request body.
2025-10-18 18:31:20.358 +00:00 [DBG] Connection id "0HNGEECOGGL5G", Request id "0HNGEECOGGL5G:00000019": done reading request body.
2025-10-18 18:31:20.359 +00:00 [DBG] JSON input formatter succeeded, deserializing to type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'
2025-10-18 18:31:20.359 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'.
2025-10-18 18:31:20.359 +00:00 [DBG] Done attempting to bind parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'.
2025-10-18 18:31:20.359 +00:00 [DBG] Attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand' ...
2025-10-18 18:31:20.360 +00:00 [DBG] Done attempting to validate the bound parameter 'command' of type 'CarsTradeAPI.Features.OrdersOperation.EditOrder.EditOrderCommand'.
2025-10-18 18:31:20.360 +00:00 [INF] Получение запроса на редактирование информации о заказе с ID: "ecd3f451-4c34-4998-a20d-c19bf3350375"
2025-10-18 18:31:20.372 +00:00 [INF] Нало обработки комманды EditOrderCommand
2025-10-18 18:31:20.372 +00:00 [INF] Checking IdempotencyRequest for key: sdfdsdf54
2025-10-18 18:31:20.373 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:31:20.374 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:31:20.374 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:31:20.374 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.375 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.375 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:31:20.375 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:31:20.375 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:31:20.376 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:31:20.378 +00:00 [INF] Executed DbCommand (2ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT i."Id", i."CreatedAt", i."Key", i."ResourceId", i."ResourceType", i."Responsejson", i."Status"
FROM "IdempotencyRequests" AS i
WHERE i."Key" = @__key_0
LIMIT 1
2025-10-18 18:31:20.379 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.380 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:31:20.380 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.381 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:31:20.381 +00:00 [INF] IdempotencyRequest found: false
2025-10-18 18:31:20.385 +00:00 [INF] Этап получения Заказа с ID: "ecd3f451-4c34-4998-a20d-c19bf3350375" в репозитории
2025-10-18 18:31:20.386 +00:00 [DBG] Compiling query expression: 
'DbSet<Order>()
    .Include(o => o.OrderItems)
    .ThenInclude(oi => oi.CarModel)
    .FirstOrDefault(o => o.OrderId == __orderId_0)'
2025-10-18 18:31:20.393 +00:00 [DBG] Including navigation: 'Order.OrderItems'.
2025-10-18 18:31:20.397 +00:00 [DBG] Including navigation: 'OrderItem.CarModel'.
2025-10-18 18:31:20.450 +00:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Order>(
    asyncEnumerable: new SingleQueryingEnumerable<Order>(
        (RelationalQueryContext)queryContext, 
        RelationalCommandCache.QueryExpression(
            Client Projections:
                0 -> Dictionary<IProperty, int> { [Property: Order.OrderId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Order.BuyerId (Guid) Required FK Index, 1], [Property: Order.EmployeeId (Guid) Required FK Index, 2], [Property: Order.OrderAddress (OrderAddress) Required, 3], [Property: Order.OrderCompletionDate (DateTime?), 4], [Property: Order.OrderCreateDate (DateTime) Required, 5], [Property: Order.OrderPrice (decimal) Required, 6] }
                1 -> 0
                2 -> Dictionary<IProperty, int> { [Property: OrderItem.OrderItemId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: OrderItem.CarModelId (Guid) Required FK Index, 8], [Property: OrderItem.OrderId (Guid) Required FK Index, 9], [Property: OrderItem.OrderItemComments (string), 10], [Property: OrderItem.OrderQuantity (long) Required, 11], [Property: OrderItem.UnitPrice (decimal) Required, 12] }
                3 -> Dictionary<IProperty, int> { [Property: CarModel.CarModelId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: CarModel.CarColor (string) Required, 14], [Property: CarModel.CarConfiguration (CarConfiguration) Required, 15], [Property: CarModel.CarCountry (string) Required, 16], [Property: CarModel.CarEngine (Engine), 17], [Property: CarModel.CarManufacturer (string) Required Index, 18], [Property: CarModel.CarModelName (string) Required Index, 19], [Property: CarModel.CarPrice (decimal) Required, 20], [Property: CarModel.ProductionDateTime (DateTime) Required, 21] }
                4 -> 7
                5 -> 13
            SELECT t.order_id, t.BuyerId, t.EmployeeId, t.order_delivery_address, t.order_completion_date, t.order_create_date, t.order_price, t0.orderitem_id, t0.CarModelId, t0.OrderId, t0.comments, t0.order_quantity, t0.unit_price, t0.car_id, t0.car_color, t0.car_configuration, t0.car_country, t0.car_engine, t0.car_manufacturer, t0.car_model, t0.car_price, t0.car_productionDateTime
            FROM 
            (
                SELECT TOP(1) o.order_id, o.BuyerId, o.EmployeeId, o.order_delivery_address, o.order_completion_date, o.order_create_date, o.order_price
                FROM Orders AS o
                WHERE o.order_id == @__orderId_0
            ) AS t
            LEFT JOIN 
            (
                SELECT o0.orderitem_id, o0.CarModelId, o0.OrderId, o0.comments, o0.order_quantity, o0.unit_price, c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c.car_productionDateTime
                FROM OrderItems AS o0
                INNER JOIN CarModels AS c ON o0.CarModelId == c.car_id
            ) AS t0 ON t.order_id == t0.OrderId
            ORDER BY t.order_id ASC, t0.orderitem_id ASC), 
        null, 
        Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Order>, 
        CarsTradeAPI.Data.CarsTradeDbContext, 
        False, 
        False, 
        True
    ), 
    cancellationToken: queryContext.CancellationToken)'
2025-10-18 18:31:20.453 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.453 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.453 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:31:20.453 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:31:20.454 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:31:20.454 +00:00 [DBG] Executing DbCommand [Parameters=[@__orderId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT t.order_id, t."BuyerId", t."EmployeeId", t.order_delivery_address, t.order_completion_date, t.order_create_date, t.order_price, t0.orderitem_id, t0."CarModelId", t0."OrderId", t0.comments, t0.order_quantity, t0.unit_price, t0.car_id, t0.car_color, t0.car_configuration, t0.car_country, t0.car_engine, t0.car_manufacturer, t0.car_model, t0.car_price, t0."car_productionDateTime"
FROM (
    SELECT o.order_id, o."BuyerId", o."EmployeeId", o.order_delivery_address, o.order_completion_date, o.order_create_date, o.order_price
    FROM "Orders" AS o
    WHERE o.order_id = @__orderId_0
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT o0.orderitem_id, o0."CarModelId", o0."OrderId", o0.comments, o0.order_quantity, o0.unit_price, c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c."car_productionDateTime"
    FROM "OrderItems" AS o0
    INNER JOIN "CarModels" AS c ON o0."CarModelId" = c.car_id
) AS t0 ON t.order_id = t0."OrderId"
ORDER BY t.order_id, t0.orderitem_id
2025-10-18 18:31:20.478 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__orderId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT t.order_id, t."BuyerId", t."EmployeeId", t.order_delivery_address, t.order_completion_date, t.order_create_date, t.order_price, t0.orderitem_id, t0."CarModelId", t0."OrderId", t0.comments, t0.order_quantity, t0.unit_price, t0.car_id, t0.car_color, t0.car_configuration, t0.car_country, t0.car_engine, t0.car_manufacturer, t0.car_model, t0.car_price, t0."car_productionDateTime"
FROM (
    SELECT o.order_id, o."BuyerId", o."EmployeeId", o.order_delivery_address, o.order_completion_date, o.order_create_date, o.order_price
    FROM "Orders" AS o
    WHERE o.order_id = @__orderId_0
    LIMIT 1
) AS t
LEFT JOIN (
    SELECT o0.orderitem_id, o0."CarModelId", o0."OrderId", o0.comments, o0.order_quantity, o0.unit_price, c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c."car_productionDateTime"
    FROM "OrderItems" AS o0
    INNER JOIN "CarModels" AS c ON o0."CarModelId" = c.car_id
) AS t0 ON t.order_id = t0."OrderId"
ORDER BY t.order_id, t0.orderitem_id
2025-10-18 18:31:20.511 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Order' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:31:20.515 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'OrderItem' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:31:20.516 +00:00 [DBG] The navigation 'OrderItem.CarModel' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:31:20.516 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'CarModel' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:31:20.517 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.518 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 15ms reading results.
2025-10-18 18:31:20.518 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.518 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:31:20.519 +00:00 [INF] Заказ с ID: "ecd3f451-4c34-4998-a20d-c19bf3350375" успешно получен
2025-10-18 18:31:20.519 +00:00 [INF] Этап проверки существования покупателя с ID "445093fb-bd79-49b7-950c-d590467cf883" в репозитории
2025-10-18 18:31:20.519 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.520 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.520 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:31:20.520 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:31:20.520 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:31:20.521 +00:00 [DBG] Executing DbCommand [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:31:20.544 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__buyerId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "Buyers" AS b
    WHERE b.buyer_id = @__buyerId_0)
2025-10-18 18:31:20.565 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.565 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 20ms reading results.
2025-10-18 18:31:20.565 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.566 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:31:20.566 +00:00 [INF] Проверка существования прошла успешно, результат true
2025-10-18 18:31:20.569 +00:00 [INF] Этап обновления заказа с ID: "ecd3f451-4c34-4998-a20d-c19bf3350375" в репозитории
2025-10-18 18:31:20.569 +00:00 [DBG] An entity of type 'Order' tracked by 'CarsTradeDbContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:31:20.569 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:31:20.569 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:31:20.570 +00:00 [DBG] The foreign key property 'Order.BuyerId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2025-10-18 18:31:20.573 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 18:31:20.574 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.574 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.574 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:31:20.575 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:31:20.575 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:31:20.575 +00:00 [DBG] Executing DbCommand [Parameters=[@p6='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Object), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Orders" SET "BuyerId" = @p0, "EmployeeId" = @p1, order_delivery_address = @p2, order_completion_date = @p3, order_create_date = @p4, order_price = @p5
WHERE order_id = @p6;
2025-10-18 18:31:20.579 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@p6='?' (DbType = Guid), @p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Object), @p3='?' (DbType = DateTime), @p4='?' (DbType = DateTime), @p5='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Orders" SET "BuyerId" = @p0, "EmployeeId" = @p1, order_delivery_address = @p2, order_completion_date = @p3, order_create_date = @p4, order_price = @p5
WHERE order_id = @p6;
2025-10-18 18:31:20.600 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.600 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:31:20.601 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.601 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:31:20.602 +00:00 [DBG] An entity of type 'Order' tracked by 'CarsTradeDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:31:20.602 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 18:31:20.603 +00:00 [INF] Заказ с ID: "ecd3f451-4c34-4998-a20d-c19bf3350375" успешно обновлена
2025-10-18 18:31:20.604 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.604 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.604 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:31:20.604 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:31:20.605 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:31:20.605 +00:00 [DBG] Executing DbCommand [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 18:31:20.608 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@__key_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "IdempotencyRequests" AS i
    WHERE i."Key" = @__key_0)
2025-10-18 18:31:20.629 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.630 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 21ms reading results.
2025-10-18 18:31:20.630 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.630 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:31:20.631 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'IdempotencyRequest' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:31:20.631 +00:00 [DBG] SaveChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:31:20.631 +00:00 [DBG] DetectChanges starting for 'CarsTradeDbContext'.
2025-10-18 18:31:20.631 +00:00 [DBG] DetectChanges completed for 'CarsTradeDbContext'.
2025-10-18 18:31:20.632 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.632 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.632 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:31:20.632 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:31:20.632 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:31:20.633 +00:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 18:31:20.657 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = Guid), @p4='?', @p5='?', @p6='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "IdempotencyRequests" ("Id", "CreatedAt", "Key", "ResourceId", "ResourceType", "Responsejson", "Status")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-18 18:31:20.657 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.657 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 0ms reading results.
2025-10-18 18:31:20.658 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.658 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:31:20.658 +00:00 [DBG] An entity of type 'IdempotencyRequest' tracked by 'CarsTradeDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:31:20.658 +00:00 [DBG] SaveChanges completed for 'CarsTradeDbContext' with 1 entities written to the database.
2025-10-18 18:31:20.659 +00:00 [INF] IdempotencyRequest saved for key: sdfdsdf54
2025-10-18 18:31:20.661 +00:00 [INF] Заказ успешно создан с ID: "ecd3f451-4c34-4998-a20d-c19bf3350375"
2025-10-18 18:31:20.661 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:31:20.662 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:31:20.662 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:31:20.662 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:31:20.662 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:31:20.662 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:31:20.663 +00:00 [INF] Executing OkObjectResult, writing value of type 'CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto'.
2025-10-18 18:31:20.663 +00:00 [INF] Executed action CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI) in 309.6559ms
2025-10-18 18:31:20.663 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.EditOrder (CarsTradeAPI)'
2025-10-18 18:31:20.664 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:31:20.664 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:20.664 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:31:20.664 +00:00 [INF] Request finished HTTP/2 PUT https://localhost:8081/api/Orders/EditOrder/ecd3f451-4c34-4998-a20d-c19bf3350375 - 200 null application/json; charset=utf-8 327.943ms
2025-10-18 18:31:43.782 +00:00 [INF] Request starting HTTP/2 GET https://localhost:8081/api/Orders/GetAllOrders/All - null null
2025-10-18 18:31:43.812 +00:00 [DBG] 1 candidate(s) found for the request path '/api/Orders/GetAllOrders/All'
2025-10-18 18:31:43.813 +00:00 [DBG] Endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.GetAllOrders (CarsTradeAPI)' with route pattern 'api/Orders/GetAllOrders/All' is valid for the request path '/api/Orders/GetAllOrders/All'
2025-10-18 18:31:43.813 +00:00 [DBG] Request matched endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.GetAllOrders (CarsTradeAPI)'
2025-10-18 18:31:43.813 +00:00 [DBG] Static files was skipped as the request already matched an endpoint.
2025-10-18 18:31:43.814 +00:00 [DBG] Successfully validated the token.
2025-10-18 18:31:43.815 +00:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2025-10-18 18:31:43.815 +00:00 [DBG] Authorization was successful.
2025-10-18 18:31:43.815 +00:00 [INF] Executing endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.GetAllOrders (CarsTradeAPI)'
2025-10-18 18:31:43.818 +00:00 [INF] Route matched with {action = "GetAllOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto]]] GetAllOrders() on controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI).
2025-10-18 18:31:43.819 +00:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2025-10-18 18:31:43.819 +00:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2025-10-18 18:31:43.819 +00:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2025-10-18 18:31:43.819 +00:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2025-10-18 18:31:43.819 +00:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2025-10-18 18:31:43.820 +00:00 [DBG] Executing controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:31:43.820 +00:00 [DBG] Executed controller factory for controller CarsTradeAPI.Features.OrdersOperation.OrdersController (CarsTradeAPI)
2025-10-18 18:31:43.821 +00:00 [INF] Получение запроса на выдачу всех заказов
2025-10-18 18:31:43.823 +00:00 [INF] Начало обработки команды GetAllOrdersQuery
2025-10-18 18:31:43.828 +00:00 [INF] Этап получения всех заказов в репозитории
2025-10-18 18:31:43.850 +00:00 [DBG] Entity Framework Core 8.0.7 initialized 'CarsTradeDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:8.0.4+51faf6e9c9c7ef99c3e98d98a96adb8fa8ae4553' with options: None
2025-10-18 18:31:43.852 +00:00 [DBG] Compiling query expression: 
'DbSet<Order>()
    .Include(o => o.OrderItems)
    .ThenInclude(oi => oi.CarModel)'
2025-10-18 18:31:43.853 +00:00 [DBG] Including navigation: 'Order.OrderItems'.
2025-10-18 18:31:43.853 +00:00 [DBG] Including navigation: 'OrderItem.CarModel'.
2025-10-18 18:31:43.861 +00:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Order>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Order.OrderId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Order.BuyerId (Guid) Required FK Index, 1], [Property: Order.EmployeeId (Guid) Required FK Index, 2], [Property: Order.OrderAddress (OrderAddress) Required, 3], [Property: Order.OrderCompletionDate (DateTime?), 4], [Property: Order.OrderCreateDate (DateTime) Required, 5], [Property: Order.OrderPrice (decimal) Required, 6] }
            1 -> 0
            2 -> Dictionary<IProperty, int> { [Property: OrderItem.OrderItemId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 7], [Property: OrderItem.CarModelId (Guid) Required FK Index, 8], [Property: OrderItem.OrderId (Guid) Required FK Index, 9], [Property: OrderItem.OrderItemComments (string), 10], [Property: OrderItem.OrderQuantity (long) Required, 11], [Property: OrderItem.UnitPrice (decimal) Required, 12] }
            3 -> Dictionary<IProperty, int> { [Property: CarModel.CarModelId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: CarModel.CarColor (string) Required, 14], [Property: CarModel.CarConfiguration (CarConfiguration) Required, 15], [Property: CarModel.CarCountry (string) Required, 16], [Property: CarModel.CarEngine (Engine), 17], [Property: CarModel.CarManufacturer (string) Required Index, 18], [Property: CarModel.CarModelName (string) Required Index, 19], [Property: CarModel.CarPrice (decimal) Required, 20], [Property: CarModel.ProductionDateTime (DateTime) Required, 21] }
            4 -> 7
            5 -> 13
        SELECT o.order_id, o.BuyerId, o.EmployeeId, o.order_delivery_address, o.order_completion_date, o.order_create_date, o.order_price, t.orderitem_id, t.CarModelId, t.OrderId, t.comments, t.order_quantity, t.unit_price, t.car_id, t.car_color, t.car_configuration, t.car_country, t.car_engine, t.car_manufacturer, t.car_model, t.car_price, t.car_productionDateTime
        FROM Orders AS o
        LEFT JOIN 
        (
            SELECT o0.orderitem_id, o0.CarModelId, o0.OrderId, o0.comments, o0.order_quantity, o0.unit_price, c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c.car_productionDateTime
            FROM OrderItems AS o0
            INNER JOIN CarModels AS c ON o0.CarModelId == c.car_id
        ) AS t ON o.order_id == t.OrderId
        ORDER BY o.order_id ASC, t.orderitem_id ASC), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Order>, 
    CarsTradeAPI.Data.CarsTradeDbContext, 
    False, 
    False, 
    True
)'
2025-10-18 18:31:43.862 +00:00 [DBG] Creating DbConnection.
2025-10-18 18:31:43.862 +00:00 [DBG] Created DbConnection. (0ms).
2025-10-18 18:31:43.862 +00:00 [DBG] Opening connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:43.961 +00:00 [DBG] Opened connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:43.962 +00:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2025-10-18 18:31:43.962 +00:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:31:43.962 +00:00 [DBG] Initialized DbCommand for 'ExecuteReader' (0ms).
2025-10-18 18:31:43.963 +00:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o.order_id, o."BuyerId", o."EmployeeId", o.order_delivery_address, o.order_completion_date, o.order_create_date, o.order_price, t.orderitem_id, t."CarModelId", t."OrderId", t.comments, t.order_quantity, t.unit_price, t.car_id, t.car_color, t.car_configuration, t.car_country, t.car_engine, t.car_manufacturer, t.car_model, t.car_price, t."car_productionDateTime"
FROM "Orders" AS o
LEFT JOIN (
    SELECT o0.orderitem_id, o0."CarModelId", o0."OrderId", o0.comments, o0.order_quantity, o0.unit_price, c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c."car_productionDateTime"
    FROM "OrderItems" AS o0
    INNER JOIN "CarModels" AS c ON o0."CarModelId" = c.car_id
) AS t ON o.order_id = t."OrderId"
ORDER BY o.order_id, t.orderitem_id
2025-10-18 18:31:43.966 +00:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT o.order_id, o."BuyerId", o."EmployeeId", o.order_delivery_address, o.order_completion_date, o.order_create_date, o.order_price, t.orderitem_id, t."CarModelId", t."OrderId", t.comments, t.order_quantity, t.unit_price, t.car_id, t.car_color, t.car_configuration, t.car_country, t.car_engine, t.car_manufacturer, t.car_model, t.car_price, t."car_productionDateTime"
FROM "Orders" AS o
LEFT JOIN (
    SELECT o0.orderitem_id, o0."CarModelId", o0."OrderId", o0.comments, o0.order_quantity, o0.unit_price, c.car_id, c.car_color, c.car_configuration, c.car_country, c.car_engine, c.car_manufacturer, c.car_model, c.car_price, c."car_productionDateTime"
    FROM "OrderItems" AS o0
    INNER JOIN "CarModels" AS c ON o0."CarModelId" = c.car_id
) AS t ON o.order_id = t."OrderId"
ORDER BY o.order_id, t.orderitem_id
2025-10-18 18:31:43.967 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Order' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:31:43.967 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'OrderItem' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:31:43.968 +00:00 [DBG] The navigation 'OrderItem.CarModel' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:31:43.968 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'CarModel' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:31:43.969 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'Order' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:31:43.969 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'OrderItem' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:31:43.969 +00:00 [DBG] The navigation 'OrderItem.CarModel' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:31:43.969 +00:00 [DBG] Context 'CarsTradeDbContext' started tracking 'CarModel' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2025-10-18 18:31:43.970 +00:00 [DBG] Closing data reader to 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:43.970 +00:00 [DBG] A data reader for 'CarsTrade' on server 'tcp://carstradeapi_database:5432' is being disposed after spending 3ms reading results.
2025-10-18 18:31:43.970 +00:00 [DBG] Closing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:43.970 +00:00 [DBG] Closed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:31:43.970 +00:00 [INF] Все заказы успешно получены, количество: 2
2025-10-18 18:31:43.975 +00:00 [INF] Успешное получение 2 заказов
2025-10-18 18:31:43.976 +00:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2025-10-18 18:31:43.976 +00:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2025-10-18 18:31:43.976 +00:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2025-10-18 18:31:43.976 +00:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2025-10-18 18:31:43.976 +00:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2025-10-18 18:31:43.977 +00:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2025-10-18 18:31:43.977 +00:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CarsTradeAPI.Features.OrdersOperation.OrdersDto.ShowOrderDto, CarsTradeAPI, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-10-18 18:31:43.977 +00:00 [INF] Executed action CarsTradeAPI.Features.OrdersOperation.OrdersController.GetAllOrders (CarsTradeAPI) in 157.5926ms
2025-10-18 18:31:43.978 +00:00 [INF] Executed endpoint 'CarsTradeAPI.Features.OrdersOperation.OrdersController.GetAllOrders (CarsTradeAPI)'
2025-10-18 18:31:43.978 +00:00 [DBG] 'CarsTradeDbContext' disposed.
2025-10-18 18:31:43.978 +00:00 [DBG] Disposing connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432'.
2025-10-18 18:31:43.978 +00:00 [DBG] Disposed connection to database 'CarsTrade' on server 'tcp://carstradeapi_database:5432' (0ms).
2025-10-18 18:31:43.979 +00:00 [INF] Request finished HTTP/2 GET https://localhost:8081/api/Orders/GetAllOrders/All - 200 null application/json; charset=utf-8 197.3891ms
