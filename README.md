# üöó CarsTradeAPI

**CarsTradeAPI** ‚Äî —ç—Ç–æ RESTful API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ–º–æ–±–∏–ª—å–Ω—ã–º –¥–∏–ª–µ—Ä—Å–∫–∏–º –±–∏–∑–Ω–µ—Å–æ–º, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ **ASP.NET Core 8**.  
–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—é backend-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ .NET: CQRS, MediatR, FluentValidation, JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ Redis, –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —á–µ—Ä–µ–∑ Testcontainers, Unit —Ç–µ—Å—Ç—ã —Å –ø–æ–º–æ—â—å—é Mock –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ Serilog.

---

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª—è–º–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏ (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –¥–≤–∏–≥–∞—Ç–µ–ª—å, —Ü–µ–Ω–∞)  
‚úÖ **–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –≤ –Ω–∞–ª–∏—á–∏–∏  
‚úÖ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏** ‚Äî –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º  
‚úÖ **–†–∞–±–æ—Ç–∞ —Å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏** ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è  
‚úÖ **–†–∞–±–æ—Ç–∞ —Å –ø–æ–∫—É–ø–∞—Ç–µ–ª—è–º–∏** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ  
‚úÖ **JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** ‚Äî –∑–∞—â–∏—Ç–∞ API –ø–æ —Ä–æ–ª—è–º (Admin / User)  
‚úÖ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî Redis –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤  
‚úÖ **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** ‚Äî –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π  
‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã** ‚Äî Testcontainers + Respawn  
‚úÖ **Unit-—Ç–µ—Å—Ç—ã** ‚Äî xUnit + Moq  
‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è** ‚Äî FluentValidation + ValidationBehavior  
‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî Serilog  
‚úÖ **–ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** ‚Äî —á–µ—Ä–µ–∑ ErrorHandlerMiddleware  

---

## üß∞ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ |
|------------|-------------|
| üíª –Ø–∑—ã–∫ | C# 12 |
| üß© –§—Ä–µ–π–º–≤–æ—Ä–∫ | ASP.NET Core 8 |
| üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | PostgreSQL 16 |
| ‚öôÔ∏è ORM | Entity Framework Core 8 |
| üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | xUnit, Testcontainers, Respawn, FluentAssertions |
| ‚ö° –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ | Redis (StackExchange.Redis) |
| ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è | FluentValidation |
| üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è | JWT |
| üìú –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | Serilog |
| üß† DI | Microsoft.Extensions.DependencyInjection |
| üìò –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | Swagger (Swashbuckle.AspNetCore) |
| üîÑ –ú–∞–ø–ø–∏–Ω–≥ | AutoMapper |

---

## üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç **Clean Architecture** –∏ —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ —Å–ª–æ–∏:

### üîπ API Layer
REST-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—â–∏–µ —Å –∫–ª–∏–µ–Ω—Ç–æ–º.  
–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ **MediatR**, —Ä–µ–∞–ª–∏–∑—É—è –ø–∞—Ç—Ç–µ—Ä–Ω CQRS.

### üîπ Application Layer
CQRS-–∫–æ–º–∞–Ω–¥—ã –∏ –∑–∞–ø—Ä–æ—Å—ã, –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ **FluentValidation**, –º–∞–ø–ø–∏–Ω–≥ —á–µ—Ä–µ–∑ **AutoMapper**.  
–°–æ–¥–µ—Ä–∂–∏—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É, –Ω–µ–∑–∞–≤–∏—Å–∏–º—É—é –æ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

### üîπ Domain Layer
–î–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: `CarModel`, `Order`, `Buyer`, `Employee`.

### üîπ Infrastructure Layer
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤:  
`IGenerateToken`, `ICacheService`, `IIdempotencyService`, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ EF Core, Redis –∏ JWT.

### üîπ Tests
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å **Testcontainers** –∏ **Respawn** (–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö) –∏ **Unit-—Ç–µ—Å—Ç—ã** —Å Mock.

---

## üê≥ –ó–∞–ø—É—Å–∫ –≤ Visual Studio

–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å **Docker Compose** –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å –æ—Ç–ª–∞–¥–∫–æ–π.
Docker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–Ω–∏–º–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã PostgreSQL –∏ Redis.
API –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ ASP.NET Core —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –æ—Ç–ª–∞–¥–∫–∏ (breakpoints).
–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤, –∫–∞–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ. (–¢—Ä–µ–±—É–µ—Ç—Å—è docker desktop)

## üê≥ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Å PostgreSQL –∏ Redis –≤—ã–ø–æ–ª–Ω–∏—Ç–µ: docker-compose up --build
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—Å—Ç—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∏ API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:üëâ https://localhost:8081/swagger

## üß© –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ü—Ä–∏–º–µ—Ä `.env` —Ñ–∞–π–ª–∞:

```
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=admin
POSTGRES_PASSWORD=admin123
POSTGRES_DB=carstrade
REDIS_HOST=localhost
REDIS_PORT=6379
JWT_KEY=super_secret_key
JWT_ISSUER=CarsTradeAPI
JWT_AUDIENCE=CarsTradeAPIUsers
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:

```bash
dotnet test
```

- **Unit-—Ç–µ—Å—Ç—ã:** –ø—Ä–æ–≤–µ—Ä—è—é—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏ —Å–µ—Ä–≤–∏—Å—ã.  
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:** —á–µ—Ä–µ–∑ **Testcontainers** –∏ **Respawn** —Å–æ–∑–¥–∞—é—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL –∏ –æ—á–∏—â–∞—é—Ç –µ—ë –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞.

---

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Serilog** –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.  
–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å –∏ –≤ —Ñ–∞–π–ª `/logs/log-.txt` (rolling file).

---

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

- **CQRS + MediatR** ‚Äî —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –∏ –∑–∞–ø—Ä–æ—Å–æ–≤.  
- **FluentValidation** ‚Äî –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è.  
- **Idempotency** ‚Äî –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥.  
- **Redis Cache** ‚Äî –ø–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —á—Ç–µ–Ω–∏—è.  
- **Dependency Injection** ‚Äî –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.  
- **Clean Architecture** ‚Äî –∏–∑–æ–ª—è—Ü–∏—è —Å–ª–æ—ë–≤ –∏ –≤—ã—Å–æ–∫–∞—è —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å.

---

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫: –°–º–∏—Ä–Ω–æ–≤ –†–æ—Å—Ç–∏—Å–ª–≤–∞–≤ 
–ø–æ—á—Ç–∞ –¥–ª—è —Å–≤—è–∑–∏: donrostislavio228@gmail.com
—Ç–µ–ª–µ–≥—Ä–∞–º: @ReptiloidLasert
GitHub: https://github.com/RostislavSmirnov
